(()=>{var e={};e.id=287,e.ids=[287],e.modules={20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},79348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},97391:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>l,routeModule:()=>p,serverHooks:()=>g,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{POST:()=>d});var o=r(88797),a=r(10042),n=r(58492),i=r(59540),u=r(62085);async function d(e){try{await (0,u.uD)();let{roomId:t,sender:r,message:s}=await e.json(),o=await u.WK.findOne({roomId:t});if(!o)return i.NextResponse.json({error:"Room not found"},{status:404});return o.messages.push({sender:r,message:s}),await o.save(),i.NextResponse.json({message:"Message sent successfully"})}catch(e){return console.error("Message sending error:",e),i.NextResponse.json({error:"Failed to send message"},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/send-message/route",pathname:"/api/send-message",filename:"route",bundlePath:"app/api/send-message/route"},resolvedPagePath:"C:\\Users\\Administrator\\Desktop\\CHAt\\chat-and-share\\app\\api\\send-message\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:c,workUnitAsyncStorage:m,serverHooks:g}=p;function l(){return(0,n.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:m})}},78031:()=>{},35303:()=>{},62085:(e,t,r)=>{"use strict";r.d(t,{WK:()=>d,Ee:()=>u,uD:()=>a});let s=require("mongoose");var o=r.n(s);let a=async()=>{try{0===o().connection.readyState&&(await o().connect(process.env.MONGODB_URI),console.log("Connected to MongoDB"))}catch(e){throw console.error("MongoDB connection error:",e),e}},n=new(o()).Schema({imageId:{type:String,required:!0,unique:!0},message:{type:String},imageData:{type:String,required:!0},scheduledForDeletion:{type:Boolean,default:!1},createdAt:{type:Date,default:Date.now}}),i=new(o()).Schema({roomId:{type:String,required:!0,unique:!0},messages:[{sender:{type:String,required:!0},message:{type:String,required:!0},timestamp:{type:Date,default:Date.now}}],createdAt:{type:Date,default:Date.now,expires:"24h"}}),u=o().models.Image||o().model("Image",n),d=o().models.ChatRoom||o().model("ChatRoom",i)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[492,661],()=>r(97391));module.exports=s})();