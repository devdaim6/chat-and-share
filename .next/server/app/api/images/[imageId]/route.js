(()=>{var e={};e.id=52,e.ids=[52],e.modules={20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},79348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},37054:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>y,routeModule:()=>c,serverHooks:()=>l,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>g});var a={};r.r(a),r.d(a,{DELETE:()=>p,GET:()=>d});var o=r(88797),s=r(10042),n=r(58492),i=r(59540),u=r(62085);async function d(e,{params:t}){try{await (0,u.uD)();let{imageId:e}=await t,r=await u.Ee.findOne({imageId:e});if(!r)return i.NextResponse.json({error:"Image not found"},{status:404});return i.NextResponse.json({message:r.message,imageData:r.imageData})}catch(e){return console.error("Retrieve error:",e),i.NextResponse.json({error:"Could not retrieve image"},{status:500})}}async function p(e,{params:t}){try{await (0,u.uD)();let{imageId:e}=await t;if(!await u.Ee.findOneAndDelete({imageId:e}))return i.NextResponse.json({error:"Image not found"},{status:404});return i.NextResponse.json({message:"Image deleted successfully"})}catch(e){return console.error("Delete error:",e),i.NextResponse.json({error:"Could not delete image"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/images/[imageId]/route",pathname:"/api/images/[imageId]",filename:"route",bundlePath:"app/api/images/[imageId]/route"},resolvedPagePath:"C:\\Users\\Administrator\\Desktop\\CHAt\\chat-and-share\\app\\api\\images\\[imageId]\\route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:m,workUnitAsyncStorage:g,serverHooks:l}=c;function y(){return(0,n.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:g})}},78031:()=>{},35303:()=>{},62085:(e,t,r)=>{"use strict";r.d(t,{WK:()=>d,Ee:()=>u,uD:()=>s});let a=require("mongoose");var o=r.n(a);let s=async()=>{try{0===o().connection.readyState&&(await o().connect(process.env.MONGODB_URI),console.log("Connected to MongoDB"))}catch(e){throw console.error("MongoDB connection error:",e),e}},n=new(o()).Schema({imageId:{type:String,required:!0,unique:!0},message:{type:String},imageData:{type:String,required:!0},scheduledForDeletion:{type:Boolean,default:!1},createdAt:{type:Date,default:Date.now}}),i=new(o()).Schema({roomId:{type:String,required:!0,unique:!0},messages:[{sender:{type:String,required:!0},message:{type:String,required:!0},timestamp:{type:Date,default:Date.now}}],createdAt:{type:Date,default:Date.now,expires:"24h"}}),u=o().models.Image||o().model("Image",n),d=o().models.ChatRoom||o().model("ChatRoom",i)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[492,661],()=>r(37054));module.exports=a})();