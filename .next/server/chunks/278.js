exports.id=278,exports.ids=[278],exports.modules={47278:(e,t,r)=>{let i=r(81367),s=r(78694),a=r(60164),n=r(17543),o=r(22863),l=r(92282),c=r(22625),d=r(76380),u=r(97076),h=r(41347),p=r(76482),{isRebalancing:f,isKafkaJSError:m,...g}=r(15847),{LEVELS:w}=r(63243);e.exports={Kafka:i,PartitionAssigners:s,AssignerProtocol:a,Partitioners:n,logLevel:w,CompressionTypes:o.Types,CompressionCodecs:o.Codecs,ConfigResourceTypes:l,AclResourceTypes:d,AclOperationTypes:u,AclPermissionTypes:h,ResourcePatternTypes:p,ConfigSource:c,...g}},31172:(e,t,r)=>{let i=r(81620),s=r(50913),a=r(14589),n=r(59492),o=r(23920),{events:l,wrap:c,unwrap:d}=r(49556),{LEVELS:u}=r(63243),{KafkaJSNonRetriableError:h,KafkaJSDeleteGroupsError:p,KafkaJSBrokerNotFound:f,KafkaJSDeleteTopicRecordsError:m,KafkaJSAggregateError:g}=r(15847),{staleMetadata:w}=r(15644),I=r(92282),y=r(76380),b=r(97076),T=r(41347),E=r(76482),{EARLIEST_OFFSET:S,LATEST_OFFSET:x}=r(87873),{CONNECT:A,DISCONNECT:O}=l,{values:R,keys:N,entries:C}=Object,_=R(l),k=N(l).map(e=>`admin.events.${e}`).join(", "),v=(e,t={})=>s(async()=>{try{return await e()}catch(e){if("LEADER_NOT_AVAILABLE"!==e.type)throw e;return!1}},t),D=e=>["Empty","Dead"].includes(e.state),P=async(e,t)=>(await e.addTargetTopic(t),await e.refreshMetadataIfNecessary(),e.findTopicPartitionMetadata(t).map(({partitionId:e})=>e).sort()),B=e=>e.reduce((e,{partition:t,...r})=>Object.assign(e,{[t]:{...r}}),{});e.exports=({logger:e,instrumentationEmitter:t,retry:r,cluster:s})=>{let N=e.namespace("Admin"),L=t||new o,M=async e=>{if(!e||"string"!=typeof e)throw new h(`Invalid topic ${e}`);return i(r)(async(t,r,i)=>{try{await s.addTargetTopic(e),await s.refreshMetadataIfNecessary();let t=s.findTopicPartitionMetadata(e),r=await s.fetchTopicsOffset([{topic:e,fromBeginning:!1,partitions:t.map(e=>({partition:e.partitionId}))}]),i=await s.fetchTopicsOffset([{topic:e,fromBeginning:!0,partitions:t.map(e=>({partition:e.partitionId}))}]),{partitions:a}=r.pop(),{partitions:n}=i.pop();return a.map(({partition:e,offset:t})=>({partition:e,offset:t,high:t,low:n.find(({partition:t})=>t===e).offset}))}catch(e){if("UNKNOWN_TOPIC_OR_PARTITION"===e.type)throw await s.refreshMetadata(),e;t(e)}})},U=async({groupId:e,topic:t,earliest:r=!1})=>{if(!e)throw new h(`Invalid groupId ${e}`);if(!t)throw new h(`Invalid topic ${t}`);let i=(await P(s,t)).map(e=>({partition:e,offset:s.defaultOffset({fromBeginning:r})}));return V({groupId:e,topic:t,partitions:i})},V=async({groupId:t,topic:r,partitions:i})=>{if(!t)throw new h(`Invalid groupId ${t}`);if(!r)throw new h(`Invalid topic ${r}`);if(!i||0===i.length)throw new h("Invalid partitions");let a=n({logger:e.namespace("Admin",u.NOTHING),cluster:s,groupId:t});await a.subscribe({topic:r,fromBeginning:!0});let o=await a.describeGroup();if(!D(o))throw new h(`The consumer group must have no running instances, current state: ${o.state}`);return new Promise((e,t)=>{for(let s of(a.on(a.events.FETCH,async()=>a.stop().then(e).catch(t)),a.run({eachBatchAutoResolve:!1,eachBatch:async()=>!0}).catch(t),a.pause([{topic:r}]),i))a.seek({topic:r,...s})})},G=e=>[I.BROKER,I.BROKER_LOGGER].includes(e),q=({resources:e,defaultBroker:t})=>a(e,async({type:e,name:r})=>G(e)?await s.findBroker({nodeId:String(r)}):t),F=async({topic:e,partitions:t})=>{if(!e||"string"!=typeof e)throw new h(`Invalid topic "${e}"`);if(!t||0===t.length)throw new h("Invalid partitions");let a=s.findLeaderForPartitions(e,t.map(e=>e.partition)),n=R(a).flat(),o=await M(e),l=[];if(t.forEach(({partition:t,offset:r})=>{if(!n.includes(t)){l.push({partition:t,offset:r,error:new f("Could not find the leader for the partition",{retriable:!1})});return}let{low:i}=o.find(e=>e.partition===t)||{high:void 0,low:void 0};parseInt(r)<parseInt(i)&&-1!==parseInt(r)&&N.warn("The requested offset is before the earliest offset maintained on the partition - no records will be deleted from this partition",{topic:e,partition:t,offset:r})}),l.length>0)throw new m({topic:e,partitions:l});let c=C(a).reduce((r,[i,s])=>(r[i]={topic:e,partitions:t.filter(e=>s.includes(e.partition))},r),{});return i(r)(async t=>{try{let t=[],r=C(c).map(([e,{topic:t,partitions:r}])=>async()=>{let i=await s.findBroker({nodeId:e});await i.deleteRecords({topics:[{topic:t,partitions:r}]}),delete c[e]});if(await Promise.all(r.map(e=>e().catch(e=>{if("KafkaJSDeleteTopicRecordsError"===e.name)e.partitions.forEach(({partition:e,offset:r,error:i})=>{t.push({partition:e,offset:r,error:i})});else throw e}))),t.length>0)throw new m({topic:e,partitions:t})}catch(e){throw e.retriable&&e.partitions.some(({error:e})=>w(e)||"KafkaJSMetadataNotLoaded"===e.name)&&await s.refreshMetadata(),e}})};return{connect:async()=>{await s.connect(),L.emit(A)},disconnect:async()=>{await s.disconnect(),L.emit(O)},listTopics:async()=>{let{topicMetadata:e}=await s.metadata();return e.map(e=>e.topic)},createTopics:async({topics:e,validateOnly:t,timeout:a,waitForLeaders:n=!0})=>{if(!e||!Array.isArray(e))throw new h(`Invalid topics array ${e}`);if(e.filter(({topic:e})=>"string"!=typeof e).length>0)throw new h("Invalid topics array, the topic names have to be a valid string");let o=new Set(e.map(({topic:e})=>e));if(o.size<e.length)throw new h("Invalid topics array, it cannot have multiple entries for the same topic");for(let{topic:t,configEntries:r}of e)if(null!=r){if(!Array.isArray(r))throw new h(`Invalid configEntries for topic "${t}", must be an array`);r.forEach((e,r)=>{if("object"!=typeof e||null==e)throw new h(`Invalid configEntries for topic "${t}". Entry ${r} must be an object`);for(let i of["name","value"])if(!Object.prototype.hasOwnProperty.call(e,i)||"string"!=typeof e[i])throw new h(`Invalid configEntries for topic "${t}". Entry ${r} must have a valid "${i}" property`)})}return i(r)(async(r,i,l)=>{try{await s.refreshMetadata();let r=await s.findControllerBroker();if(await r.createTopics({topics:e,validateOnly:t,timeout:a}),n){let e=Array.from(o.values());await v(async()=>await r.metadata(e),{delay:100,maxWait:a,timeoutMessage:"Timed out while waiting for topic leaders"})}return!0}catch(e){if("NOT_CONTROLLER"===e.type)throw N.warn("Could not create topics",{error:e.message,retryCount:i,retryTime:l}),e;if(e instanceof g&&e.errors.every(e=>"TOPIC_ALREADY_EXISTS"===e.type))return!1;r(e)}})},deleteTopics:async({topics:e,timeout:t})=>{if(!e||!Array.isArray(e))throw new h(`Invalid topics array ${e}`);if(e.filter(e=>"string"!=typeof e).length>0)throw new h("Invalid topics array, the names must be a valid string");return i(r)(async(r,i,a)=>{try{await s.refreshMetadata();let r=await s.findControllerBroker();for(let i of(await r.deleteTopics({topics:e,timeout:t}),e))s.targetTopics.delete(i);await s.refreshMetadata()}catch(e){if(["NOT_CONTROLLER","UNKNOWN_TOPIC_OR_PARTITION"].includes(e.type))throw N.warn("Could not delete topics",{error:e.message,retryCount:i,retryTime:a}),e;"REQUEST_TIMED_OUT"===e.type&&N.error('Could not delete topics, check if "delete.topic.enable" is set to "true" (the default value is "false") or increase the timeout',{error:e.message,retryCount:i,retryTime:a}),r(e)}})},createPartitions:async({topicPartitions:e,validateOnly:t,timeout:a})=>{if(!e||!Array.isArray(e))throw new h(`Invalid topic partitions array ${e}`);if(0===e.length)throw new h("Empty topic partitions array");if(e.filter(({topic:e})=>"string"!=typeof e).length>0)throw new h("Invalid topic partitions array, the topic names have to be a valid string");if(new Set(e.map(({topic:e})=>e)).size<e.length)throw new h("Invalid topic partitions array, it cannot have multiple entries for the same topic");return i(r)(async(r,i,n)=>{try{await s.refreshMetadata();let r=await s.findControllerBroker();await r.createPartitions({topicPartitions:e,validateOnly:t,timeout:a})}catch(e){if("NOT_CONTROLLER"===e.type)throw N.warn("Could not create topics",{error:e.message,retryCount:i,retryTime:n}),e;r(e)}})},fetchTopicMetadata:async({topics:e=[]}={})=>(e&&e.forEach(e=>{if(!e||"string"!=typeof e)throw new h(`Invalid topic ${e}`)}),{topics:(await s.metadata({topics:e})).topicMetadata.map(e=>({name:e.topic,partitions:e.partitionMetadata}))}),describeCluster:async()=>{let{brokers:e,clusterId:t,controllerId:r}=await s.metadata({topics:[]});return{brokers:e.map(({nodeId:e,host:t,port:r})=>({nodeId:e,host:t,port:r})),controller:null==r||-1===r?null:r,clusterId:t}},events:l,fetchOffsets:async({groupId:e,topics:t,resolveOffsets:r=!1})=>{if(!e)throw new h(`Invalid groupId ${e}`);if(t||(t=[]),!Array.isArray(t))throw new h("Expected topics array to be set");let i=await s.findGroupCoordinator({groupId:e}),a=await Promise.all(t.map(async e=>{let t=(await P(s,e)).map(e=>({partition:e}));return{topic:e,partitions:t}})),{responses:n}=await i.offsetFetch({groupId:e,topics:a});return r&&(n=await Promise.all(n.map(async({topic:t,partitions:r})=>{let i=B(await M(t)),s=r.map(({offset:e,partition:t,...r})=>{let s=e;return Number(e)===S&&(s=i[t].low),Number(e)===x&&(s=i[t].high),{partition:t,offset:s,...r}});return await V({groupId:e,topic:t,partitions:s}),{topic:t,partitions:s}}))),n.map(({topic:e,partitions:t})=>({topic:e,partitions:t.map(({partition:e,offset:t,metadata:r})=>({partition:e,offset:t,metadata:r||null}))}))},fetchTopicOffsets:M,fetchTopicOffsetsByTimestamp:async(e,t)=>{if(!e||"string"!=typeof e)throw new h(`Invalid topic ${e}`);return i(r)(async(r,i,a)=>{try{await s.addTargetTopic(e),await s.refreshMetadataIfNecessary();let r=s.findTopicPartitionMetadata(e).map(e=>({partition:e.partitionId})),{partitions:i}=(await s.fetchTopicsOffset([{topic:e,fromBeginning:!1,partitions:r}])).pop(),{partitions:a}=(await s.fetchTopicsOffset([{topic:e,fromTimestamp:t,partitions:r}])).pop();return a.map(({partition:e,offset:t})=>({partition:e,offset:parseInt(t,10)>=0?t:i.find(({partition:t})=>t===e).offset}))}catch(e){if("UNKNOWN_TOPIC_OR_PARTITION"===e.type)throw await s.refreshMetadata(),e;r(e)}})},setOffsets:V,resetOffsets:U,describeConfigs:async({resources:e,includeSynonyms:t})=>{if(!e||!Array.isArray(e))throw new h(`Invalid resources array ${e}`);if(0===e.length)throw new h("Resources array cannot be empty");let a=Object.values(I),n=e.find(e=>!a.includes(e.type));if(n)throw new h(`Invalid resource type ${n.type}: ${JSON.stringify(n)}`);let o=e.find(e=>!e.name||"string"!=typeof e.name);if(o)throw new h(`Invalid resource name ${o.name}: ${JSON.stringify(o)}`);let l=e.find(e=>!Array.isArray(e.configNames)&&null!=e.configNames);if(l){let{configNames:e}=l;throw new h(`Invalid resource configNames ${e}: ${JSON.stringify(l)}`)}return i(r)(async(r,i,a)=>{try{await s.refreshMetadata();let r=await s.findControllerBroker(),i=await q({resources:e,defaultBroker:r}),a=async e=>{let s=e||r;return s.describeConfigs({resources:i.get(s),includeSynonyms:t})},n=Array.from(i.keys());return{resources:(await Promise.all(n.map(a))).reduce((e,{resources:t})=>[...e,...t],[])}}catch(e){if("NOT_CONTROLLER"===e.type)throw N.warn("Could not describe configs",{error:e.message,retryCount:i,retryTime:a}),e;r(e)}})},alterConfigs:async({resources:e,validateOnly:t})=>{if(!e||!Array.isArray(e))throw new h(`Invalid resources array ${e}`);if(0===e.length)throw new h("Resources array cannot be empty");let a=Object.values(I),n=e.find(e=>!a.includes(e.type));if(n)throw new h(`Invalid resource type ${n.type}: ${JSON.stringify(n)}`);let o=e.find(e=>!e.name||"string"!=typeof e.name);if(o)throw new h(`Invalid resource name ${o.name}: ${JSON.stringify(o)}`);let l=e.find(e=>!Array.isArray(e.configEntries));if(l){let{configEntries:e}=l;throw new h(`Invalid resource configEntries ${e}: ${JSON.stringify(l)}`)}let c=e.find(e=>e.configEntries.some(e=>"string"!=typeof e.name||"string"!=typeof e.value));if(c)throw new h(`Invalid resource config value: ${JSON.stringify(c)}`);return i(r)(async(r,i,a)=>{try{await s.refreshMetadata();let r=await s.findControllerBroker(),i=await q({resources:e,defaultBroker:r}),a=async e=>{let s=e||r;return s.alterConfigs({resources:i.get(s),validateOnly:!!t})},n=Array.from(i.keys());return{resources:(await Promise.all(n.map(a))).reduce((e,{resources:t})=>[...e,...t],[])}}catch(e){if("NOT_CONTROLLER"===e.type)throw N.warn("Could not alter configs",{error:e.message,retryCount:i,retryTime:a}),e;r(e)}})},on:(e,t)=>{if(!_.includes(e))throw new h(`Event name should be one of ${k}`);return L.addListener(d(e),r=>{r.type=c(r.type),Promise.resolve(t(r)).catch(t=>{N.error(`Failed to execute listener: ${t.message}`,{eventName:e,stack:t.stack})})})},logger:()=>N,listGroups:async()=>{await s.refreshMetadata();let e=[];for(var t in s.brokerPool.brokers){let r=await s.findBroker({nodeId:t}),i=await r.listGroups();e=e.concat(i.groups)}return{groups:e}},describeGroups:async e=>{let t=Object.values((await Promise.all(e.map(async e=>({coordinator:await s.findGroupCoordinator({groupId:e}),groupId:e})))).reduce((e,{coordinator:t,groupId:r})=>{let i=e[t.nodeId];return i?e[t.nodeId]={...i,groupIds:[...i.groupIds,r]}:e[t.nodeId]={coordinator:t,groupIds:[r]},e},{})),a=await Promise.all(t.map(async({coordinator:e,groupIds:t})=>{let s=i(r),{groups:a}=await s(()=>e.describeGroups({groupIds:t}));return a}));return{groups:[].concat.apply([],a)}},deleteGroups:async e=>{if(!e||!Array.isArray(e))throw new h(`Invalid groupIds array ${e}`);let t=e.some(e=>"string"!=typeof e);if(t)throw new h(`Invalid groupId name: ${JSON.stringify(t)}`);let a=i(r),n=e.slice();return a(async(e,t,r)=>{try{if(0===n.length)return[];await s.refreshMetadata();let e={},t={};for(let r of n){let i=await s.findGroupCoordinator({groupId:r});void 0===e[i.nodeId]&&(e[i.nodeId]=[]),e[i.nodeId].push(r),t[i.nodeId]=i}let r=await Promise.all(Object.keys(t).map(async r=>await t[r].deleteGroups(e[r]))),i=r.flatMap(({results:e})=>e.map(({groupId:e,errorCode:t,error:r})=>({groupId:e,errorCode:t,error:r}))).filter(({errorCode:e})=>0!==e);if(n=i.map(({groupId:e})=>e),i.length>0)throw new p("Error in DeleteGroups",i);return r.flatMap(({results:e})=>e)}catch(i){if("NOT_CONTROLLER"===i.type||"COORDINATOR_NOT_AVAILABLE"===i.type)throw N.warn("Could not delete groups",{error:i.message,retryCount:t,retryTime:r}),i;e(i)}})},describeAcls:async({resourceType:e,resourceName:t,resourcePatternType:a,principal:n,host:o,operation:l,permissionType:c})=>{if("string"!=typeof n&&void 0!==n)throw new h("Invalid principal, the principal have to be a valid string");if("string"!=typeof o&&void 0!==o)throw new h("Invalid host, the host have to be a valid string");if("string"!=typeof t&&void 0!==t)throw new h("Invalid resourceName, the resourceName have to be a valid string");if(!Object.values(b).includes(l))throw new h(`Invalid operation type ${l}`);if(!Object.values(E).includes(a))throw new h(`Invalid resource pattern filter type ${a}`);if(!Object.values(T).includes(c))throw new h(`Invalid permission type ${c}`);if(!Object.values(y).includes(e))throw new h(`Invalid resource type ${e}`);return i(r)(async(r,i,d)=>{try{await s.refreshMetadata();let r=await s.findControllerBroker(),{resources:i}=await r.describeAcls({resourceType:e,resourceName:t,resourcePatternType:a,principal:n,host:o,operation:l,permissionType:c});return{resources:i}}catch(e){if("NOT_CONTROLLER"===e.type)throw N.warn("Could not describe ACL",{error:e.message,retryCount:i,retryTime:d}),e;r(e)}})},deleteAcls:async({filters:e})=>{let t;if(!e||!Array.isArray(e))throw new h(`Invalid ACL Filter array ${e}`);if(0===e.length)throw new h("Empty ACL Filter array");if(e.some(({principal:e})=>"string"!=typeof e&&void 0!==e))throw new h("Invalid ACL Filter array, the principals have to be a valid string");if(e.some(({host:e})=>"string"!=typeof e&&void 0!==e))throw new h("Invalid ACL Filter array, the hosts have to be a valid string");if(e.some(({resourceName:e})=>"string"!=typeof e&&void 0!==e))throw new h("Invalid ACL Filter array, the resourceNames have to be a valid string");let a=Object.values(b);if(t=e.find(e=>!a.includes(e.operation)))throw new h(`Invalid operation type ${t.operation}: ${JSON.stringify(t)}`);let n=Object.values(E);if(t=e.find(e=>!n.includes(e.resourcePatternType)))throw new h(`Invalid resource pattern type ${t.resourcePatternType}: ${JSON.stringify(t)}`);let o=Object.values(T);if(t=e.find(e=>!o.includes(e.permissionType)))throw new h(`Invalid permission type ${t.permissionType}: ${JSON.stringify(t)}`);let l=Object.values(y);if(t=e.find(e=>!l.includes(e.resourceType)))throw new h(`Invalid resource type ${t.resourceType}: ${JSON.stringify(t)}`);return i(r)(async(t,r,i)=>{try{await s.refreshMetadata();let t=await s.findControllerBroker(),{filterResponses:r}=await t.deleteAcls({filters:e});return{filterResponses:r}}catch(e){if("NOT_CONTROLLER"===e.type)throw N.warn("Could not delete ACL",{error:e.message,retryCount:r,retryTime:i}),e;t(e)}})},createAcls:async({acl:e})=>{let t;if(!e||!Array.isArray(e))throw new h(`Invalid ACL array ${e}`);if(0===e.length)throw new h("Empty ACL array");if(e.some(({principal:e})=>"string"!=typeof e))throw new h("Invalid ACL array, the principals have to be a valid string");if(e.some(({host:e})=>"string"!=typeof e))throw new h("Invalid ACL array, the hosts have to be a valid string");if(e.some(({resourceName:e})=>"string"!=typeof e))throw new h("Invalid ACL array, the resourceNames have to be a valid string");let a=Object.values(b);if(t=e.find(e=>!a.includes(e.operation)))throw new h(`Invalid operation type ${t.operation}: ${JSON.stringify(t)}`);let n=Object.values(E);if(t=e.find(e=>!n.includes(e.resourcePatternType)))throw new h(`Invalid resource pattern type ${t.resourcePatternType}: ${JSON.stringify(t)}`);let o=Object.values(T);if(t=e.find(e=>!o.includes(e.permissionType)))throw new h(`Invalid permission type ${t.permissionType}: ${JSON.stringify(t)}`);let l=Object.values(y);if(t=e.find(e=>!l.includes(e.resourceType)))throw new h(`Invalid resource type ${t.resourceType}: ${JSON.stringify(t)}`);return i(r)(async(t,r,i)=>{try{await s.refreshMetadata();let t=await s.findControllerBroker();return await t.createAcls({acl:e}),!0}catch(e){if("NOT_CONTROLLER"===e.type)throw N.warn("Could not create ACL",{error:e.message,retryCount:r,retryTime:i}),e;t(e)}})},deleteTopicRecords:F,alterPartitionReassignments:async({topics:e,timeout:t})=>{if(!e||!Array.isArray(e))throw new h(`Invalid topics array ${e}`);if(e.filter(({topic:e})=>"string"!=typeof e).length>0)throw new h("Invalid topics array, the topic names have to be a valid string");if(new Set(e.map(({topic:e})=>e)).size<e.length)throw new h("Invalid topics array, it cannot have multiple entries for the same topic");for(let{topic:t,partitionAssignment:r}of e){if(!r||!Array.isArray(r))throw new h(`Invalid partitions array: ${r} for topic: ${t}`);for(let{partition:e,replicas:i}of r){if(null==e||"number"!=typeof e||e<0)throw new h(`Invalid partitions index: ${e} for topic: ${t}`);if(!i||!Array.isArray(i))throw new h(`Invalid replica assignment: ${i} for topic: ${t} on partition: ${e}`);if(i.filter(e=>"number"!=typeof e||e<0).length>=1)throw new h(`Invalid replica assignment: ${i} for topic: ${t} on partition: ${e}. Replicas must be a non negative number`)}}return i(r)(async(r,i,a)=>{try{await s.refreshMetadata();let r=await s.findControllerBroker();await r.alterPartitionReassignments({topics:e,timeout:t})}catch(e){if("NOT_CONTROLLER"===e.type)throw N.warn("Could not reassign partitions",{error:e.message,retryCount:i,retryTime:a}),e;r(e)}})},listPartitionReassignments:async({topics:e=null,timeout:t})=>{if(e){if(!Array.isArray(e))throw new h(`Invalid topics array ${e}`);if(e.filter(({topic:e})=>"string"!=typeof e).length>0)throw new h("Invalid topics array, the topic names have to be a valid string");if(new Set(e.map(({topic:e})=>e)).size<e.length)throw new h("Invalid topics array, it cannot have multiple entries for the same topic");for(let{topic:t,partitions:r}of e){if(!r||!Array.isArray(r))throw new h(`Invalid partition array: ${r} for topic: ${t}`);if(r.filter(e=>"number"!=typeof e||e<0).length>=1)throw new h(`Invalid partition array: ${r} for topic: ${t}. The partition indices have to be a valid number greater than 0.`)}}return i(r)(async(r,i,a)=>{try{await s.refreshMetadata();let r=await s.findControllerBroker();return{topics:(await r.listPartitionReassignments({topics:e,timeout:t})).topics}}catch(e){if("NOT_CONTROLLER"===e.type)throw N.warn("Could not reassign partitions",{error:e.message,retryCount:i,retryTime:a}),e;r(e)}})}}}},49556:(e,t,r)=>{let i=r(6388),s=r(27086),a=r(86419)("admin"),n={CONNECT:a("connect"),DISCONNECT:a("disconnect"),REQUEST:a(s.NETWORK_REQUEST),REQUEST_TIMEOUT:a(s.NETWORK_REQUEST_TIMEOUT),REQUEST_QUEUE_SIZE:a(s.NETWORK_REQUEST_QUEUE_SIZE)},o={[n.REQUEST]:s.NETWORK_REQUEST,[n.REQUEST_TIMEOUT]:s.NETWORK_REQUEST_TIMEOUT,[n.REQUEST_QUEUE_SIZE]:s.NETWORK_REQUEST_QUEUE_SIZE},l=i(o);e.exports={events:n,wrap:e=>l[e]||e,unwrap:e=>o[e]||e}},49414:(e,t,r)=>{let i=r(22003),{Types:s}=r(22863),{requests:a,lookup:n}=r(98830),{KafkaJSNonRetriableError:o}=r(15847),l=r(80146),c=r(96497),d={SEND_REQUEST:Symbol("private:Broker:sendRequest")},u=()=>{throw Error("Broker not connected")};e.exports=class{constructor({connectionPool:e,logger:t,nodeId:r=null,versions:s=null,authenticationTimeout:a=1e4,allowAutoTopicCreation:n=!0}){this.connectionPool=e,this.nodeId=r,this.rootLogger=t,this.logger=t.namespace("Broker"),this.versions=s,this.authenticationTimeout=a,this.allowAutoTopicCreation=n;let o=2*this.connectionPool.connectionTimeout+this.authenticationTimeout;this.brokerAddress=`${this.connectionPool.host}:${this.connectionPool.port}`,this.lock=new i({timeout:o,description:`connect to broker ${this.brokerAddress}`}),this.lookupRequest=u}isConnected(){return this.connectionPool.sasl?this.connectionPool.isConnected()&&this.connectionPool.isAuthenticated():this.connectionPool.isConnected()}async connect(){await this.lock.acquire();try{if(this.isConnected())return;let e=await this.connectionPool.getConnection();if(this.versions||(this.versions=await this.apiVersions()),this.connectionPool.setVersions(this.versions),this.lookupRequest=n(this.versions),null===e.getSupportAuthenticationProtocol()){let e=!1;try{this.lookupRequest(l.SaslAuthenticate,a.SaslAuthenticate),e=!0}catch(t){e=!1}this.connectionPool.setSupportAuthenticationProtocol(e),this.logger.debug("Verified support for SaslAuthenticate",{broker:this.brokerAddress,supportAuthenticationProtocol:e})}await e.authenticate()}finally{await this.lock.release()}}async disconnect(){await this.connectionPool.destroy()}async apiVersions(){let e;for(let t of a.ApiVersions.versions.map(Number).sort().reverse())try{let r=a.ApiVersions.protocol({version:t});e=await this[d.SEND_REQUEST]({...r(),requestTimeout:this.connectionPool.connectionTimeout});break}catch(e){if("UNSUPPORTED_VERSION"!==e.type)throw e}if(!e)throw new o("API Versions not supported");return e.apiVersions.reduce((e,t)=>Object.assign(e,{[t.apiKey]:{minVersion:t.minVersion,maxVersion:t.maxVersion}}),{})}async metadata(e=[]){let t=this.lookupRequest(l.Metadata,a.Metadata),r=c(e);return await this[d.SEND_REQUEST](t({topics:r,allowAutoTopicCreation:this.allowAutoTopicCreation}))}async produce({topicData:e,transactionalId:t,producerId:r,producerEpoch:i,acks:n=-1,timeout:o=3e4,compression:c=s.None}){let u=this.lookupRequest(l.Produce,a.Produce);return await this[d.SEND_REQUEST](u({acks:n,timeout:o,compression:c,topicData:e,transactionalId:t,producerId:r,producerEpoch:i}))}async fetch({replicaId:e,isolationLevel:t,maxWaitTime:r=5e3,minBytes:i=1,maxBytes:s=0xa00000,topics:n,rackId:o=""}){let u=this.lookupRequest(l.Fetch,a.Fetch),h=c(n.reduce((e,{topic:t,partitions:r})=>(r.forEach(r=>{e.push({topic:t,partition:r})}),e),[])).reduce((e,{topic:t,partition:r})=>{let i=e[e.length-1];return null!=i&&i.topic===t?e[e.length-1].partitions.push(r):e.push({topic:t,partitions:[r]}),e},[]);return await this[d.SEND_REQUEST](u({replicaId:e,isolationLevel:t,maxWaitTime:r,minBytes:i,maxBytes:s,topics:h,rackId:o}))}async heartbeat({groupId:e,groupGenerationId:t,memberId:r}){let i=this.lookupRequest(l.Heartbeat,a.Heartbeat);return await this[d.SEND_REQUEST](i({groupId:e,groupGenerationId:t,memberId:r}))}async findGroupCoordinator({groupId:e,coordinatorType:t}){let r=this.lookupRequest(l.GroupCoordinator,a.GroupCoordinator);return await this[d.SEND_REQUEST](r({groupId:e,coordinatorType:t}))}async joinGroup({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:i="",protocolType:s="consumer",groupProtocols:n}){let o=this.lookupRequest(l.JoinGroup,a.JoinGroup),c=(a=i)=>this[d.SEND_REQUEST](o({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:a,protocolType:s,groupProtocols:n}));try{return await c()}catch(e){if("KafkaJSMemberIdRequired"===e.name)return c(e.memberId);throw e}}async leaveGroup({groupId:e,memberId:t}){let r=this.lookupRequest(l.LeaveGroup,a.LeaveGroup);return await this[d.SEND_REQUEST](r({groupId:e,memberId:t}))}async syncGroup({groupId:e,generationId:t,memberId:r,groupAssignment:i}){let s=this.lookupRequest(l.SyncGroup,a.SyncGroup);return await this[d.SEND_REQUEST](s({groupId:e,generationId:t,memberId:r,groupAssignment:i}))}async listOffsets({replicaId:e,isolationLevel:t,topics:r}){let i=this.lookupRequest(l.ListOffsets,a.ListOffsets),s=await this[d.SEND_REQUEST](i({replicaId:e,isolationLevel:t,topics:r}));for(let e of s.responses)e.partitions=e.partitions.map(({offsets:e,...t})=>e?{...t,offset:e.pop()}:t);return s}async offsetCommit({groupId:e,groupGenerationId:t,memberId:r,retentionTime:i,topics:s}){let n=this.lookupRequest(l.OffsetCommit,a.OffsetCommit);return await this[d.SEND_REQUEST](n({groupId:e,groupGenerationId:t,memberId:r,retentionTime:i,topics:s}))}async offsetFetch({groupId:e,topics:t}){let r=this.lookupRequest(l.OffsetFetch,a.OffsetFetch);return await this[d.SEND_REQUEST](r({groupId:e,topics:t}))}async describeGroups({groupIds:e}){let t=this.lookupRequest(l.DescribeGroups,a.DescribeGroups);return await this[d.SEND_REQUEST](t({groupIds:e}))}async createTopics({topics:e,validateOnly:t=!1,timeout:r=5e3}){let i=this.lookupRequest(l.CreateTopics,a.CreateTopics);return await this[d.SEND_REQUEST](i({topics:e,validateOnly:t,timeout:r}))}async createPartitions({topicPartitions:e,validateOnly:t=!1,timeout:r=5e3}){let i=this.lookupRequest(l.CreatePartitions,a.CreatePartitions);return await this[d.SEND_REQUEST](i({topicPartitions:e,validateOnly:t,timeout:r}))}async deleteTopics({topics:e,timeout:t=5e3}){let r=this.lookupRequest(l.DeleteTopics,a.DeleteTopics);return await this[d.SEND_REQUEST](r({topics:e,timeout:t}))}async describeConfigs({resources:e,includeSynonyms:t=!1}){let r=this.lookupRequest(l.DescribeConfigs,a.DescribeConfigs);return await this[d.SEND_REQUEST](r({resources:e,includeSynonyms:t}))}async alterConfigs({resources:e,validateOnly:t=!1}){let r=this.lookupRequest(l.AlterConfigs,a.AlterConfigs);return await this[d.SEND_REQUEST](r({resources:e,validateOnly:t}))}async initProducerId({transactionalId:e,transactionTimeout:t}){let r=this.lookupRequest(l.InitProducerId,a.InitProducerId);return await this[d.SEND_REQUEST](r({transactionalId:e,transactionTimeout:t}))}async addPartitionsToTxn({transactionalId:e,producerId:t,producerEpoch:r,topics:i}){let s=this.lookupRequest(l.AddPartitionsToTxn,a.AddPartitionsToTxn);return await this[d.SEND_REQUEST](s({transactionalId:e,producerId:t,producerEpoch:r,topics:i}))}async addOffsetsToTxn({transactionalId:e,producerId:t,producerEpoch:r,groupId:i}){let s=this.lookupRequest(l.AddOffsetsToTxn,a.AddOffsetsToTxn);return await this[d.SEND_REQUEST](s({transactionalId:e,producerId:t,producerEpoch:r,groupId:i}))}async txnOffsetCommit({transactionalId:e,groupId:t,producerId:r,producerEpoch:i,topics:s}){let n=this.lookupRequest(l.TxnOffsetCommit,a.TxnOffsetCommit);return await this[d.SEND_REQUEST](n({transactionalId:e,groupId:t,producerId:r,producerEpoch:i,topics:s}))}async endTxn({transactionalId:e,producerId:t,producerEpoch:r,transactionResult:i}){let s=this.lookupRequest(l.EndTxn,a.EndTxn);return await this[d.SEND_REQUEST](s({transactionalId:e,producerId:t,producerEpoch:r,transactionResult:i}))}async listGroups(){let e=this.lookupRequest(l.ListGroups,a.ListGroups);return await this[d.SEND_REQUEST](e())}async deleteGroups(e){let t=this.lookupRequest(l.DeleteGroups,a.DeleteGroups);return await this[d.SEND_REQUEST](t(e))}async deleteRecords({topics:e}){let t=this.lookupRequest(l.DeleteRecords,a.DeleteRecords);return await this[d.SEND_REQUEST](t({topics:e}))}async createAcls({acl:e}){let t=this.lookupRequest(l.CreateAcls,a.CreateAcls);return await this[d.SEND_REQUEST](t({creations:e}))}async describeAcls({resourceType:e,resourceName:t,resourcePatternType:r,principal:i,host:s,operation:n,permissionType:o}){let c=this.lookupRequest(l.DescribeAcls,a.DescribeAcls);return await this[d.SEND_REQUEST](c({resourceType:e,resourceName:t,resourcePatternType:r,principal:i,host:s,operation:n,permissionType:o}))}async deleteAcls({filters:e}){let t=this.lookupRequest(l.DeleteAcls,a.DeleteAcls);return await this[d.SEND_REQUEST](t({filters:e}))}async alterPartitionReassignments({topics:e,timeout:t}){let r=this.lookupRequest(l.AlterPartitionReassignments,a.AlterPartitionReassignments);return await this[d.SEND_REQUEST](r({topics:e,timeout:t}))}async listPartitionReassignments({topics:e=null,timeout:t}){let r=this.lookupRequest(l.ListPartitionReassignments,a.ListPartitionReassignments);return await this[d.SEND_REQUEST](r({topics:e,timeout:t}))}async [d.SEND_REQUEST](e){try{return await this.connectionPool.send(e)}catch(e){throw"KafkaJSConnectionClosedError"===e.name&&await this.disconnect(),e}}}},56041:(e,t,r)=>{let{request:i,response:s}=r(74396),{KafkaJSSASLAuthenticationError:a}=r(15847);e.exports=e=>({host:t,port:r,logger:n,saslAuthenticate:o})=>({authenticate:async()=>{if(!e.authorizationIdentity)throw new a("SASL AWS-IAM: Missing authorizationIdentity");if(!e.accessKeyId)throw new a("SASL AWS-IAM: Missing accessKeyId");if(!e.secretAccessKey)throw new a("SASL AWS-IAM: Missing secretAccessKey");e.sessionToken||(e.sessionToken="");let l=`${t}:${r}`;try{n.debug("Authenticate with SASL AWS-IAM",{broker:l}),await o({request:i(e),response:s}),n.debug("SASL AWS-IAM authentication successful",{broker:l})}catch(t){let e=new a(`SASL AWS-IAM authentication failed: ${t.message}`);throw n.error(e.message,{broker:l}),e}}})},68985:(e,t,r)=>{let{requests:i,lookup:s}=r(98830),a=r(80146),n=r(28942),o=r(1781),l=r(69625),c=r(56041),d=r(87659),{KafkaJSSASLAuthenticationError:u}=r(15847),h={AWS:c,PLAIN:n,OAUTHBEARER:d,"SCRAM-SHA-256":o,"SCRAM-SHA-512":l};e.exports=class{constructor(e,t,r,n){this.connection=e,this.logger=t,this.sessionLifetime="0";let o=s(r);this.saslHandshake=o(a.SaslHandshake,i.SaslHandshake),this.protocolAuthentication=n?o(a.SaslAuthenticate,i.SaslAuthenticate):null}async authenticate(){let e=this.connection.sasl.mechanism.toUpperCase();if(!(await this.connection.send(this.saslHandshake({mechanism:e}))).enabledMechanisms.includes(e))throw new u(`SASL ${e} mechanism is not supported by the server`);let t=async({request:e,response:t})=>{if(this.protocolAuthentication){let r=await e.encode(),i=await this.connection.send(this.protocolAuthentication({authBytes:r}));if(this.sessionLifetime=i.sessionLifetimeMs||"0",!t)return;let{authBytes:s}=i,a=await t.decode(s);return t.parse(a)}return this.connection.sendAuthRequest({request:e,response:t})};!this.connection.sasl.authenticationProvider&&Object.keys(h).includes(e)&&(this.connection.sasl.authenticationProvider=h[e](this.connection.sasl)),await this.connection.sasl.authenticationProvider({host:this.connection.host,port:this.connection.port,logger:this.logger.namespace(`SaslAuthenticator-${e}`),saslAuthenticate:t}).authenticate()}}},87659:(e,t,r)=>{let{request:i}=r(45564),{KafkaJSSASLAuthenticationError:s}=r(15847);e.exports=e=>({host:t,port:r,logger:a,saslAuthenticate:n})=>({authenticate:async()=>{let{oauthBearerProvider:o}=e;if(null==o)throw new s("SASL OAUTHBEARER: Missing OAuth bearer token provider");let l=await o();if(null==l.value)throw new s("SASL OAUTHBEARER: Invalid OAuth bearer token");let c=`${t}:${r}`;try{a.debug("Authenticate with SASL OAUTHBEARER",{broker:c}),await n({request:await i(e,l)}),a.debug("SASL OAUTHBEARER authentication successful",{broker:c})}catch(t){let e=new s(`SASL OAUTHBEARER authentication failed: ${t.message}`);throw a.error(e.message,{broker:c}),e}}})},28942:(e,t,r)=>{let{request:i,response:s}=r(77071),{KafkaJSSASLAuthenticationError:a}=r(15847);e.exports=e=>({host:t,port:r,logger:n,saslAuthenticate:o})=>({authenticate:async()=>{if(null==e.username||null==e.password)throw new a("SASL Plain: Invalid username or password");let l=`${t}:${r}`;try{n.debug("Authenticate with SASL PLAIN",{broker:l}),await o({request:i(e),response:s}),n.debug("SASL PLAIN authentication successful",{broker:l})}catch(t){let e=new a(`SASL PLAIN authentication failed: ${t.message}`);throw n.error(e.message,{broker:l}),e}}})},93635:(e,t,r)=>{let i=r(84770),s=r(69365),{KafkaJSSASLAuthenticationError:a,KafkaJSNonRetriableError:n}=r(15847),o=/=/g,l=/,/g,c=/\+/g,d=/\//g,u=/=+$/,h=e=>Buffer.from(e).toString("base64");class p{static sanitizeString(e){return e.replace(o,"=3D").replace(l,"=2C")}static nonce(){return i.randomBytes(16).toString("base64").replace(c,"-").replace(d,"_").replace(u,"").toString("ascii")}static hi(e,t,r,s){return new Promise((a,n)=>{i.pbkdf2(e,t,r,s.length,s.type,(e,t)=>e?n(e):a(t))})}static xor(e,t){let r=Buffer.from(e),i=Buffer.from(t),s=Buffer.byteLength(r);if(s!==Buffer.byteLength(i))throw new n("Buffers must be of the same length");let a=[];for(let e=0;e<s;e++)a.push(r[e]^i[e]);return Buffer.from(a)}constructor(e,t,r,i,s,a){this.sasl=e,this.host=t,this.port=r,this.logger=i,this.saslAuthenticate=s,this.digestDefinition=a;let n=a.type.toUpperCase();this.PREFIX=`SASL SCRAM ${n} authentication`,this.currentNonce=p.nonce()}async authenticate(){let{PREFIX:e}=this,t=`${this.host}:${this.port}`;if(null==this.sasl.username||null==this.sasl.password)throw new a(`${this.PREFIX}: Invalid username or password`);try{this.logger.debug("Exchanging first client message",{broker:t});let r=await this.sendClientFirstMessage();this.logger.debug("Sending final message",{broker:t});let i=await this.sendClientFinalMessage(r);if(i.e)throw Error(i.e);let s=await this.serverKey(r),a=this.serverSignature(s,r);if(i.v!==a)throw Error("Invalid server signature in server final message");this.logger.debug(`${e} successful`,{broker:t})}catch(i){let r=new a(`${e} failed: ${i.message}`);throw this.logger.error(r.message,{broker:t}),r}}async sendClientFirstMessage(){let e=`n,,${this.firstMessageBare()}`,t=s.firstMessage.request({clientFirstMessage:e}),r=s.firstMessage.response;return this.saslAuthenticate({request:t,response:r})}async sendClientFinalMessage(e){let{PREFIX:t}=this,r=parseInt(e.i,10),{minIterations:i}=this.digestDefinition;if(!e.r.startsWith(this.currentNonce))throw new a(`${t} failed: Invalid server nonce, it does not start with the client nonce`);if(r<i)throw new a(`${t} failed: Requested iterations ${r} is less than the minimum ${i}`);let n=this.finalMessageWithoutProof(e),o=await this.clientProof(e),l=`${n},p=${o}`,c=s.finalMessage.request({finalMessage:l}),d=s.finalMessage.response;return this.saslAuthenticate({request:c,response:d})}async clientProof(e){let t=await this.clientKey(e),r=this.H(t),i=this.clientSignature(r,e);return h(p.xor(t,i))}async clientKey(e){let t=await this.saltPassword(e);return this.HMAC(t,"Client Key")}async serverKey(e){let t=await this.saltPassword(e);return this.HMAC(t,"Server Key")}clientSignature(e,t){return this.HMAC(e,this.authMessage(t))}serverSignature(e,t){return h(this.HMAC(e,this.authMessage(t)))}authMessage(e){return[this.firstMessageBare(),e.original,this.finalMessageWithoutProof(e)].join(",")}async saltPassword(e){let t=Buffer.from(e.s,"base64"),r=parseInt(e.i,10);return p.hi(this.encodedPassword(),t,r,this.digestDefinition)}firstMessageBare(){return`n=${this.encodedUsername()},r=${this.currentNonce}`}finalMessageWithoutProof(e){let t=e.r;return`c=${h("n,,")},r=${t}`}encodedUsername(){let{username:e}=this.sasl;return p.sanitizeString(e).toString("utf-8")}encodedPassword(){let{password:e}=this.sasl;return e.toString("utf-8")}H(e){return i.createHash(this.digestDefinition.type).update(e).digest()}HMAC(e,t){return i.createHmac(this.digestDefinition.type,e).update(t).digest()}}e.exports={DIGESTS:{SHA256:{length:32,type:"sha256",minIterations:4096},SHA512:{length:64,type:"sha512",minIterations:4096}},SCRAM:p}},1781:(e,t,r)=>{let{SCRAM:i,DIGESTS:s}=r(93635);e.exports=e=>({host:t,port:r,logger:a,saslAuthenticate:n})=>{let o=new i(e,t,r,a,n,s.SHA256);return{authenticate:async()=>await o.authenticate()}}},69625:(e,t,r)=>{let{SCRAM:i,DIGESTS:s}=r(93635);e.exports=e=>({host:t,port:r,logger:a,saslAuthenticate:n})=>{let o=new i(e,t,r,a,n,s.SHA512);return{authenticate:async()=>await o.authenticate()}}},13925:(e,t,r)=>{let i=r(49414),s=r(81620),a=r(96497),n=r(83874),{KafkaJSBrokerNotFound:o,KafkaJSProtocolError:l}=r(15847),{keys:c,assign:d,values:u}=Object,h=(e,{host:t,port:r,rack:i})=>e.connectionPool.host!==t||e.connectionPool.port!==r||e.connectionPool.rack!==i;e.exports=class{constructor({connectionPoolBuilder:e,logger:t,retry:r,allowAutoTopicCreation:a,authenticationTimeout:n,metadataMaxAge:o}){this.rootLogger=t,this.connectionPoolBuilder=e,this.metadataMaxAge=o||0,this.logger=t.namespace("BrokerPool"),this.retrier=s(d({},r)),this.createBroker=e=>new i({allowAutoTopicCreation:a,authenticationTimeout:n,...e}),this.brokers={},this.seedBroker=void 0,this.metadata=null,this.metadataExpireAt=null,this.versions=null}hasConnectedBrokers(){return!!u(this.brokers).find(e=>e.isConnected())||!!this.seedBroker&&this.seedBroker.isConnected()}async createSeedBroker(){this.seedBroker&&await this.seedBroker.disconnect();let e=await this.connectionPoolBuilder.build();this.seedBroker=this.createBroker({connectionPool:e,logger:this.rootLogger})}async connect(){if(!this.hasConnectedBrokers())return this.seedBroker||await this.createSeedBroker(),this.retrier(async(e,t,r)=>{try{await this.seedBroker.connect(),this.versions=this.seedBroker.versions}catch(i){if("KafkaJSConnectionError"===i.name||"ILLEGAL_SASL_STATE"===i.type?(await this.createSeedBroker(),this.logger.error(`Failed to connect to seed broker, trying another broker from the list: ${i.message}`,{retryCount:t,retryTime:r})):this.logger.error(i.message,{retryCount:t,retryTime:r}),i.retriable)throw i;e(i)}})}async disconnect(){this.seedBroker&&await this.seedBroker.disconnect(),await Promise.all(u(this.brokers).map(e=>e.disconnect())),this.brokers={},this.metadata=null,this.versions=null}removeBroker({host:e,port:t}){let r=u(this.brokers).find(r=>r.connectionPool.host===e&&r.connectionPool.port===t);r&&(delete this.brokers[r.nodeId],this.metadataExpireAt=null,this.seedBroker.nodeId===r.nodeId&&(this.seedBroker=a(u(this.brokers))[0]))}async refreshMetadata(e){let t=await this.findConnectedBroker(),{host:r,port:i}=this.seedBroker.connectionPool;return this.retrier(async(s,a,o)=>{try{this.metadata=await t.metadata(e),this.metadataExpireAt=Date.now()+this.metadataMaxAge;let s=[];this.brokers=await this.metadata.brokers.reduce(async(e,{nodeId:t,host:a,port:n,rack:o})=>{let l=await e;if(l[t]){if(!h(l[t],{host:a,port:n,rack:o}))return l;s.push(l[t])}return a===r&&n===i?(this.seedBroker.nodeId=t,this.seedBroker.connectionPool.rack=o,d(l,{[t]:this.seedBroker})):d(l,{[t]:this.createBroker({logger:this.rootLogger,versions:this.versions,connectionPool:await this.connectionPoolBuilder.build({host:a,port:n,rack:o}),nodeId:t})})},this.brokers);let a=this.metadata.brokers.map(({nodeId:e})=>`${e}`).sort(),o=c(this.brokers).sort(),l=n(o,a).map(e=>this.brokers[e].disconnect().then(()=>{delete this.brokers[e]})),u=s.map(e=>e.disconnect());await Promise.all([...l,...u])}catch(e){if("LEADER_NOT_AVAILABLE"===e.type)throw e;s(e)}})}async refreshMetadataIfNecessary(e){if(null==this.metadata||null==this.metadataExpireAt||Date.now()>this.metadataExpireAt||!e.every(e=>this.metadata.topicMetadata.some(t=>t.topic===e)))return this.refreshMetadata(e)}getNodeIds(){return c(this.brokers)}async findBroker({nodeId:e}){let t=this.brokers[e];if(!t)throw new o(`Broker ${e} not found in the cached metadata`);return await this.connectBroker(t),t}async withBroker(e){let t=a(c(this.brokers));if(0===t.length)throw new o("No brokers in the broker pool");for(let r of t){let t=await this.findBroker({nodeId:r});try{return await e({nodeId:r,broker:t})}catch(e){}}return null}async findConnectedBroker(){let e=a(c(this.brokers)),t=e.find(e=>this.brokers[e].isConnected());if(t)return await this.findBroker({nodeId:t});for(let t of e)try{return await this.findBroker({nodeId:t})}catch(e){}return await this.connect(),this.seedBroker}async connectBroker(e){if(!e.isConnected())return this.retrier(async(t,r,i)=>{try{await e.connect()}catch(s){if(("KafkaJSConnectionError"===s.name||"ILLEGAL_SASL_STATE"===s.type)&&await e.disconnect(),"KafkaJSConnectionError"===s.name)return t(s);if("ILLEGAL_SASL_STATE"===s.type)throw e.connectionPool=await this.connectionPoolBuilder.build({host:e.connectionPool.host,port:e.connectionPool.port,rack:e.connectionPool.rack}),this.logger.error("Failed to connect to broker, reconnecting",{retryCount:r,retryTime:i}),new l(s,{retriable:!0});if(s.retriable)throw s;this.logger.error(s,{retryCount:r,retryTime:i,stack:s.stack}),t(s)}})}}},25968:(e,t,r)=>{let{KafkaJSConnectionError:i,KafkaJSNonRetriableError:s}=r(15847),a=r(31715);e.exports=({socketFactory:e,brokers:t,ssl:r,sasl:n,clientId:o,requestTimeout:l,enforceRequestTimeout:c,connectionTimeout:d,maxInFlightRequests:u,logger:h,instrumentationEmitter:p=null,reauthenticationThreshold:f})=>{let m=0,g=e=>e&&"string"==typeof e&&e.length>0,w=e=>{if(!e)throw new s("Failed to connect: brokers should not be null");if(Array.isArray(e)){if(!e.length)throw new s("Failed to connect: brokers array is empty");e.forEach((e,t)=>{if(!g(e))throw new s(`Failed to connect: broker at index ${t} is invalid "${typeof e}"`)})}},I=async()=>{let e;if("function"==typeof t)try{e=await t()}catch(t){let e=new i(`Failed to connect: "config.brokers" threw: ${t.message}`);throw e.stack=`${e.name}
  Caused by: ${t.stack}`,e}else e=t;return w(e),e};return{build:async({host:t,port:i,rack:s}={})=>{if(!t){let e=await I(),r=e[m++%e.length];t=r.split(":")[0],i=Number(r.split(":")[1])}return new a({host:t,port:i,rack:s,sasl:n,ssl:r,clientId:o,socketFactory:e,connectionTimeout:d,requestTimeout:l,enforceRequestTimeout:c,maxInFlightRequests:u,instrumentationEmitter:p,logger:h,reauthenticationThreshold:f})}}}},10545:(e,t,r)=>{let i=r(13925),s=r(22003),a=r(55416),n=r(81620),o=r(25968),{EARLIEST_OFFSET:l,LATEST_OFFSET:c}=r(87873),{KafkaJSError:d,KafkaJSBrokerNotFound:u,KafkaJSMetadataNotLoaded:h,KafkaJSTopicMetadataNotLoaded:p,KafkaJSGroupCoordinatorNotFound:f}=r(15847),m=r(46212),{keys:g}=Object,w=(e,{topic:t,partitions:r})=>({...e,[t]:[...e[t]||[],...r]}),I={CONNECT:Symbol("private:Cluster:connect"),REFRESH_METADATA:Symbol("private:Cluster:refreshMetadata"),REFRESH_METADATA_IF_NECESSARY:Symbol("private:Cluster:refreshMetadataIfNecessary"),FIND_CONTROLLER_BROKER:Symbol("private:Cluster:findControllerBroker")};e.exports=class{constructor({logger:e,socketFactory:t,brokers:r,ssl:l,sasl:c,clientId:d,connectionTimeout:p,authenticationTimeout:f,reauthenticationThreshold:m,requestTimeout:g=3e4,enforceRequestTimeout:w,metadataMaxAge:y,retry:b,allowAutoTopicCreation:T,maxInFlightRequests:E,isolationLevel:S,instrumentationEmitter:x=null,offsets:A=new Map}){this.rootLogger=e,this.logger=e.namespace("Cluster"),this.retrier=n(b),this.connectionPoolBuilder=o({logger:e,instrumentationEmitter:x,socketFactory:t,brokers:r,ssl:l,sasl:c,clientId:d,connectionTimeout:p,requestTimeout:g,enforceRequestTimeout:w,maxInFlightRequests:E,reauthenticationThreshold:m}),this.targetTopics=new Set,this.mutatingTargetTopics=new s({description:"updating target topics",timeout:g}),this.isolationLevel=S,this.brokerPool=new i({connectionPoolBuilder:this.connectionPoolBuilder,logger:this.rootLogger,retry:b,allowAutoTopicCreation:T,authenticationTimeout:f,metadataMaxAge:y}),this.committedOffsetsByGroup=A,this[I.CONNECT]=a(async()=>await this.brokerPool.connect()),this[I.REFRESH_METADATA]=a(async()=>await this.brokerPool.refreshMetadata(Array.from(this.targetTopics))),this[I.REFRESH_METADATA_IF_NECESSARY]=a(async()=>await this.brokerPool.refreshMetadataIfNecessary(Array.from(this.targetTopics))),this[I.FIND_CONTROLLER_BROKER]=a(async()=>{let{metadata:e}=this.brokerPool;if(!e||null==e.controllerId)throw new h("Topic metadata not loaded");let t=await this.findBroker({nodeId:e.controllerId});if(!t)throw new u(`Controller broker with id ${e.controllerId} not found in the cached metadata`);return t})}isConnected(){return this.brokerPool.hasConnectedBrokers()}async connect(){await this[I.CONNECT]()}async disconnect(){await this.brokerPool.disconnect()}removeBroker({host:e,port:t}){this.brokerPool.removeBroker({host:e,port:t})}async refreshMetadata(){await this[I.REFRESH_METADATA]()}async refreshMetadataIfNecessary(){await this[I.REFRESH_METADATA_IF_NECESSARY]()}async metadata({topics:e=[]}={}){return this.retrier(async(t,r,i)=>{try{return await this.brokerPool.refreshMetadataIfNecessary(e),this.brokerPool.withBroker(async({broker:t})=>t.metadata(e))}catch(e){if("LEADER_NOT_AVAILABLE"===e.type)throw e;t(e)}})}async addTargetTopic(e){return this.addMultipleTargetTopics([e])}async addMultipleTargetTopics(e){await this.mutatingTargetTopics.acquire();try{let t=this.targetTopics.size,r=new Set(this.targetTopics);for(let t of e)this.targetTopics.add(t);if(t!==this.targetTopics.size||!this.brokerPool.metadata)try{await this.refreshMetadata()}catch(e){throw("INVALID_TOPIC_EXCEPTION"===e.type||"UNKNOWN_TOPIC_OR_PARTITION"===e.type||"TOPIC_AUTHORIZATION_FAILED"===e.type)&&(this.targetTopics=r),e}}finally{await this.mutatingTargetTopics.release()}}getNodeIds(){return this.brokerPool.getNodeIds()}async findBroker({nodeId:e}){try{return await this.brokerPool.findBroker({nodeId:e})}catch(e){throw("KafkaJSBrokerNotFound"===e.name||"KafkaJSLockTimeout"===e.name||"KafkaJSConnectionError"===e.name)&&await this.refreshMetadata(),e}}async findControllerBroker(){return await this[I.FIND_CONTROLLER_BROKER]()}findTopicPartitionMetadata(e){let{metadata:t}=this.brokerPool;if(!t||!t.topicMetadata)throw new p("Topic metadata not loaded",{topic:e});let r=t.topicMetadata.find(t=>t.topic===e);return r?r.partitionMetadata:[]}findLeaderForPartitions(e,t){let r=this.findTopicPartitionMetadata(e);return t.reduce((t,i)=>{let s=parseInt(i,10),a=r.find(e=>e.partitionId===s);if(!a)return t;if(null===a.leader||void 0===a.leader)throw new d("Invalid partition metadata",{topic:e,partitionId:s,metadata:a});let{leader:n}=a,o=t[n]||[];return{...t,[n]:[...o,s]}},{})}async findGroupCoordinator({groupId:e,coordinatorType:t=m.GROUP}){return this.retrier(async(r,i,s)=>{try{let{coordinator:r}=await this.findGroupCoordinatorMetadata({groupId:e,coordinatorType:t});return await this.findBroker({nodeId:r.nodeId})}catch(t){if("KafkaJSBrokerNotFound"===t.name||"GROUP_COORDINATOR_NOT_AVAILABLE"===t.type)throw this.logger.debug(`${t.message}, refreshing metadata and trying again...`,{groupId:e,retryCount:i,retryTime:s}),await this.refreshMetadata(),t;if("ECONNREFUSED"===t.code)throw t;r(t)}})}async findGroupCoordinatorMetadata({groupId:e,coordinatorType:t}){let r=await this.brokerPool.withBroker(async({nodeId:r,broker:i})=>await this.retrier(async(s,a,n)=>{try{let r=await i.findGroupCoordinator({groupId:e,coordinatorType:t});return this.logger.debug("Found group coordinator",{broker:r.host,nodeId:r.coordinator.nodeId}),r}catch(t){if(this.logger.debug("Tried to find group coordinator",{nodeId:r,groupId:e,error:t}),"GROUP_COORDINATOR_NOT_AVAILABLE"===t.type)throw this.logger.debug("Group coordinator not available, retrying...",{nodeId:r,retryCount:a,retryTime:n}),t;s(t)}}));if(r)return r;throw new f("Failed to find group coordinator")}defaultOffset({fromBeginning:e}){return e?l:c}async fetchTopicsOffset(e){let t={},r={},i=e=>t=>{let{timestamp:i}=r[e];return{...t,timestamp:i}};for(let i of e){let{topic:e,partitions:s,fromBeginning:a,fromTimestamp:n}=i,o=this.findLeaderForPartitions(e,s.map(e=>e.partition)),l=null!=n?n:this.defaultOffset({fromBeginning:a});r[e]={timestamp:l},g(o).forEach(r=>{t[r]=t[r]||{},t[r][e]=s.filter(e=>o[r].includes(e.partition))})}let s=g(t).map(async e=>{let r=await this.findBroker({nodeId:e}),s=t[e],{responses:a}=await r.listOffsets({isolationLevel:this.isolationLevel,topics:g(s).map(e=>({topic:e,partitions:s[e].map(i(e))}))});return a}),a=(await Promise.all(s)).flat().reduce(w,{});return g(a).map(e=>({topic:e,partitions:a[e].map(({partition:e,offset:t})=>({partition:e,offset:t}))}))}committedOffsets({groupId:e}){return this.committedOffsetsByGroup.has(e)||this.committedOffsetsByGroup.set(e,{}),this.committedOffsetsByGroup.get(e)}markOffsetAsCommitted({groupId:e,topic:t,partition:r,offset:i}){let s=this.committedOffsets({groupId:e});s[t]=s[t]||{},s[t][r]=i}}},87873:e=>{e.exports={EARLIEST_OFFSET:-2,LATEST_OFFSET:-1,INT_32_MAX_VALUE:0x7fffffff}},60164:(e,t,r)=>{let i=r(36880),s=r(10243);e.exports={MemberMetadata:{encode:({version:e,topics:t,userData:r=Buffer.alloc(0)})=>new i().writeInt16(e).writeArray(t).writeBytes(r).buffer,decode(e){let t=new s(e);return{version:t.readInt16(),topics:t.readArray(e=>e.readString()),userData:t.readBytes()}}},MemberAssignment:{encode:({version:e,assignment:t,userData:r=Buffer.alloc(0)})=>new i().writeInt16(e).writeArray(Object.keys(t).map(e=>new i().writeString(e).writeArray(t[e]))).writeBytes(r).buffer,decode(e){let t=new s(e),r=e=>e.readInt32();return t.canReadInt16()?{version:t.readInt16(),assignment:t.readArray(e=>({topic:e.readString(),partitions:e.readArray(r)})).reduce((e,{topic:t,partitions:r})=>Object.assign(e,{[t]:r}),{}),userData:t.readBytes()}:null}}}},78694:(e,t,r)=>{let i=r(64360);e.exports={roundRobin:i}},64360:(e,t,r)=>{let{MemberMetadata:i,MemberAssignment:s}=r(60164);e.exports=({cluster:e})=>({name:"RoundRobinAssigner",version:0,async assign({members:t,topics:r}){let i=t.length,a=t.map(({memberId:e})=>e).sort(),n={};return r.flatMap(t=>e.findTopicPartitionMetadata(t).map(e=>({topic:t,partitionId:e.partitionId}))).forEach((e,t)=>{let r=a[t%i];n[r]||(n[r]=Object.create(null)),n[r][e.topic]||(n[r][e.topic]=[]),n[r][e.topic].push(e.partitionId)}),Object.keys(n).map(e=>({memberId:e,memberAssignment:s.encode({version:this.version,assignment:n[e]})}))},protocol({topics:e}){return{name:this.name,metadata:i.encode({version:this.version,topics:e})}}})},12903:(e,t,r)=>{let i=r(25481),s=r(34125);e.exports=class{constructor(e,t,r){this.fetchedOffset=t;let a=i.fromValue(this.fetchedOffset),{abortedTransactions:n,messages:o}=r;this.topic=e,this.partition=r.partition,this.highWatermark=r.highWatermark,this.rawMessages=o,this.messagesWithinOffset=this.rawMessages.filter(e=>i.fromValue(e.offset).gte(a)),this.messages=s({messages:this.messagesWithinOffset,abortedTransactions:n}).filter(e=>!e.isControlRecord)}isEmpty(){return 0===this.messages.length}isEmptyIncludingFiltered(){return 0===this.messagesWithinOffset.length}isEmptyDueToFiltering(){return this.isEmpty()&&this.rawMessages.length>0}isEmptyControlRecord(){return this.isEmpty()&&this.messagesWithinOffset.some(({isControlRecord:e})=>e)}isEmptyDueToLogCompactedMessages(){return this.rawMessages.length>0&&this.isEmptyIncludingFiltered()}firstOffset(){return this.isEmptyIncludingFiltered()?null:this.messagesWithinOffset[0].offset}lastOffset(){return this.isEmptyDueToLogCompactedMessages()?this.fetchedOffset:this.isEmptyIncludingFiltered()?i.fromValue(this.highWatermark).add(-1).toString():this.messagesWithinOffset[this.messagesWithinOffset.length-1].offset}offsetLag(){let e=i.fromValue(this.highWatermark).add(-1),t=i.fromValue(this.lastOffset());return e.add(t.multiply(-1)).toString()}offsetLagLow(){if(this.isEmptyIncludingFiltered())return"0";let e=i.fromValue(this.highWatermark).add(-1),t=i.fromValue(this.firstOffset());return e.add(t.multiply(-1)).toString()}}},29752:(e,t,r)=>{let i=r(86984),s=r(19681),a=r(83874),n=r(81620),o=r(55416),l=r(37722),c=r(12903),d=r(24972),u=r(37994),{events:{GROUP_JOIN:h,HEARTBEAT:p,CONNECT:f,RECEIVED_UNSUBSCRIBED_TOPICS:m}}=r(59544),{MemberAssignment:g}=r(60164),{KafkaJSError:w,KafkaJSNonRetriableError:I,KafkaJSStaleTopicMetadataAssignment:y,isRebalancing:b}=r(15847),{keys:T}=Object,E=["LEADER_NOT_AVAILABLE","NOT_LEADER_FOR_PARTITION","FENCED_LEADER_EPOCH","UNKNOWN_LEADER_EPOCH","UNKNOWN_TOPIC_OR_PARTITION"],S={JOIN:Symbol("private:ConsumerGroup:join"),SYNC:Symbol("private:ConsumerGroup:sync"),SHARED_HEARTBEAT:Symbol("private:ConsumerGroup:sharedHeartbeat")};e.exports=class{constructor({retry:e,cluster:t,groupId:r,topics:i,topicConfigurations:s,logger:a,instrumentationEmitter:l,assigners:c,sessionTimeout:h,rebalanceTimeout:f,maxBytesPerPartition:m,minBytes:g,maxBytes:w,maxWaitTimeInMs:I,autoCommit:y,autoCommitInterval:b,autoCommitThreshold:T,isolationLevel:E,rackId:x,metadataMaxAge:A}){this.cluster=t,this.groupId=r,this.topics=i,this.topicsSubscribed=i,this.topicConfigurations=s,this.logger=a.namespace("ConsumerGroup"),this.instrumentationEmitter=l,this.retrier=n(Object.assign({},e)),this.assigners=c,this.sessionTimeout=h,this.rebalanceTimeout=f,this.maxBytesPerPartition=m,this.minBytes=g,this.maxBytes=w,this.maxWaitTime=I,this.autoCommit=y,this.autoCommitInterval=b,this.autoCommitThreshold=T,this.isolationLevel=E,this.rackId=x,this.metadataMaxAge=A,this.seekOffset=new d,this.coordinator=null,this.generationId=null,this.leaderId=null,this.memberId=null,this.members=null,this.groupProtocol=null,this.partitionsPerSubscribedTopic=null,this.preferredReadReplicasPerTopicPartition={},this.offsetManager=null,this.subscriptionState=new u,this.lastRequest=Date.now(),this[S.SHARED_HEARTBEAT]=o(async({interval:e})=>{let{groupId:t,generationId:r,memberId:i}=this,s=Date.now();if(i&&s>=this.lastRequest+e){let e={groupId:t,memberId:i,groupGenerationId:r};await this.coordinator.heartbeat(e),this.instrumentationEmitter.emit(p,e),this.lastRequest=Date.now()}})}isLeader(){return this.leaderId&&this.memberId===this.leaderId}getNodeIds(){return this.cluster.getNodeIds()}async connect(){await this.cluster.connect(),this.instrumentationEmitter.emit(f),await this.cluster.refreshMetadataIfNecessary()}async [S.JOIN](){let{groupId:e,sessionTimeout:t,rebalanceTimeout:r}=this;this.coordinator=await this.cluster.findGroupCoordinator({groupId:e});let i=await this.coordinator.joinGroup({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:this.memberId||"",groupProtocols:this.assigners.map(e=>e.protocol({topics:this.topicsSubscribed}))});this.generationId=i.generationId,this.leaderId=i.leaderId,this.memberId=i.memberId,this.members=i.members,this.groupProtocol=i.groupProtocol}async leave(){let{groupId:e,memberId:t}=this;t&&(await this.coordinator.leaveGroup({groupId:e,memberId:t}),this.memberId=null)}async [S.SYNC](){let e=[],{groupId:t,generationId:r,memberId:i,members:n,groupProtocol:o,topics:c,topicsSubscribed:d,coordinator:u}=this;if(this.isLeader()){this.logger.debug("Chosen as group leader",{groupId:t,generationId:r,memberId:i,topics:c});let s=this.assigners.find(({name:e})=>e===o);if(!s)throw new I(`Unsupported partition assigner "${o}", the assigner wasn't found in the assigners list`);await this.cluster.refreshMetadata(),e=await s.assign({members:n,topics:d}),this.logger.debug("Group assignment",{groupId:t,generationId:r,groupProtocol:o,assignment:e,topics:d})}this.partitionsPerSubscribedTopic=this.generatePartitionsPerSubscribedTopic();let{memberAssignment:h}=await this.coordinator.syncGroup({groupId:t,generationId:r,memberId:i,groupAssignment:e}),p=g.decode(h),f=null!=p?p.assignment:{};this.logger.debug("Received assignment",{groupId:t,generationId:r,memberId:i,memberAssignment:f});let w=T(f),y=a(w,d);if(y.length>0){let e={groupId:t,generationId:r,memberId:i,assignedTopics:w,topicsSubscribed:d,topicsNotSubscribed:y};this.instrumentationEmitter.emit(m,e),this.logger.warn("Consumer group received unsubscribed topics",{...e,helpUrl:s("docs/faq","why-am-i-receiving-messages-for-topics-i-m-not-subscribed-to")})}let b=a(w,y).map(e=>({topic:e,partitions:f[e]}));for(let e of b){let{topic:s,partitions:a}=e,n=this.partitionsPerSubscribedTopic.get(s);if(!a.every(e=>n.includes(e))){this.logger.warn("Consumer is not aware of all assigned partitions, refreshing metadata",{groupId:t,generationId:r,memberId:i,topic:s,knownPartitions:n,assignedPartitions:a}),await this.cluster.refreshMetadata(),this.partitionsPerSubscribedTopic=this.generatePartitionsPerSubscribedTopic();break}}this.topics=b.map(({topic:e})=>e),this.subscriptionState.assign(b),this.offsetManager=new l({cluster:this.cluster,topicConfigurations:this.topicConfigurations,instrumentationEmitter:this.instrumentationEmitter,memberAssignment:b.reduce((e,{topic:t,partitions:r})=>({...e,[t]:r}),{}),autoCommit:this.autoCommit,autoCommitInterval:this.autoCommitInterval,autoCommitThreshold:this.autoCommitThreshold,coordinator:u,groupId:t,generationId:r,memberId:i})}joinAndSync(){let e=Date.now();return this.retrier(async t=>{try{await this[S.JOIN](),await this[S.SYNC]();let t=this.assigned().reduce((e,{topic:t,partitions:r})=>({...e,[t]:r}),{}),r={groupId:this.groupId,memberId:this.memberId,leaderId:this.leaderId,isLeader:this.isLeader(),memberAssignment:t,groupProtocol:this.groupProtocol,duration:Date.now()-e};this.instrumentationEmitter.emit(h,r),this.logger.info("Consumer has joined the group",r)}catch(e){if(b(e))throw new w(e);if("UNKNOWN_MEMBER_ID"===e.type)throw this.memberId=null,new w(e);t(e)}})}resetOffset({topic:e,partition:t}){this.offsetManager.resetOffset({topic:e,partition:t})}resolveOffset({topic:e,partition:t,offset:r}){this.offsetManager.resolveOffset({topic:e,partition:t,offset:r})}seek({topic:e,partition:t,offset:r}){this.seekOffset.set(e,t,r)}pause(e){this.logger.info(`Pausing fetching from ${e.length} topics`,{topicPartitions:e}),this.subscriptionState.pause(e)}resume(e){this.logger.info(`Resuming fetching from ${e.length} topics`,{topicPartitions:e}),this.subscriptionState.resume(e)}assigned(){return this.subscriptionState.assigned()}paused(){return this.subscriptionState.paused()}isPaused(e,t){return this.subscriptionState.isPaused(e,t)}async commitOffsetsIfNecessary(){await this.offsetManager.commitOffsetsIfNecessary()}async commitOffsets(e){await this.offsetManager.commitOffsets(e)}uncommittedOffsets(){return this.offsetManager.uncommittedOffsets()}async heartbeat({interval:e}){return this[S.SHARED_HEARTBEAT]({interval:e})}async fetch(e){try{await this.cluster.refreshMetadataIfNecessary(),this.checkForStaleAssignment();let t=this.subscriptionState.assigned();t=this.filterPartitionsByNode(e,t),await this.seekOffsets(t);let r=this.offsetManager.committedOffsets(),s=this.getActiveTopicPartitions(),a=t.map(({topic:e,partitions:t})=>({topic:e,partitions:t.filter(t=>null!=r[e][t]&&s[e].has(t)).map(t=>({partition:t,fetchOffset:this.offsetManager.nextOffset(e,t).toString(),maxBytes:this.maxBytesPerPartition}))})).filter(({partitions:e})=>e.length);if(!a.length)return await i(this.maxWaitTime),[];let n=await this.cluster.findBroker({nodeId:e}),{responses:o}=await n.fetch({maxWaitTime:this.maxWaitTime,minBytes:this.minBytes,maxBytes:this.maxBytes,isolationLevel:this.isolationLevel,topics:a,rackId:this.rackId});return o.flatMap(({topicName:e,partitions:t})=>{let r=a.find(({topic:t})=>t===e),i=this.preferredReadReplicasPerTopicPartition[e];return i||(this.preferredReadReplicasPerTopicPartition[e]=i={}),t.filter(({partition:t})=>!this.seekOffset.has(e,t)&&!this.subscriptionState.isPaused(e,t)).map(t=>{let{partition:s,preferredReadReplica:a}=t;if(null!=a&&-1!==a){let{nodeId:t}=i[s]||{};t!==a&&this.logger.info(`Preferred read replica is now ${a}`,{groupId:this.groupId,memberId:this.memberId,topic:e,partition:s}),i[s]={nodeId:a,expireAt:Date.now()+this.metadataMaxAge}}let n=r.partitions.find(({partition:e})=>e===t.partition).fetchOffset;return new c(e,n,t)})})}catch(e){return await this.recoverFromFetch(e),[]}}async recoverFromFetch(e){if(E.includes(e.type)||"KafkaJSTopicMetadataNotLoaded"===e.name){this.logger.debug("Stale cluster metadata, refreshing...",{groupId:this.groupId,memberId:this.memberId,error:e.message}),await this.cluster.refreshMetadata(),await this.joinAndSync();return}if("KafkaJSStaleTopicMetadataAssignment"===e.name){this.logger.warn(`${e.message}, resync group`,{groupId:this.groupId,memberId:this.memberId,topic:e.topic,unknownPartitions:e.unknownPartitions}),await this.joinAndSync();return}if("KafkaJSOffsetOutOfRange"===e.name){await this.recoverFromOffsetOutOfRange(e);return}if("KafkaJSConnectionClosedError"===e.name){this.cluster.removeBroker({host:e.host,port:e.port});return}if("KafkaJSBrokerNotFound"===e.name||"KafkaJSConnectionClosedError"===e.name){this.logger.debug(`${e.message}, refreshing metadata and retrying...`),await this.cluster.refreshMetadata();return}throw e}async recoverFromOffsetOutOfRange(e){let t=this.preferredReadReplicasPerTopicPartition[e.topic];t&&"number"==typeof t[e.partition]?(this.logger.info("Offset out of range while fetching from follower, retrying with leader",{topic:e.topic,partition:e.partition,groupId:this.groupId,memberId:this.memberId}),delete t[e.partition]):(this.logger.error("Offset out of range, resetting to default offset",{topic:e.topic,partition:e.partition,groupId:this.groupId,memberId:this.memberId}),await this.offsetManager.setDefaultOffset({topic:e.topic,partition:e.partition}))}generatePartitionsPerSubscribedTopic(){let e=new Map;for(let t of this.topicsSubscribed){let r=this.cluster.findTopicPartitionMetadata(t).map(e=>e.partitionId).sort();e.set(t,r)}return e}checkForStaleAssignment(){if(this.partitionsPerSubscribedTopic)for(let[e,t]of this.generatePartitionsPerSubscribedTopic()){let r=a(t,this.partitionsPerSubscribedTopic.get(e));if(r.length>0)throw new y("Topic has been updated",{topic:e,unknownPartitions:r})}}async seekOffsets(e){for(let{topic:t,partitions:r}of e)for(let e of r){let r=this.seekOffset.pop(t,e);r&&(this.logger.debug("Seek offset",{groupId:this.groupId,memberId:this.memberId,seek:r}),await this.offsetManager.seek(r))}await this.offsetManager.resolveOffsets()}hasSeekOffset({topic:e,partition:t}){return this.seekOffset.has(e,t)}findReadReplicaForPartitions(e,t){let r=this.cluster.findTopicPartitionMetadata(e),i=this.preferredReadReplicasPerTopicPartition[e];return t.reduce((t,s)=>{let a=parseInt(s,10),n=r.find(e=>e.partitionId===a);if(!n)return t;if(null==n.leader)throw new w("Invalid partition metadata",{topic:e,partitionId:a,metadata:n});let o=n.leader;if(i){let{nodeId:t,expireAt:r}=i[a]||{};if(Date.now()>=r)this.logger.debug("Preferred read replica information has expired, using leader",{topic:e,partitionId:a,groupId:this.groupId,memberId:this.memberId,preferredReadReplica:t,leader:n.leader}),delete i[a];else if(null!=t){let r=n.offlineReplicas;Array.isArray(r)&&r.includes(o)?this.logger.debug("Preferred read replica is offline, using leader",{topic:e,partitionId:a,groupId:this.groupId,memberId:this.memberId,preferredReadReplica:t,leader:n.leader}):o=t}}let l=t[o]||[];return{...t,[o]:[...l,a]}},{})}filterPartitionsByNode(e,t){return t.map(({topic:t,partitions:r})=>({topic:t,partitions:this.findReadReplicaForPartitions(t,r)[e]||[]}))}getActiveTopicPartitions(){let e=this.subscriptionState.active(),t={};return e.forEach(({topic:e,partitions:r})=>{t[e]=new Set(r)}),t}}},27853:(e,t,r)=>{let i=r(44228),s=r(96693),a=r(83117),n=r(45528),{KafkaJSFetcherRebalanceError:o,KafkaJSNoBrokerAvailableError:l}=r(15847);e.exports=({logger:e,getNodeIds:t,fetch:r,handler:c,concurrency:d=1})=>{let u=e.namespace("FetchManager"),h=n({workers:i(d,e=>a({handler:c,workerId:e}))}),p=[],f=()=>{let e=t(),i=new Map;if(0===e.length)throw new l;let a=()=>{let r=t();if((e.length!==r.length||e.some(e=>!r.includes(e)))&&0!==r.length)throw new o},n=e.map(e=>s({nodeId:e,workerQueue:h,partitionAssignments:i,fetch:async e=>(a(),r(e)),logger:u}));return u.debug(`Created ${n.length} fetchers`,{nodeIds:e,concurrency:d}),n},m=async()=>{u.debug("Stopping fetchers..."),await Promise.all(p.map(e=>e.stop())),u.debug("Stopped fetchers")};return{start:async()=>{for(u.debug("Starting...");;){p=f();try{await Promise.all(p.map(e=>e.start()))}catch(e){if(await m(),e instanceof o){u.debug("Rebalancing fetchers...");continue}throw e}break}},stop:m,getFetchers:()=>p}}},96693:(e,t,r)=>{let i=r(17702);e.exports=({nodeId:e,workerQueue:t,partitionAssignments:r,fetch:s,logger:a})=>{let n=a.namespace(`Fetcher ${e}`),o=new i,l=!1,c=({topic:e,partition:t})=>`${e}|${t}`,d=e=>r.get(c(e)),u=t=>r.set(c(t),e),h=e=>r.delete(c(e)),p=t=>t.filter(t=>{let r=d(t);return null==r||r===e||(n.info("Filtering out batch due to partition already being processed by another fetcher",{topic:t.topic,partition:t.partition,assignedFetcher:r,fetcher:e}),!1)});return{start:async()=>{if(!l){for(l=!0;l;)try{let r=await s(e);if(l){let e=p(r);if(e.length>0){e.forEach(u);try{await t.push(...e)}finally{e.forEach(h)}}}}catch(e){throw l=!1,o.emit("end"),e}o.emit("end")}},stop:async()=>{l&&(l=!1,await new Promise(e=>o.once("end",()=>e())))},getWorkerQueue:()=>t}}},34125:(e,t,r)=>{let i=r(25481),s=Buffer.from([0,0,0,0]),a=({key:e})=>!!e&&Buffer.from(e).equals(s);e.exports=({messages:e,abortedTransactions:t})=>{let r=new Map;if(!t||!t.length)return e;let s=[...t];return e.filter(e=>{if(s.length&&i.fromValue(e.offset).gte(s[0].firstOffset)){let{producerId:e}=s.shift();r.set(e,!0)}let{producerId:t,inTransaction:n}=e.batchContext;if(a(e))r.delete(t);else if(r.has(t)&&n)return!1;return!0})}},59492:(e,t,r)=>{let i=r(25481),s=r(81620),{initialRetryTime:a}=r(72149),n=r(29752),o=r(40654),{events:l,wrap:c,unwrap:d}=r(59544),u=r(23920),{KafkaJSNonRetriableError:h}=r(15847),{roundRobin:p}=r(78694),{EARLIEST_OFFSET:f,LATEST_OFFSET:m}=r(87873),g=r(20236),w=r(55416),{keys:I,values:y}=Object,{CONNECT:b,DISCONNECT:T,STOP:E,CRASH:S}=l,x=y(l),A=I(l).map(e=>`consumer.events.${e}`).join(", "),O=[i.fromValue(f).toString(),i.fromValue(m).toString()];e.exports=({cluster:e,groupId:t,retry:r,logger:f,partitionAssigners:m=[p],sessionTimeout:y=3e4,rebalanceTimeout:R=6e4,heartbeatInterval:N=3e3,maxBytesPerPartition:C=1048576,minBytes:_=1,maxBytes:k=0xa00000,maxWaitTimeInMs:v=5e3,isolationLevel:D=g.READ_COMMITTED,rackId:P="",instrumentationEmitter:B,metadataMaxAge:L})=>{if(!t)throw new h("Consumer groupId must be a non-empty string.");let M=f.namespace("Consumer"),U=B||new u,V=m.map(r=>r({groupId:t,logger:M,cluster:e})),G={},q=null,F=null,$=null;if(N>=y)throw new h(`Consumer heartbeatInterval (${N}) must be lower than sessionTimeout (${y}). It is recommended to set heartbeatInterval to approximately a third of the sessionTimeout.`);let j=async()=>{await e.connect(),U.emit(b)},K=async()=>{try{await Q(),M.debug("consumer has stopped, disconnecting",{groupId:t}),await e.disconnect(),U.emit(T)}catch(e){throw M.error(`Caught error when disconnecting the consumer: ${e.message}`,{stack:e.stack,groupId:t}),e}},Q=w(async()=>{try{q&&(await q.stop(),q=null,F=null,U.emit(E)),clearTimeout($),M.info("Stopped",{groupId:t})}catch(e){throw M.error(`Caught error when stopping the consumer: ${e.message}`,{stack:e.stack,groupId:t}),e}}),J=async({autoCommit:i=!0,autoCommitInterval:s=null,autoCommitThreshold:l=null,eachBatchAutoResolve:c=!0,partitionsConsumedConcurrently:d=1,eachBatch:u=null,eachMessage:h=null}={})=>{if(F){M.warn("consumer#run was called, but the consumer is already running",{groupId:t});return}let p=async a=>{M.info("Starting",{groupId:t}),F=new n({logger:f,topics:I(G),topicConfigurations:G,retry:r,cluster:e,groupId:t,assigners:V,sessionTimeout:y,rebalanceTimeout:R,maxBytesPerPartition:C,minBytes:_,maxBytes:k,maxWaitTimeInMs:v,instrumentationEmitter:U,isolationLevel:D,rackId:P,metadataMaxAge:L,autoCommit:i,autoCommitInterval:s,autoCommitThreshold:l}),q=new o({logger:f,consumerGroup:F,instrumentationEmitter:U,heartbeatInterval:N,retry:r,autoCommit:i,eachBatchAutoResolve:c,eachBatch:u,eachMessage:h,onCrash:a,concurrency:d}),await q.start()},m=async i=>{M.error(`Crash: ${i.name}: ${i.message}`,{groupId:t,retryCount:i.retryCount,stack:i.stack}),"KafkaJSConnectionClosedError"===i.name&&e.removeBroker({host:i.host,port:i.port}),await K();let s=e=>e.cause?s(e.cause):e,n=("KafkaJSNumberOfRetriesExceeded"===i.name||!0===s(i).retriable)&&(!r||!r.restartOnFailure||await r.restartOnFailure(i).catch(e=>(M.error('Caught error when invoking user-provided "restartOnFailure" callback. Defaulting to restarting.',{error:e.message||e,cause:i.message||i,groupId:t}),!0)));if(U.emit(S,{error:i,groupId:t,restart:n}),n){let e=i.retryTime||r&&r.initialRetryTime||a;M.error(`Restarting the consumer in ${e}ms`,{retryCount:i.retryCount,retryTime:e,groupId:t}),$=setTimeout(()=>p(m),e)}};await p(m)};return{connect:j,disconnect:K,subscribe:async({topic:r,topics:i,fromBeginning:s=!1})=>{if(F)throw new h("Cannot subscribe to topic while consumer is running");if(!r&&!i)throw new h('Missing required argument "topics"');if(null!=i&&!Array.isArray(i))throw new h('Argument "topics" must be an array');let a=i||[r];for(let e of a)if("string"!=typeof e&&!(e instanceof RegExp))throw new h(`Invalid topic ${e} (${typeof e}), the topic name has to be a String or a RegExp`);let n=a.some(e=>e instanceof RegExp)?await e.metadata():void 0,o=[];for(let e of a)if(e instanceof RegExp){let r=e,i=n.topicMetadata.map(({topic:e})=>e).filter(e=>r.test(e));M.debug("Subscription based on RegExp",{groupId:t,topicRegExp:r.toString(),matchedTopics:i}),o.push(...i)}else o.push(e);for(let e of o)G[e]={fromBeginning:s};await e.addMultipleTargetTopics(o)},stop:Q,run:J,commitOffsets:async(e=[])=>{let t=e.reduce((e,{topic:t,partition:r,offset:s,metadata:a=null})=>{let n;if(!t)throw new h(`Invalid topic ${t}`);if(isNaN(r))throw new h(`Invalid partition, expected a number received ${r}`);try{n=i.fromValue(s)}catch(e){throw new h(`Invalid offset, expected a long received ${s}`)}if(n.lessThan(0))throw new h("Offset must not be a negative number");if(null!==a&&"string"!=typeof a)throw new h(`Invalid offset metadata, expected string or null, received ${a}`);let o=e[t]||[];return o.push({partition:r,offset:n,metadata:a}),{...e,[t]:o}},{});if(!F)throw new h("Consumer group was not initialized, consumer#run must be called first");let r=Object.keys(t);return q.commitOffsets({topics:r.map(e=>({topic:e,partitions:t[e]}))})},seek:({topic:e,partition:t,offset:r})=>{let s;if(!e)throw new h(`Invalid topic ${e}`);if(isNaN(t))throw new h(`Invalid partition, expected a number received ${t}`);try{s=i.fromValue(r)}catch(e){throw new h(`Invalid offset, expected a long received ${r}`)}if(s.lessThan(0)&&!O.includes(s.toString()))throw new h("Offset must not be a negative number");if(!F)throw new h("Consumer group was not initialized, consumer#run must be called first");F.seek({topic:e,partition:t,offset:s.toString()})},describeGroup:async()=>{let i=await e.findGroupCoordinator({groupId:t});return s(r)(async()=>{let{groups:e}=await i.describeGroups({groupIds:[t]});return e.find(e=>e.groupId===t)})},pause:(e=[])=>{for(let t of e)if(t&&t.topic){if(void 0!==t.partitions&&(!Array.isArray(t.partitions)||t.partitions.some(isNaN)))throw new h(`Array of valid partitions required to pause specific partitions instead of ${t.partitions}`)}else throw new h(`Invalid topic ${t&&t.topic||t}`);if(!F)throw new h("Consumer group was not initialized, consumer#run must be called first");F.pause(e)},paused:()=>F?F.paused():[],resume:(e=[])=>{for(let t of e)if(t&&t.topic){if(void 0!==t.partitions&&(!Array.isArray(t.partitions)||t.partitions.some(isNaN)))throw new h(`Array of valid partitions required to resume specific partitions instead of ${t.partitions}`)}else throw new h(`Invalid topic ${t&&t.topic||t}`);if(!F)throw new h("Consumer group was not initialized, consumer#run must be called first");F.resume(e)},on:(e,t)=>{if(!x.includes(e))throw new h(`Event name should be one of ${A}`);return U.addListener(d(e),r=>{r.type=c(r.type),Promise.resolve(t(r)).catch(t=>{M.error(`Failed to execute listener: ${t.message}`,{eventName:e,stack:t.stack})})})},events:l,logger:()=>M}}},59544:(e,t,r)=>{let i=r(6388),s=r(86419),a=r(27086),n=s("consumer"),o={HEARTBEAT:n("heartbeat"),COMMIT_OFFSETS:n("commit_offsets"),GROUP_JOIN:n("group_join"),FETCH:n("fetch"),FETCH_START:n("fetch_start"),START_BATCH_PROCESS:n("start_batch_process"),END_BATCH_PROCESS:n("end_batch_process"),CONNECT:n("connect"),DISCONNECT:n("disconnect"),STOP:n("stop"),CRASH:n("crash"),REBALANCING:n("rebalancing"),RECEIVED_UNSUBSCRIBED_TOPICS:n("received_unsubscribed_topics"),REQUEST:n(a.NETWORK_REQUEST),REQUEST_TIMEOUT:n(a.NETWORK_REQUEST_TIMEOUT),REQUEST_QUEUE_SIZE:n(a.NETWORK_REQUEST_QUEUE_SIZE)},l={[o.REQUEST]:a.NETWORK_REQUEST,[o.REQUEST_TIMEOUT]:a.NETWORK_REQUEST_TIMEOUT,[o.REQUEST_QUEUE_SIZE]:a.NETWORK_REQUEST_QUEUE_SIZE},c=i(l);e.exports={events:o,wrap:e=>c[e]||e,unwrap:e=>l[e]||e}},37722:(e,t,r)=>{let i=r(25481),s=r(92607),a=r(99823),{events:{COMMIT_OFFSETS:n}}=r(59544),{keys:o,assign:l}=Object,c=e=>e.reduce((e,t)=>l(e,{[t]:{}}),{}),d={COMMITTED_OFFSETS:Symbol("private:OffsetManager:committedOffsets")};e.exports=class{constructor({cluster:e,coordinator:t,memberAssignment:r,autoCommit:i,autoCommitInterval:s,autoCommitThreshold:a,topicConfigurations:n,instrumentationEmitter:l,groupId:c,generationId:d,memberId:u}){this.cluster=e,this.coordinator=t,this.memberAssignment=r,this.topicConfigurations=n,this.instrumentationEmitter=l,this.groupId=c,this.generationId=d,this.memberId=u,this.autoCommit=i,this.autoCommitInterval=s,this.autoCommitThreshold=a,this.lastCommit=Date.now(),this.topics=o(r),this.clearAllOffsets()}nextOffset(e,t){this.resolvedOffsets[e][t]||(this.resolvedOffsets[e][t]=this.committedOffsets()[e][t]);let r=this.resolvedOffsets[e][t];return s(r)&&(r="0"),i.fromValue(r)}async getCoordinator(){return this.coordinator.isConnected()||(this.coordinator=await this.cluster.findBroker(this.coordinator)),this.coordinator}resetOffset({topic:e,partition:t}){this.resolvedOffsets[e][t]=this.committedOffsets()[e][t]}resolveOffset({topic:e,partition:t,offset:r}){this.resolvedOffsets[e][t]=i.fromValue(r).add(1).toString()}countResolvedOffsets(){let e=this.committedOffsets(),t=(e,t)=>{let r=i.fromValue(e);return s(t)?r:r.subtract(i.fromValue(t))},r=(e,r)=>o(e).map(i=>t(e[i],r[i]));return this.topics.flatMap(t=>r(this.resolvedOffsets[t],e[t])).reduce((e,t)=>e.add(t),i.fromValue(0))}async setDefaultOffset({topic:e,partition:t}){let{groupId:r,generationId:i,memberId:s}=this,a=this.cluster.defaultOffset(this.topicConfigurations[e]),n=await this.getCoordinator();await n.offsetCommit({groupId:r,memberId:s,groupGenerationId:i,topics:[{topic:e,partitions:[{partition:t,offset:a}]}]}),this.clearOffsets({topic:e,partition:t})}async seek({topic:e,partition:t,offset:r}){if(!this.memberAssignment[e]||!this.memberAssignment[e].includes(t))return;if(!this.autoCommit){this.resolveOffset({topic:e,partition:t,offset:i.fromValue(r).subtract(1).toString()});return}let{groupId:s,generationId:a,memberId:n}=this,o=await this.getCoordinator();await o.offsetCommit({groupId:s,memberId:n,groupGenerationId:a,topics:[{topic:e,partitions:[{partition:t,offset:r}]}]}),this.clearOffsets({topic:e,partition:t})}async commitOffsetsIfNecessary(){let e=Date.now(),t=null!=this.autoCommitInterval&&e>=this.lastCommit+this.autoCommitInterval,r=null!=this.autoCommitThreshold&&this.countResolvedOffsets().gte(i.fromValue(this.autoCommitThreshold));if(t||r)return this.commitOffsets()}uncommittedOffsets(){let e=e=>o(this.resolvedOffsets[e]),t=e=>t=>({partition:t,offset:this.resolvedOffsets[e][t]}),r=e=>({partition:t,offset:r})=>r!==this.committedOffsets()[e][t]&&i.fromValue(r).greaterThanOrEqual(0);return{topics:this.topics.map(i=>({topic:i,partitions:e(i).map(t(i)).filter(r(i))})).filter(({partitions:e})=>e.length>0)}}async commitOffsets(e={}){let{groupId:t,generationId:r,memberId:i}=this,{topics:s=this.uncommittedOffsets().topics}=e;if(0===s.length){this.lastCommit=Date.now();return}let a={groupId:t,memberId:i,groupGenerationId:r,topics:s};try{let e=await this.getCoordinator();await e.offsetCommit(a),this.instrumentationEmitter.emit(n,a),s.forEach(({topic:e,partitions:t})=>{let r=t.reduce((e,{partition:t,offset:r})=>l(e,{[t]:r}),{});this[d.COMMITTED_OFFSETS][e]=l({},this.committedOffsets()[e],r)}),this.lastCommit=Date.now()}catch(e){throw"NOT_COORDINATOR_FOR_GROUP"===e.type&&await this.cluster.refreshMetadata(),e}}async resolveOffsets(){let{groupId:e}=this,t=e=>t=>s(this.committedOffsets()[e][t]),r=this.topics.map(e=>({topic:e,partitions:this.memberAssignment[e].filter(t(e)).map(e=>({partition:e}))})).filter(e=>e.partitions.length>0);if(0===r.length)return;let i=await this.getCoordinator(),{responses:n}=await i.offsetFetch({groupId:e,topics:r}),o=n.map(({topic:e,partitions:t})=>l({topic:e,partitions:t.filter(({offset:e})=>s(e)).map(({partition:e})=>l({partition:e}))},this.topicConfigurations[e])),c=(e,{partition:t,offset:r})=>l(e,{[t]:r}),d=n;o.some(e=>e.partitions.length>0)&&(d=a(n,await this.cluster.fetchTopicsOffset(o))),d.forEach(({topic:e,partitions:t})=>{this.committedOffsets()[e]=t.reduce(c,{...this.committedOffsets()[e]})})}clearOffsets({topic:e,partition:t}){delete this.committedOffsets()[e][t],delete this.resolvedOffsets[e][t]}clearAllOffsets(){let e=this.committedOffsets();for(let t in e)delete e[t];for(let t of this.topics)e[t]={};this.resolvedOffsets=c(this.topics)}committedOffsets(){return this[d.COMMITTED_OFFSETS]||(this[d.COMMITTED_OFFSETS]=this.groupId?this.cluster.committedOffsets({groupId:this.groupId}):{}),this[d.COMMITTED_OFFSETS]}}},99823:(e,t,r)=>{let i=r(92607),{keys:s,assign:a}=Object,n=(e,{partition:t,offset:r})=>a(e,{[t]:r}),o=(e,{topic:t,partitions:r})=>a(e,{[t]:r.reduce(n,{})});e.exports=(e,t)=>{let r=e.reduce(o,{}),a=t.reduce(o,{});return s(r).map(e=>{let t=r[e];return{topic:e,partitions:s(t).map(r=>{let s=t[r],n=i(s)?a[e][r]:s;return{partition:Number(r),offset:n}})}})}},92607:(e,t,r)=>{let i=r(25481);e.exports=e=>!e&&0!==e||i.fromValue(e).isNegative()},40654:(e,t,r)=>{let{EventEmitter:i}=r(17702),s=r(25481),a=r(81620),{isKafkaJSError:n,isRebalancing:o}=r(15847),{events:{FETCH:l,FETCH_START:c,START_BATCH_PROCESS:d,END_BATCH_PROCESS:u,REBALANCING:h}}=r(59544),p=r(27853),f=(e,t)=>s.fromValue(e).equals(s.fromValue(t)),m="consuming-stop";e.exports=class extends i{constructor({logger:e,consumerGroup:t,instrumentationEmitter:r,eachBatchAutoResolve:i=!0,concurrency:s,eachBatch:n,eachMessage:o,heartbeatInterval:l,onCrash:c,retry:d,autoCommit:u=!0}){super(),this.logger=e.namespace("Runner"),this.consumerGroup=t,this.instrumentationEmitter=r,this.eachBatchAutoResolve=i,this.eachBatch=n,this.eachMessage=o,this.heartbeatInterval=l,this.retrier=a(Object.assign({},d)),this.onCrash=c,this.autoCommit=u,this.fetchManager=p({logger:this.logger,getNodeIds:()=>this.consumerGroup.getNodeIds(),fetch:e=>this.fetch(e),handler:e=>this.handleBatch(e),concurrency:s}),this.running=!1,this.consuming=!1}get consuming(){return this._consuming}set consuming(e){this._consuming!==e&&(this._consuming=e,this.emit(e?"consuming-start":m))}async start(){if(!this.running){try{await this.consumerGroup.connect(),await this.consumerGroup.joinAndSync()}catch(e){return this.onCrash(e)}this.running=!0,this.scheduleFetchManager()}}scheduleFetchManager(){if(!this.running){this.consuming=!1,this.logger.info("consumer not running, exiting",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId});return}this.consuming=!0,this.retrier(async(e,t,r)=>{if(this.running)try{await this.fetchManager.start()}catch(i){if(o(i)){this.logger.warn("The group is rebalancing, re-joining",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,error:i.message}),this.instrumentationEmitter.emit(h,{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId}),await this.consumerGroup.joinAndSync();return}if("UNKNOWN_MEMBER_ID"===i.type){this.logger.error("The coordinator is not aware of this member, re-joining the group",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,error:i.message}),this.consumerGroup.memberId=null,await this.consumerGroup.joinAndSync();return}if("KafkaJSNotImplemented"===i.name||"KafkaJSNoBrokerAvailableError"===i.name)return e(i);throw this.logger.debug("Error while scheduling fetch manager, trying again...",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,error:i.message,stack:i.stack,retryCount:t,retryTime:r}),i}}).then(()=>{this.scheduleFetchManager()}).catch(e=>{this.onCrash(e),this.consuming=!1,this.running=!1})}async stop(){if(this.running){this.logger.debug("stop consumer group",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId}),this.running=!1;try{await this.fetchManager.stop(),await this.waitForConsumer(),await this.consumerGroup.leave()}catch(e){}}}waitForConsumer(){return new Promise(e=>{if(!this.consuming)return e();this.logger.debug("waiting for consumer to finish...",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId}),this.once(m,()=>e())})}async heartbeat(){try{await this.consumerGroup.heartbeat({interval:this.heartbeatInterval})}catch(e){throw o(e)&&await this.autoCommitOffsets(),e}}async processEachMessage(e){let{topic:t,partition:r}=e,i=()=>(this.consumerGroup.pause([{topic:t,partitions:[r]}]),()=>this.consumerGroup.resume([{topic:t,partitions:[r]}]));for(let s of e.messages){if(!this.running||this.consumerGroup.hasSeekOffset({topic:t,partition:r}))break;try{await this.eachMessage({topic:t,partition:r,message:s,heartbeat:()=>this.heartbeat(),pause:i})}catch(e){throw n(e)||this.logger.error("Error when calling eachMessage",{topic:t,partition:r,offset:s.offset,stack:e.stack,error:e}),await this.autoCommitOffsets(),e}if(this.consumerGroup.resolveOffset({topic:t,partition:r,offset:s.offset}),await this.heartbeat(),await this.autoCommitOffsetsIfNecessary(),this.consumerGroup.isPaused(t,r))break}}async processEachBatch(e){let{topic:t,partition:r}=e,i=e.messages[e.messages.length-1];try{await this.eachBatch({batch:e,resolveOffset:s=>{let a=i&&f(s,i.offset)?e.lastOffset():s;this.consumerGroup.resolveOffset({topic:t,partition:r,offset:a})},heartbeat:()=>this.heartbeat(),pause:()=>(this.consumerGroup.pause([{topic:t,partitions:[r]}]),()=>this.consumerGroup.resume([{topic:t,partitions:[r]}])),commitOffsetsIfNecessary:async e=>e?this.consumerGroup.commitOffsets(e):this.consumerGroup.commitOffsetsIfNecessary(),uncommittedOffsets:()=>this.consumerGroup.uncommittedOffsets(),isRunning:()=>this.running,isStale:()=>this.consumerGroup.hasSeekOffset({topic:t,partition:r})})}catch(i){throw n(i)||this.logger.error("Error when calling eachBatch",{topic:t,partition:r,offset:e.firstOffset(),stack:i.stack,error:i}),await this.autoCommitOffsets(),i}this.eachBatchAutoResolve&&this.consumerGroup.resolveOffset({topic:t,partition:r,offset:e.lastOffset()})}async fetch(e){if(!this.running)return this.logger.debug("consumer not running, exiting",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId}),[];let t=Date.now();this.instrumentationEmitter.emit(c,{nodeId:e});let r=await this.consumerGroup.fetch(e);return this.instrumentationEmitter.emit(l,{numberOfBatches:0,duration:Date.now()-t,nodeId:e}),0===r.length&&await this.heartbeat(),r}async handleBatch(e){if(!this.running){this.logger.debug("consumer not running, exiting",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId});return}let t=async e=>{let t=Date.now(),r={topic:e.topic,partition:e.partition,highWatermark:e.highWatermark,offsetLag:e.offsetLag(),offsetLagLow:e.offsetLagLow(),batchSize:e.messages.length,firstOffset:e.firstOffset(),lastOffset:e.lastOffset()};if(e.isEmptyDueToFiltering()){this.instrumentationEmitter.emit(d,r),this.consumerGroup.resolveOffset({topic:e.topic,partition:e.partition,offset:e.lastOffset()}),await this.autoCommitOffsetsIfNecessary(),this.instrumentationEmitter.emit(u,{...r,duration:Date.now()-t}),await this.heartbeat();return}if(e.isEmpty()){await this.heartbeat();return}this.instrumentationEmitter.emit(d,r),this.eachMessage?await this.processEachMessage(e):this.eachBatch&&await this.processEachBatch(e),this.instrumentationEmitter.emit(u,{...r,duration:Date.now()-t}),await this.autoCommitOffsets(),await this.heartbeat()};await t(e)}autoCommitOffsets(){if(this.autoCommit)return this.consumerGroup.commitOffsets()}autoCommitOffsetsIfNecessary(){if(this.autoCommit)return this.consumerGroup.commitOffsetsIfNecessary()}commitOffsets(e){if(!this.running){this.logger.debug("consumer not running, exiting",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,offsets:e});return}return this.retrier(async(t,r,i)=>{try{await this.consumerGroup.commitOffsets(e)}catch(s){if(!this.running){this.logger.debug("consumer not running, exiting",{error:s.message,groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,offsets:e});return}if("KafkaJSNotImplemented"===s.name)return t(s);throw this.logger.debug("Error while committing offsets, trying again...",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,error:s.message,stack:s.stack,retryCount:r,retryTime:i,offsets:e}),s}})}}},24972:e=>{e.exports=class extends Map{getKey(e,t){return JSON.stringify([e,t])}set(e,t,r){let i=this.getKey(e,t);super.set(i,r)}has(e,t){let r=this.getKey(e,t);return super.has(r)}pop(e,t){if(0===this.size||!this.has(e,t))return;let r=this.getKey(e,t),i=this.get(r);return this.delete(r),{topic:e,partition:t,offset:i}}}},37994:e=>{let t=e=>({topic:e,paused:new Set,pauseAll:!1,resumed:new Set});e.exports=class{constructor(){this.assignedPartitionsByTopic={},this.subscriptionStatesByTopic={}}assign(e=[]){this.assignedPartitionsByTopic=e.reduce((e,{topic:t,partitions:r=[]})=>({...e,[t]:{topic:t,partitions:r}}),{})}pause(e=[]){e.forEach(({topic:e,partitions:r})=>{let i=this.subscriptionStatesByTopic[e]||t(e);void 0===r?(i.paused.clear(),i.resumed.clear(),i.pauseAll=!0):Array.isArray(r)&&(r.forEach(e=>{i.paused.add(e),i.resumed.delete(e)}),i.pauseAll=!1),this.subscriptionStatesByTopic[e]=i})}resume(e=[]){e.forEach(({topic:e,partitions:r})=>{let i=this.subscriptionStatesByTopic[e]||t(e);void 0===r?(i.paused.clear(),i.resumed.clear(),i.pauseAll=!1):Array.isArray(r)&&r.forEach(e=>{i.paused.delete(e),i.pauseAll&&i.resumed.add(e)}),this.subscriptionStatesByTopic[e]=i})}assigned(){return Object.values(this.assignedPartitionsByTopic).map(({topic:e,partitions:t})=>({topic:e,partitions:t.sort()}))}active(){return Object.values(this.assignedPartitionsByTopic).map(({topic:e,partitions:t})=>({topic:e,partitions:t.filter(t=>!this.isPaused(e,t)).sort()}))}paused(){return Object.values(this.assignedPartitionsByTopic).map(({topic:e,partitions:t})=>({topic:e,partitions:t.filter(t=>this.isPaused(e,t)).sort()})).filter(({partitions:e})=>0!==e.length)}isPaused(e,t){let r=this.subscriptionStatesByTopic[e];if(!r)return!1;let i=r.resumed.has(t),s=r.paused.has(t);return r.pauseAll&&!i||s}}},83117:(e,t,r)=>{let i=r(55416);e.exports=({handler:e,workerId:t})=>({run:i(async({next:r})=>{for(;;){let i=r();if(!i)break;let{batch:s,resolve:a,reject:n}=i;try{await e(s,{workerId:t}),a()}catch(e){n(e)}}})})},45528:e=>{e.exports=({workers:e})=>{let t=[];return{push:async(...r)=>{let i=r.map(e=>new Promise((r,i)=>t.push({batch:e,resolve:r,reject:i})));e.forEach(e=>e.run({next:()=>t.shift()}));let s=(await Promise.allSettled(i)).find(e=>"rejected"===e.status);if(s)throw s.reason},getWorkers:()=>e}}},17717:e=>{e.exports=()=>({KAFKAJS_DEBUG_PROTOCOL_BUFFERS:process.env.KAFKAJS_DEBUG_PROTOCOL_BUFFERS,KAFKAJS_DEBUG_EXTENDED_PROTOCOL_BUFFERS:process.env.KAFKAJS_DEBUG_EXTENDED_PROTOCOL_BUFFERS})},15847:(e,t,r)=>{let{bugs:i}=r(25828);class s extends Error{constructor(e,{retriable:t=!0,cause:r}={}){super(e,{cause:r}),Error.captureStackTrace(this,this.constructor),this.message=e.message||e,this.name="KafkaJSError",this.retriable=t,this.helpUrl=e.helpUrl,this.cause=r}}class a extends s{constructor(e,{cause:t}={}){super(e,{retriable:!1,cause:t}),this.name="KafkaJSNonRetriableError"}}class n extends s{constructor(e,{retriable:t=e.retriable}={}){super(e,{retriable:t}),this.type=e.type,this.code=e.code,this.name="KafkaJSProtocolError"}}class o extends n{constructor(e,{topic:t,partition:r}){super(e),this.topic=t,this.partition=r,this.name="KafkaJSOffsetOutOfRange"}}class l extends n{constructor(e,{memberId:t}){super(e),this.memberId=t,this.name="KafkaJSMemberIdRequired"}}class c extends a{constructor(e,{retryCount:t,retryTime:r}){super(e,{cause:e}),this.stack=`${this.name}
  Caused by: ${e.stack}`,this.retryCount=t,this.retryTime=r,this.name="KafkaJSNumberOfRetriesExceeded"}}class d extends s{constructor(e,{broker:t,code:r}={}){super(e),this.broker=t,this.code=r,this.name="KafkaJSConnectionError"}}class u extends d{constructor(e,{host:t,port:r}={}){super(e,{broker:`${t}:${r}`}),this.host=t,this.port=r,this.name="KafkaJSConnectionClosedError"}}class h extends s{constructor(e,{broker:t,correlationId:r,createdAt:i,sentAt:s,pendingDuration:a}={}){super(e),this.broker=t,this.correlationId=r,this.createdAt=i,this.sentAt=s,this.pendingDuration=a,this.name="KafkaJSRequestTimeoutError"}}class p extends s{constructor(){super(...arguments),this.name="KafkaJSMetadataNotLoaded"}}class f extends p{constructor(e,{topic:t}={}){super(e),this.topic=t,this.name="KafkaJSTopicMetadataNotLoaded"}}class m extends s{constructor(e,{topic:t,unknownPartitions:r}={}){super(e),this.topic=t,this.unknownPartitions=r,this.name="KafkaJSStaleTopicMetadataAssignment"}}class g extends s{constructor(e,t=[]){super(e),this.groups=t,this.name="KafkaJSDeleteGroupsError"}}class w extends a{constructor(e,{apiKey:t,apiName:r}={}){super(e),this.apiKey=t,this.apiName=r,this.name="KafkaJSServerDoesNotSupportApiKey"}}class I extends s{constructor(){super(...arguments),this.name="KafkaJSBrokerNotFound"}}class y extends a{constructor(){super(...arguments),this.name="KafkaJSPartialMessageError"}}class b extends a{constructor(){super(...arguments),this.name="KafkaJSSASLAuthenticationError"}}class T extends a{constructor(){super(...arguments),this.name="KafkaJSGroupCoordinatorNotFound"}}class E extends a{constructor(){super(...arguments),this.name="KafkaJSNotImplemented"}}class S extends a{constructor(){super(...arguments),this.name="KafkaJSTimeout"}}class x extends S{constructor(){super(...arguments),this.name="KafkaJSLockTimeout"}}class A extends a{constructor(){super(...arguments),this.name="KafkaJSUnsupportedMagicByteInMessageSet"}}class O extends s{constructor({partitions:e}){super("Error while deleting records",{retriable:e.filter(({error:e})=>null!=e).every(({error:e})=>!0===e.retriable)}),this.name="KafkaJSDeleteTopicRecordsError",this.partitions=e}}let R=i?i.url:null;class N extends a{constructor(e){let t=e.message||e;if(super(`Invariant violated: ${t}. This is likely a bug and should be reported.`),this.name="KafkaJSInvariantViolation",null!==R){let e=encodeURIComponent(`Invariant violation: ${t}`);this.helpUrl=`${R}/new?assignees=&labels=bug&template=bug_report.md&title=${e}`}}}class C extends a{constructor(){super(...arguments),this.name="KafkaJSNonRetriableError"}}class _ extends a{constructor(){super(...arguments),this.name="KafkaJSNonRetriableError"}}class k extends n{constructor(e,t){super(e),this.topic=t,this.name="KafkaJSCreateTopicError"}}class v extends n{constructor(e,t,r){super(e),this.topic=t,this.partition=r,this.name="KafkaJSAlterPartitionReassignmentsError"}}class D extends Error{constructor(e,t){super(e),this.errors=t,this.name="KafkaJSAggregateError"}}class P extends Error{}class B extends s{constructor(){super("No broker available"),this.name="KafkaJSNoBrokerAvailableError"}}e.exports={KafkaJSError:s,KafkaJSNonRetriableError:a,KafkaJSPartialMessageError:y,KafkaJSBrokerNotFound:I,KafkaJSProtocolError:n,KafkaJSConnectionError:d,KafkaJSConnectionClosedError:u,KafkaJSRequestTimeoutError:h,KafkaJSSASLAuthenticationError:b,KafkaJSNumberOfRetriesExceeded:c,KafkaJSOffsetOutOfRange:o,KafkaJSMemberIdRequired:l,KafkaJSGroupCoordinatorNotFound:T,KafkaJSNotImplemented:E,KafkaJSMetadataNotLoaded:p,KafkaJSTopicMetadataNotLoaded:f,KafkaJSStaleTopicMetadataAssignment:m,KafkaJSDeleteGroupsError:g,KafkaJSTimeout:S,KafkaJSLockTimeout:x,KafkaJSServerDoesNotSupportApiKey:w,KafkaJSUnsupportedMagicByteInMessageSet:A,KafkaJSDeleteTopicRecordsError:O,KafkaJSInvariantViolation:N,KafkaJSInvalidVarIntError:C,KafkaJSInvalidLongError:_,KafkaJSCreateTopicError:k,KafkaJSAggregateError:D,KafkaJSFetcherRebalanceError:P,KafkaJSNoBrokerAvailableError:B,KafkaJSAlterPartitionReassignmentsError:v,isRebalancing:e=>"REBALANCE_IN_PROGRESS"===e.type||"NOT_COORDINATOR_FOR_GROUP"===e.type||"ILLEGAL_GENERATION"===e.type,isKafkaJSError:e=>e instanceof s}},81367:(e,t,r)=>{let{createLogger:i,LEVELS:{INFO:s}}=r(63243),a=r(23920),n=r(32771),o=r(10545),l=r(61430),c=r(59492),d=r(31172),u=r(20236),h=r(55911),p=r(60052),f=r(19681),m={CREATE_CLUSTER:Symbol("private:Kafka:createCluster"),CLUSTER_RETRY:Symbol("private:Kafka:clusterRetry"),LOGGER:Symbol("private:Kafka:logger"),OFFSETS:Symbol("private:Kafka:offsets")},g=p(e=>{null==process.env.KAFKAJS_NO_PARTITIONER_WARNING&&e.warn(`KafkaJS v2.0.0 switched default partitioner. To retain the same partitioning behavior as in previous versions, create the producer with the option "createPartitioner: Partitioners.LegacyPartitioner". See the migration guide at ${f("docs/migration-guide-v2.0.0","producer-new-default-partitioner")} for details. Silence this warning by setting the environment variable "KAFKAJS_NO_PARTITIONER_WARNING=1"`)});e.exports=class{constructor({brokers:e,ssl:t,sasl:r,clientId:a,connectionTimeout:l=1e3,authenticationTimeout:c,reauthenticationThreshold:d,requestTimeout:u,enforceRequestTimeout:p=!0,retry:f,socketFactory:g=h(),logLevel:w=s,logCreator:I=n}){this[m.OFFSETS]=new Map,this[m.LOGGER]=i({level:w,logCreator:I}),this[m.CLUSTER_RETRY]=f,this[m.CREATE_CLUSTER]=({metadataMaxAge:i,allowAutoTopicCreation:s=!0,maxInFlightRequests:n=null,instrumentationEmitter:h=null,isolationLevel:f})=>new o({logger:this[m.LOGGER],retry:this[m.CLUSTER_RETRY],offsets:this[m.OFFSETS],socketFactory:g,brokers:e,ssl:t,sasl:r,clientId:a,connectionTimeout:l,authenticationTimeout:c,reauthenticationThreshold:d,requestTimeout:u,enforceRequestTimeout:p,metadataMaxAge:i,instrumentationEmitter:h,allowAutoTopicCreation:s,maxInFlightRequests:n,isolationLevel:f})}producer({createPartitioner:e,retry:t,metadataMaxAge:r=3e5,allowAutoTopicCreation:i,idempotent:s,transactionalId:n,transactionTimeout:o,maxInFlightRequests:c}={}){let d=new a,u=this[m.CREATE_CLUSTER]({metadataMaxAge:r,allowAutoTopicCreation:i,maxInFlightRequests:c,instrumentationEmitter:d});return null==e&&g(this[m.LOGGER]),l({retry:{...this[m.CLUSTER_RETRY],...t},logger:this[m.LOGGER],cluster:u,createPartitioner:e,idempotent:s,transactionalId:n,transactionTimeout:o,instrumentationEmitter:d})}consumer({groupId:e,partitionAssigners:t,metadataMaxAge:r=3e5,sessionTimeout:i,rebalanceTimeout:s,heartbeatInterval:n,maxBytesPerPartition:o,minBytes:l,maxBytes:d,maxWaitTimeInMs:h,retry:p={retries:5},allowAutoTopicCreation:f,maxInFlightRequests:g,readUncommitted:w=!1,rackId:I=""}={}){let y=w?u.READ_UNCOMMITTED:u.READ_COMMITTED,b=new a,T=this[m.CREATE_CLUSTER]({metadataMaxAge:r,allowAutoTopicCreation:f,maxInFlightRequests:g,isolationLevel:y,instrumentationEmitter:b});return c({retry:{...this[m.CLUSTER_RETRY],...p},logger:this[m.LOGGER],cluster:T,groupId:e,partitionAssigners:t,sessionTimeout:i,rebalanceTimeout:s,heartbeatInterval:n,maxBytesPerPartition:o,minBytes:l,maxBytes:d,maxWaitTimeInMs:h,isolationLevel:y,instrumentationEmitter:b,rackId:I,metadataMaxAge:r})}admin({retry:e}={}){let t=new a,r=this[m.CREATE_CLUSTER]({allowAutoTopicCreation:!1,instrumentationEmitter:t});return d({retry:{...this[m.CLUSTER_RETRY],...e},logger:this[m.LOGGER],instrumentationEmitter:t,cluster:r})}logger(){return this[m.LOGGER]}}},23920:(e,t,r)=>{let{EventEmitter:i}=r(17702),s=r(46107),{KafkaJSError:a}=r(15847);e.exports=class{constructor(){this.emitter=new i}emit(e,t){if(!e)throw new a("Invalid event name",{retriable:!1});if(this.emitter.listenerCount(e)>0){let r=new s(e,t);this.emitter.emit(e,r)}}addListener(e,t){return this.emitter.addListener(e,t),()=>this.emitter.removeListener(e,t)}}},46107:e=>{let t=0,r=()=>(t===Number.MAX_VALUE&&(t=0),t++);class i{constructor(e,t){this.id=r(),this.type=e,this.timestamp=Date.now(),this.payload=t}}e.exports=i},86419:e=>{e.exports=e=>t=>`${e}.${t}`},32771:(e,t,r)=>{let{LEVELS:i}=r(63243);e.exports=()=>({namespace:e,level:t,label:r,log:s})=>{let a=e?`[${e}] `:"",n=JSON.stringify(Object.assign({level:r},s,{message:`${a}${s.message}`}));switch(t){case i.INFO:return console.info(n);case i.ERROR:return console.error(n);case i.WARN:return console.warn(n);case i.DEBUG:return console.log(n)}}},63243:e=>{let{assign:t}=Object,r={NOTHING:0,ERROR:1,WARN:2,INFO:4,DEBUG:5},i=(e,r,i,s,a)=>(n,o={})=>{r>i()||a({namespace:s,level:r,label:e,log:t({timestamp:new Date().toISOString(),logger:"kafkajs",message:n},o)})},s=e=>{let t=(process.env.KAFKAJS_LOG_LEVEL||"").toUpperCase();return null==r[t]?e:r[t]};e.exports={LEVELS:r,createLogger:({level:e=r.INFO,logCreator:a}={})=>{let n=s(e),o=a(n),l=(e,t=null)=>c(e,s(t)),c=(e,s=null)=>{let a=()=>null==s?n:s;return t({info:i("INFO",r.INFO,a,e,o),error:i("ERROR",r.ERROR,a,e,o),warn:i("WARN",r.WARN,a,e,o),debug:i("DEBUG",r.DEBUG,a,e,o)},{namespace:l,setLogLevel:e=>{n=e}})};return c()}}},91638:(e,t,r)=>{let i=r(34622),s=r(2292),a=r(10243),{KafkaJSConnectionError:n,KafkaJSConnectionClosedError:o}=r(15847),{INT_32_MAX_VALUE:l}=r(87873),c=r(17717),d=r(83647),{CONNECTION_STATUS:u,CONNECTED_STATUS:h}=r(14273),p=r(55416),f=r(25481),m=r(68985),g=r(80146),w=({apiName:e,apiKey:t,apiVersion:r})=>`${e}(key: ${t}, version: ${r})`,I=e=>![g.ApiVersions,g.SaslHandshake,g.SaslAuthenticate].includes(e.apiKey),y={SHOULD_REAUTHENTICATE:Symbol("private:Connection:shouldReauthenticate"),AUTHENTICATE:Symbol("private:Connection:authenticate")};e.exports=class{constructor({host:e,port:t,logger:r,socketFactory:i,requestTimeout:s,reauthenticationThreshold:n=1e4,rack:o=null,ssl:l=null,sasl:h=null,clientId:g="kafkajs",connectionTimeout:w,enforceRequestTimeout:I=!0,maxInFlightRequests:b=null,instrumentationEmitter:T=null}){this.host=e,this.port=t,this.rack=o,this.clientId=g,this.broker=`${this.host}:${this.port}`,this.logger=r.namespace("Connection"),this.socketFactory=i,this.ssl=l,this.sasl=h,this.requestTimeout=s,this.connectionTimeout=w,this.reauthenticationThreshold=n,this.bytesBuffered=0,this.bytesNeeded=a.int32Size(),this.chunks=[],this.connectionStatus=u.DISCONNECTED,this.correlationId=0,this.requestQueue=new d({instrumentationEmitter:T,maxInFlightRequests:b,requestTimeout:s,enforceRequestTimeout:I,clientId:g,broker:this.broker,logger:r.namespace("RequestQueue"),isConnected:()=>this.isConnected()}),this.versions=null,this.authHandlers=null,this.authExpectResponse=!1;let E=e=>(t,r={})=>{(0,this.logger[e])(t,{broker:this.broker,clientId:g,...r})};this.logDebug=E("debug"),this.logError=E("error");let S=c();this.shouldLogBuffers="1"===S.KAFKAJS_DEBUG_PROTOCOL_BUFFERS,this.shouldLogFetchBuffer=this.shouldLogBuffers&&"1"===S.KAFKAJS_DEBUG_EXTENDED_PROTOCOL_BUFFERS,this.authenticatedAt=null,this.sessionLifetime=f.ZERO,this.supportAuthenticationProtocol=null,this[y.AUTHENTICATE]=p(async()=>{if(this.sasl&&!this.isAuthenticated()){let e=new m(this,this.logger,this.versions,this.supportAuthenticationProtocol);await e.authenticate(),this.authenticatedAt=process.hrtime(),this.sessionLifetime=f.fromValue(e.sessionLifetime)}})}getSupportAuthenticationProtocol(){return this.supportAuthenticationProtocol}setSupportAuthenticationProtocol(e){this.supportAuthenticationProtocol=e}setVersions(e){this.versions=e}isConnected(){return h.includes(this.connectionStatus)}connect(){return new Promise((e,t)=>{let r;if(this.isConnected())return e(!0);this.authenticatedAt=null;let s=async()=>{clearTimeout(r);let e=this.isConnected();this.authHandlers?this.authHandlers.onError():e&&(this.logDebug("Kafka server has closed connection"),this.rejectRequests(new o("Closed connection",{host:this.host,port:this.port}))),await this.disconnect()},a=async e=>{clearTimeout(r);let i=new n(`Connection error: ${e.message}`,{broker:`${this.host}:${this.port}`,code:e.code});this.logError(i.message,{stack:e.stack}),this.rejectRequests(i),await this.disconnect(),t(i)},l=async()=>{let e=new n("Connection timeout",{broker:`${this.host}:${this.port}`});this.logError(e.message),this.rejectRequests(e),await this.disconnect(),t(e)};this.logDebug("Connecting",{ssl:!!this.ssl,sasl:!!this.sasl});try{r=setTimeout(l,this.connectionTimeout),this.socket=i({socketFactory:this.socketFactory,host:this.host,port:this.port,ssl:this.ssl,onConnect:()=>{clearTimeout(r),this.connectionStatus=u.CONNECTED,this.requestQueue.scheduleRequestTimeoutCheck(),e(!0)},onData:e=>{this.processData(e)},onEnd:s,onError:a,onTimeout:l})}catch(e){clearTimeout(r),t(new n(`Failed to connect: ${e.message}`,{broker:`${this.host}:${this.port}`}))}})}async disconnect(){return this.authenticatedAt=null,this.connectionStatus=u.DISCONNECTING,this.logDebug("disconnecting..."),await this.requestQueue.waitForPendingRequests(),this.requestQueue.destroy(),this.socket&&(this.socket.end(),this.socket.unref()),this.connectionStatus=u.DISCONNECTED,this.logDebug("disconnected"),!0}isAuthenticated(){return null!=this.authenticatedAt&&!this[y.SHOULD_REAUTHENTICATE]()}[y.SHOULD_REAUTHENTICATE](){if(this.sessionLifetime.equals(f.ZERO))return!1;if(null==this.authenticatedAt)return!0;let[e,t]=process.hrtime(this.authenticatedAt);return f.fromValue(e).multiply(1e3).add(f.fromValue(t).divide(1e6)).add(this.reauthenticationThreshold).greaterThanOrEqual(this.sessionLifetime)}async authenticate(){await this[y.AUTHENTICATE]()}sendAuthRequest({request:e,response:t}){return this.authExpectResponse=!!t,new Promise(async(r,i)=>{this.authHandlers={onSuccess:e=>{this.authHandlers=null,this.authExpectResponse=!1,t.decode(e).then(e=>t.parse(e)).then(r).catch(i)},onError:()=>{this.authHandlers=null,this.authExpectResponse=!1,i(new n("Connection closed by the server",{broker:`${this.host}:${this.port}`}))}};try{let t=await e.encode();this.failIfNotConnected(),this.socket.write(t,"binary")}catch(e){i(e)}})}async send({request:e,response:t,requestTimeout:r=null,logResponseError:i=!0}){!this.isAuthenticated()&&I(e)&&await this[y.AUTHENTICATE](),this.failIfNotConnected();let a=!e.expectResponse||e.expectResponse(),n=async()=>{let{clientId:t}=this,i=this.nextCorrelationId(),n=await s({request:e,correlationId:i,clientId:t}),{apiKey:o,apiName:l,apiVersion:c}=e;return this.logDebug(`Request ${w(e)}`,{correlationId:i,expectResponse:a,size:Buffer.byteLength(n.buffer)}),new Promise((e,t)=>{try{this.failIfNotConnected(),this.requestQueue.push({entry:{apiKey:o,apiName:l,apiVersion:c,correlationId:i,resolve:e,reject:t},expectResponse:a,requestTimeout:r,sendRequest:()=>{this.socket.write(n.buffer,"binary")}})}catch(e){t(e)}})},{correlationId:o,size:l,entry:c,payload:d}=await n();if(a)try{let e=await t.decode(d);this.requestQueue.maybeThrottle(e.clientSideThrottleTime);let r=await t.parse(e),i="Fetch"===c.apiName;return this.logDebug(`Response ${w(c)}`,{correlationId:o,size:l,data:i&&!this.shouldLogFetchBuffer?"[filtered]":r}),r}catch(t){i&&this.logError(`Response ${w(c)}`,{error:t.message,correlationId:o,size:l});let e=Buffer.isBuffer(d);throw this.logDebug(`Response ${w(c)}`,{error:t.message,correlationId:o,payload:e&&!this.shouldLogBuffers?{type:"Buffer",data:"[filtered]"}:d}),t}}failIfNotConnected(){if(!this.isConnected())throw new n("Not connected",{broker:`${this.host}:${this.port}`})}nextCorrelationId(){return this.correlationId>=l&&(this.correlationId=0),this.correlationId++}processData(e){if(this.authHandlers&&!this.authExpectResponse)return this.authHandlers.onSuccess(e);for(this.chunks.push(e),this.bytesBuffered+=Buffer.byteLength(e);this.bytesNeeded<=this.bytesBuffered;){let e=this.chunks.length>1?Buffer.concat(this.chunks):this.chunks[0],t=new a(e),r=t.readInt32();if(!t.canReadBytes(r)){this.chunks=[e],this.bytesBuffered=Buffer.byteLength(e),this.bytesNeeded=a.int32Size()+r;return}let i=new a(t.readBytes(r)),s=t.readAll();if(this.chunks=[s],this.bytesBuffered=Buffer.byteLength(s),this.bytesNeeded=a.int32Size(),this.authHandlers){let t=a.int32Size()+r,i=e.slice(0,t);return this.authHandlers.onSuccess(i)}let n=i.readInt32(),o=i.readAll();this.requestQueue.fulfillRequest({size:r,correlationId:n,payload:o})}}rejectRequests(e){this.requestQueue.rejectAll(e)}}},31715:(e,t,r)=>{let i=r(80146),s=r(91638);e.exports=class{constructor(e){this.logger=e.logger.namespace("ConnectionPool"),this.connectionTimeout=e.connectionTimeout,this.host=e.host,this.port=e.port,this.rack=e.rack,this.ssl=e.ssl,this.sasl=e.sasl,this.clientId=e.clientId,this.socketFactory=e.socketFactory,this.pool=[,,].fill().map(()=>new s(e))}isConnected(){return this.pool.some(e=>e.isConnected())}isAuthenticated(){return this.pool.some(e=>e.isAuthenticated())}setSupportAuthenticationProtocol(e){this.map(t=>t.setSupportAuthenticationProtocol(e))}setVersions(e){this.map(t=>t.setVersions(e))}map(e){return this.pool.map(t=>e(t))}async send(e){return(await this.getConnectionByRequest(e)).send(e)}getConnectionByRequest({request:{apiKey:e}}){let t={[i.Fetch]:1}[e]||0;return this.getConnection(t)}async getConnection(e=0){let t=this.pool[e];return t.isConnected()||await t.connect(),t}async destroy(){await Promise.all(this.map(e=>e.disconnect()))}}},14273:e=>{let t={CONNECTED:"connected",DISCONNECTING:"disconnecting",DISCONNECTED:"disconnected"},r=[t.CONNECTED,t.DISCONNECTING];e.exports={CONNECTION_STATUS:t,CONNECTED_STATUS:r}},27086:(e,t,r)=>{let i=r(86419)("network");e.exports={NETWORK_REQUEST:i("request"),NETWORK_REQUEST_TIMEOUT:i("request_timeout"),NETWORK_REQUEST_QUEUE_SIZE:i("request_queue_size")}},83647:(e,t,r)=>{let{EventEmitter:i}=r(17702),s=r(32576),a=r(27086),{KafkaJSInvariantViolation:n}=r(15847),o={EMIT_QUEUE_SIZE_EVENT:Symbol("private:RequestQueue:emitQueueSizeEvent"),EMIT_REQUEST_QUEUE_EMPTY:Symbol("private:RequestQueue:emitQueueEmpty")},l="requestQueueEmpty";e.exports=class extends i{constructor({instrumentationEmitter:e=null,maxInFlightRequests:t,requestTimeout:r,enforceRequestTimeout:i,clientId:s,broker:n,logger:c,isConnected:d=()=>!0}){super(),this.instrumentationEmitter=e,this.maxInFlightRequests=t,this.requestTimeout=r,this.enforceRequestTimeout=i,this.clientId=s,this.broker=n,this.logger=c,this.isConnected=d,this.inflight=new Map,this.pending=[],this.throttledUntil=-1,this.throttleCheckTimeoutId=null,this[o.EMIT_REQUEST_QUEUE_EMPTY]=()=>{0===this.pending.length&&0===this.inflight.size&&this.emit(l)},this[o.EMIT_QUEUE_SIZE_EVENT]=()=>{e&&e.emit(a.NETWORK_REQUEST_QUEUE_SIZE,{broker:this.broker,clientId:this.clientId,queueSize:this.pending.length}),this[o.EMIT_REQUEST_QUEUE_EMPTY]()}}scheduleRequestTimeoutCheck(){this.enforceRequestTimeout&&(this.destroy(),this.requestTimeoutIntervalId=setInterval(()=>{this.inflight.forEach(e=>{Date.now()-e.sentAt>e.requestTimeout&&e.timeoutRequest()}),this.isConnected()||this.destroy()},Math.min(this.requestTimeout,100)))}maybeThrottle(e){if(null!==e&&e>0){this.logger.debug(`Client side throttling in effect for ${e}ms`);let t=Date.now()+e;this.throttledUntil=Math.max(t,this.throttledUntil)}}createSocketRequest(e){let{correlationId:t}=e.entry,r=Math.max(this.requestTimeout,e.requestTimeout||0),i=new s({entry:e.entry,expectResponse:e.expectResponse,broker:this.broker,clientId:this.clientId,instrumentationEmitter:this.instrumentationEmitter,requestTimeout:r,send:()=>{if(this.inflight.has(t))throw new n("Correlation id already exists");this.inflight.set(t,i),e.sendRequest()},timeout:()=>{this.inflight.delete(t),this.checkPendingRequests(),this[o.EMIT_REQUEST_QUEUE_EMPTY]()}});return i}push(e){let{correlationId:t}=e.entry,r=this.createSocketRequest(e);if(this.canSendSocketRequestImmediately()){this.sendSocketRequest(r);return}this.pending.push(r),this.scheduleCheckPendingRequests(),this.logger.debug("Request enqueued",{clientId:this.clientId,broker:this.broker,correlationId:t}),this[o.EMIT_QUEUE_SIZE_EVENT]()}sendSocketRequest(e){e.send(),e.expectResponse||(this.logger.debug("Request does not expect a response, resolving immediately",{clientId:this.clientId,broker:this.broker,correlationId:e.correlationId}),this.inflight.delete(e.correlationId),e.completed({size:0,payload:null}))}fulfillRequest({correlationId:e,payload:t,size:r}){let i=this.inflight.get(e);this.inflight.delete(e),this.checkPendingRequests(),i?i.completed({size:r,payload:t}):this.logger.warn("Response without match",{clientId:this.clientId,broker:this.broker,correlationId:e}),this[o.EMIT_REQUEST_QUEUE_EMPTY]()}rejectAll(e){for(let t of[...this.inflight.values(),...this.pending])t.rejected(e),this.inflight.delete(t.correlationId);this.pending=[],this.inflight.clear(),this[o.EMIT_QUEUE_SIZE_EVENT]()}waitForPendingRequests(){return new Promise(e=>{if(0===this.pending.length&&0===this.inflight.size)return e();this.logger.debug("Waiting for pending requests",{clientId:this.clientId,broker:this.broker,currentInflightRequests:this.inflight.size,currentPendingQueueSize:this.pending.length}),this.once(l,()=>e())})}destroy(){clearInterval(this.requestTimeoutIntervalId),clearTimeout(this.throttleCheckTimeoutId),this.throttleCheckTimeoutId=null}canSendSocketRequestImmediately(){return!(null!=this.maxInFlightRequests&&this.inflight.size>=this.maxInFlightRequests||this.throttledUntil>Date.now())}checkPendingRequests(){for(;this.pending.length>0&&this.canSendSocketRequestImmediately();){let e=this.pending.shift();this.sendSocketRequest(e),this.logger.debug("Consumed pending request",{clientId:this.clientId,broker:this.broker,correlationId:e.correlationId,pendingDuration:e.pendingDuration,currentPendingQueueSize:this.pending.length}),this[o.EMIT_QUEUE_SIZE_EVENT]()}this.scheduleCheckPendingRequests()}scheduleCheckPendingRequests(){let e=this.throttledUntil-Date.now();this.throttleCheckTimeoutId||(this.pending.length>0&&(e=e>0?e:10),this.throttleCheckTimeoutId=setTimeout(()=>{this.throttleCheckTimeoutId=null,this.checkPendingRequests()},e))}}},32576:(e,t,r)=>{let{KafkaJSRequestTimeoutError:i,KafkaJSNonRetriableError:s}=r(15847),a=r(27086),n={STATE:Symbol("private:SocketRequest:state"),EMIT_EVENT:Symbol("private:SocketRequest:emitEvent")},o={PENDING:Symbol("PENDING"),SENT:Symbol("SENT"),COMPLETED:Symbol("COMPLETED"),REJECTED:Symbol("REJECTED")};e.exports=class{constructor({requestTimeout:e,broker:t,clientId:r,entry:i,expectResponse:s,send:a,timeout:l,instrumentationEmitter:c=null}){this.createdAt=Date.now(),this.requestTimeout=e,this.broker=t,this.clientId=r,this.entry=i,this.correlationId=i.correlationId,this.expectResponse=s,this.sendRequest=a,this.timeoutHandler=l,this.sentAt=null,this.duration=null,this.pendingDuration=null,this[n.STATE]=o.PENDING,this[n.EMIT_EVENT]=(e,t)=>c&&c.emit(e,t)}send(){this.throwIfInvalidState({accepted:[o.PENDING],next:o.SENT}),this.sendRequest(),this.sentAt=Date.now(),this.pendingDuration=this.sentAt-this.createdAt,this[n.STATE]=o.SENT}timeoutRequest(){let{apiName:e,apiKey:t,apiVersion:r}=this.entry,s=`${e}(key: ${t}, version: ${r})`,o={broker:this.broker,clientId:this.clientId,correlationId:this.correlationId,createdAt:this.createdAt,sentAt:this.sentAt,pendingDuration:this.pendingDuration};this.timeoutHandler(),this.rejected(new i(`Request ${s} timed out`,o)),this[n.EMIT_EVENT](a.NETWORK_REQUEST_TIMEOUT,{...o,apiName:e,apiKey:t,apiVersion:r})}completed({size:e,payload:t}){this.throwIfInvalidState({accepted:[o.SENT],next:o.COMPLETED});let{entry:r,correlationId:i,broker:s,clientId:l,createdAt:c,sentAt:d,pendingDuration:u}=this;this[n.STATE]=o.COMPLETED,this.duration=Date.now()-this.sentAt,r.resolve({correlationId:i,entry:r,size:e,payload:t}),this[n.EMIT_EVENT](a.NETWORK_REQUEST,{broker:s,clientId:l,correlationId:i,size:e,createdAt:c,sentAt:d,pendingDuration:u,duration:this.duration,apiName:r.apiName,apiKey:r.apiKey,apiVersion:r.apiVersion})}rejected(e){this.throwIfInvalidState({accepted:[o.PENDING,o.SENT],next:o.REJECTED}),this[n.STATE]=o.REJECTED,this.duration=Date.now()-this.sentAt,this.entry.reject(e)}throwIfInvalidState({accepted:e,next:t}){if(e.includes(this[n.STATE]))return;let r=this[n.STATE].toString();throw new s(`Invalid state, can't transition from ${r} to ${t.toString()}`)}}},34622:e=>{e.exports=({socketFactory:e,host:t,port:r,ssl:i,onConnect:s,onData:a,onEnd:n,onError:o,onTimeout:l})=>{let c=e({host:t,port:r,ssl:i,onConnect:s});return c.on("data",a),c.on("end",n),c.on("error",o),c.on("timeout",l),c}},55911:(e,t,r)=>{e.exports=()=>{let e=r(98216),t=r(82452);return({host:r,port:i,ssl:s,onConnect:a})=>{let n=s?t.connect(Object.assign({host:r,port:i},e.isIP(r)?{}:{servername:r},s),a):e.connect({host:r,port:i},a);return n.setKeepAlive(!0,6e4),n}}},33502:e=>{e.exports=e=>e.map(({topic:e,partitions:t,messagesPerPartition:r,sequencePerPartition:i})=>({topic:e,partitions:t.map(e=>({partition:e,messages:r[e]}))}))},97938:(e,t,r)=>{let i=r(81620),s=r(22003),{KafkaJSNonRetriableError:a}=r(15847),n=r(46212),o=r(14227),{INT_32_MAX_VALUE:l}=r(87873),c=r(27790),d=r(37082),u=["NOT_COORDINATOR_FOR_GROUP","GROUP_COORDINATOR_NOT_AVAILABLE","GROUP_LOAD_IN_PROGRESS","CONCURRENT_TRANSACTIONS"],h=["UNKNOWN_TOPIC_OR_PARTITION","COORDINATOR_LOAD_IN_PROGRESS"],p=["COORDINATOR_NOT_AVAILABLE","NOT_COORDINATOR"];e.exports=({logger:e,cluster:t,transactionTimeout:r=6e4,transactional:f,transactionalId:m})=>{if(f&&!m)throw new a("Cannot manage transactions without a transactionalId");let g=i(t.retry),w=-1,I=0,y={},b={},T={},E=!1,S=o({logger:e});S.on("transition",({to:e})=>{e===d.READY&&(T={},E=!1)});let x=()=>t.findGroupCoordinator({groupId:m,coordinatorType:n.TRANSACTION}),A=()=>{if(!f)throw new a("Method unavailable if non-transactional")},O=()=>E||Object.entries(T).some(([,e])=>Object.entries(e).some(([,e])=>e)),R=S.createGuarded({getProducerId:()=>w,getProducerEpoch:()=>I,getTransactionalId:()=>m,initProducerId:async()=>g(async(i,s,a)=>{try{await t.refreshMetadataIfNecessary();let i=await (f?x():t.findControllerBroker()),s=await i.initProducerId({transactionalId:f?m:void 0,transactionTimeout:r});S.transitionTo(d.READY),w=s.producerId,I=s.producerEpoch,y={},b={},e.debug("Initialized producer id & epoch",{producerId:w,producerEpoch:I})}catch(t){if(u.includes(t.type))throw"CONCURRENT_TRANSACTIONS"===t.type&&e.debug("There is an ongoing transaction on this transactionId, retrying",{error:t.message,stack:t.stack,transactionalId:m,retryCount:s,retryTime:a}),t;i(t)}}),getSequence:(e,t)=>R.isInitialized()?(y[e]=y[e]||{},y[e][t]=y[e][t]||0,y[e][t]):0,updateSequence(t,r,i){if(!R.isInitialized())return;let s=R.getSequence(t,r)+i;s>=l&&(e.debug(`Sequence for ${t} ${r} exceeds max value (${s}). Rotating to 0.`),s=0),y[t][r]=s},beginTransaction(){A(),S.transitionTo(d.TRANSACTING)},async addPartitionsToTransaction(e){A();let t={};e.forEach(({topic:e,partitions:r})=>{T[e]=T[e]||{},r.forEach(({partition:r})=>{T[e][r]||(t[e]=t[e]||[],t[e].push(r))})});let r=Object.keys(t).map(e=>({topic:e,partitions:t[e]}));if(r.length){let e=await x();await e.addPartitionsToTxn({transactionalId:m,producerId:w,producerEpoch:I,topics:r})}r.forEach(({topic:e,partitions:t})=>{t.forEach(t=>{T[e][t]=!0})})},async commit(){if(A(),S.transitionTo(d.COMMITTING),!O()){e.debug("No partitions or offsets registered, not sending EndTxn"),S.transitionTo(d.READY);return}let t=await x();await t.endTxn({producerId:w,producerEpoch:I,transactionalId:m,transactionResult:!0}),S.transitionTo(d.READY)},async abort(){if(A(),S.transitionTo(d.ABORTING),!O()){e.debug("No partitions or offsets registered, not sending EndTxn"),S.transitionTo(d.READY);return}let t=await x();await t.endTxn({producerId:w,producerEpoch:I,transactionalId:m,transactionResult:!1}),S.transitionTo(d.READY)},isInitialized:()=>-1!==w,isTransactional:()=>f,isInTransaction:()=>S.state()===d.TRANSACTING,async acquireBrokerLock(e){this.isInitialized()&&(b[e.nodeId]=b[e.nodeId]||new s({timeout:65535}),await b[e.nodeId].acquire())},releaseBrokerLock(e){this.isInitialized()&&b[e.nodeId].release()},async sendOffsets({consumerGroupId:r,topics:i}){c(r,"Missing consumerGroupId"),c(i,"Missing offset topics");let s=await x();await s.addOffsetsToTxn({transactionalId:m,producerId:w,producerEpoch:I,groupId:r}),E=!0;let a=await t.findGroupCoordinator({groupId:r,coordinatorType:n.GROUP});return g(async(s,o,l)=>{try{await a.txnOffsetCommit({transactionalId:m,producerId:w,producerEpoch:I,groupId:r,topics:i})}catch(i){if(h.includes(i.type))throw e.debug("Group coordinator is not ready yet, retrying",{error:i.message,stack:i.stack,transactionalId:m,retryCount:o,retryTime:l}),i;if(p.includes(i.type)||"ECONNREFUSED"===i.code)throw e.debug("Invalid group coordinator, finding new group coordinator and retrying",{error:i.message,stack:i.stack,transactionalId:m,retryCount:o,retryTime:l}),a=await t.findGroupCoordinator({groupId:r,coordinatorType:n.GROUP}),i;s(i)}})}},{initProducerId:{legalStates:[d.UNINITIALIZED,d.READY]},beginTransaction:{legalStates:[d.READY],async:!1},addPartitionsToTransaction:{legalStates:[d.TRANSACTING]},sendOffsets:{legalStates:[d.TRANSACTING]},commit:{legalStates:[d.TRANSACTING]},abort:{legalStates:[d.TRANSACTING]}});return R}},14227:(e,t,r)=>{let{EventEmitter:i}=r(17702),{KafkaJSNonRetriableError:s}=r(15847),a=r(37082),n={[a.UNINITIALIZED]:[a.READY],[a.READY]:[a.READY,a.TRANSACTING],[a.TRANSACTING]:[a.COMMITTING,a.ABORTING],[a.COMMITTING]:[a.READY],[a.ABORTING]:[a.READY]};e.exports=({logger:e,initialState:t=a.UNINITIALIZED})=>{let r=t,o=(e,t,{legalStates:i,async:a=!0})=>{if(!e[t])throw new s(`Cannot add guard on missing method "${t}"`);return(...n)=>{let o=e[t];if(!i.includes(r)){let e=new s(`Transaction state exception: Cannot call "${t}" in state "${r}"`);if(a)return Promise.reject(e);throw e}return o.apply(e,n)}},l=Object.assign(new i,{createGuarded(e,t){let r=Object.keys(t).reduce((r,i)=>(r[i]=o(e,i,t[i]),r),{});return{...e,...r}},transitionTo(t){if(e.debug(`Transaction state transition ${r} --> ${t}`),!n[r].includes(t))throw new s(`Transaction state exception: Invalid transition ${r} --> ${t}`);l.emit("transition",{to:t,from:r}),r=t},state:()=>r});return l}},37082:e=>{e.exports={UNINITIALIZED:"UNINITIALIZED",READY:"READY",TRANSACTING:"TRANSACTING",COMMITTING:"COMMITTING",ABORTING:"ABORTING"}},52344:e=>{e.exports=({topic:e,partitionMetadata:t,messages:r,partitioner:i})=>0===t.length?{}:r.reduce((r,s)=>{let a=i({topic:e,partitionMetadata:t,message:s}),n=r[a]||[];return Object.assign(r,{[a]:[...n,s]})},{})},61430:(e,t,r)=>{let i=r(81620),{CONNECTION_STATUS:s}=r(14273),{DefaultPartitioner:a}=r(17543),n=r(23920),o=r(97938),l=r(97205),{events:c,wrap:d,unwrap:u}=r(18109),{KafkaJSNonRetriableError:h}=r(15847),{values:p,keys:f}=Object,m=p(c),g=f(c).map(e=>`producer.events.${e}`).join(", "),{CONNECT:w,DISCONNECT:I}=c;e.exports=({cluster:e,logger:t,createPartitioner:r=a,retry:p,idempotent:f=!1,transactionalId:y,transactionTimeout:b,instrumentationEmitter:T})=>{let E,S=s.DISCONNECTED;if(p=p||{retries:f?Number.MAX_SAFE_INTEGER:5},f&&p.retries<1)throw new h("Idempotent producer must allow retries to protect against transient errors");let x=t.namespace("Producer");f&&p.retries<Number.MAX_SAFE_INTEGER&&x.warn("Limiting retries for the idempotent producer may invalidate EoS guarantees");let A=r(),O=i(Object.assign({},e.retry,p)),R=T||new n,N=o({logger:x,cluster:e,transactionTimeout:b,transactional:!1,transactionalId:y}),{send:C,sendBatch:_}=l({logger:x,cluster:e,partitioner:A,eosManager:N,idempotent:f,retrier:O,getConnectionStatus:()=>S});return{connect:async()=>{await e.connect(),S=s.CONNECTED,R.emit(w),f&&!N.isInitialized()&&await N.initProducerId()},disconnect:async()=>{S=s.DISCONNECTING,await e.disconnect(),S=s.DISCONNECTED,R.emit(I)},isIdempotent:()=>f,events:c,on:(e,t)=>{if(!m.includes(e))throw new h(`Event name should be one of ${g}`);return R.addListener(u(e),r=>{r.type=d(r.type),Promise.resolve(t(r)).catch(t=>{x.error(`Failed to execute listener: ${t.message}`,{eventName:e,stack:t.stack})})})},send:C,sendBatch:_,transaction:async()=>{if(!y)throw new h("Must provide transactional id for transactional producer");let t=!1;if((E=E||o({logger:x,cluster:e,transactionTimeout:b,transactional:!0,transactionalId:y})).isInTransaction())throw new h("There is already an ongoing transaction for this producer. Please end the transaction before beginning another.");E.isInitialized()||await E.initProducerId(),E.beginTransaction();let{send:r,sendBatch:i}=l({logger:x,cluster:e,partitioner:A,retrier:O,eosManager:E,idempotent:!0,getConnectionStatus:()=>S}),s=()=>E.isInTransaction()&&!t,a=e=>(...t)=>s()?e(...t):Promise.reject(new h("Cannot continue to use transaction once ended"));return{sendBatch:a(i),send:a(r),abort:a(async()=>{await E.abort(),t=!0}),commit:a(async()=>{await E.commit(),t=!0}),sendOffsets:a(async({consumerGroupId:t,topics:r})=>{for(let i of(await E.sendOffsets({consumerGroupId:t,topics:r}),r)){let{topic:r,partitions:s}=i;for(let{partition:i,offset:a}of s)e.markOffsetAsCommitted({groupId:t,topic:r,partition:i,offset:a})}}),isActive:s}},logger:()=>x}}},18109:(e,t,r)=>{let i=r(6388),s=r(27086),a=r(86419)("producer"),n={CONNECT:a("connect"),DISCONNECT:a("disconnect"),REQUEST:a(s.NETWORK_REQUEST),REQUEST_TIMEOUT:a(s.NETWORK_REQUEST_TIMEOUT),REQUEST_QUEUE_SIZE:a(s.NETWORK_REQUEST_QUEUE_SIZE)},o={[n.REQUEST]:s.NETWORK_REQUEST,[n.REQUEST_TIMEOUT]:s.NETWORK_REQUEST_TIMEOUT,[n.REQUEST_QUEUE_SIZE]:s.NETWORK_REQUEST_QUEUE_SIZE},l=i(o);e.exports={events:n,wrap:e=>l[e]||e,unwrap:e=>o[e]||e}},97205:(e,t,r)=>{let i=r(74233),{KafkaJSError:s,KafkaJSNonRetriableError:a}=r(15847),{CONNECTION_STATUS:n}=r(14273);e.exports=({logger:e,cluster:t,partitioner:r,eosManager:o,idempotent:l,retrier:c,getConnectionStatus:d})=>{let u=i({logger:e,cluster:t,retrier:c,partitioner:r,eosManager:o}),h=()=>{switch(d()){case n.DISCONNECTING:throw new a("The producer is disconnecting; therefore, it can't safely accept messages anymore");case n.DISCONNECTED:throw new s("The producer is disconnected")}},p=async({acks:e=-1,timeout:t,compression:r,topicMessages:i=[]})=>{if(i.some(({topic:e})=>!e))throw new a("Invalid topic");if(l&&-1!==e)throw new a("Not requiring ack for all messages invalidates the idempotent producer's EoS guarantees");for(let{topic:e,messages:t}of i){if(!t)throw new a(`Invalid messages array [${t}] for topic "${e}"`);let r=t.find(e=>void 0===e.value);if(r)throw new a(`Invalid message without value for topic "${e}": ${JSON.stringify(r)}`)}h();let s=i.reduce((e,{topic:t,messages:r})=>{let i=e.findIndex(({topic:e})=>t===e);return -1===i?e.push({topic:t,messages:r}):e[i].messages=[...e[i].messages,...r],e},[]);return await u({acks:e,timeout:t,compression:r,topicMessages:s})};return{send:async({acks:e,timeout:t,compression:r,topic:i,messages:s})=>p({acks:e,timeout:t,compression:r,topicMessages:[{topic:i,messages:s}]}),sendBatch:p}}},98639:(e,t,r)=>{let i=r(88297),s=r(10475);e.exports=s(i)},88297:(e,t,r)=>{let i=r(25481),s=i.fromValue(0x9747b28c),a=i.fromValue(0x5bd1e995),n=i.fromValue(24);e.exports=e=>{let t=Buffer.isBuffer(e)?e:Buffer.from(String(e)),r=t.length,o=i.fromValue(s.xor(r)),l=Math.floor(r/4);for(let e=0;e<l;e++){let r=4*e,s=(255&t[r+0])+((255&t[r+1])<<8)+((255&t[r+2])<<16)+((255&t[r+3])<<24);s=(s=(s=i.fromValue(s)).multiply(a)).xor(s.toInt()>>>n),s=i.fromValue(s).multiply(a),o=(o=o.multiply(a)).xor(s)}switch(r%4){case 3:o=o.xor((255&t[(-4&r)+2])<<16);case 2:o=o.xor((255&t[(-4&r)+1])<<8);case 1:o=(o=o.xor(255&t[-4&r])).multiply(a)}return(o=(o=(o=o.xor(o.toInt()>>>13)).multiply(a)).xor(o.toInt()>>>15)).toInt()}},17543:(e,t,r)=>{let i=r(98639),s=r(11473);e.exports={DefaultPartitioner:i,LegacyPartitioner:s,JavaCompatiblePartitioner:i}},11473:(e,t,r)=>{let i=r(58643),s=r(10475);e.exports=s(i)},58643:e=>{e.exports=e=>{let t=Buffer.isBuffer(e)?e:Buffer.from(String(e)),r=t.length,i=0x9747b28c^r,s=r/4;for(let e=0;e<s;e++){let r=4*e,s=(255&t[r+0])+((255&t[r+1])<<8)+((255&t[r+2])<<16)+((255&t[r+3])<<24);s*=0x5bd1e995,s^=s>>>24,s*=0x5bd1e995,i*=0x5bd1e995,i^=s}switch(r%4){case 3:i^=(255&t[(-4&r)+2])<<16;case 2:i^=(255&t[(-4&r)+1])<<8;case 1:i^=255&t[-4&r],i*=0x5bd1e995}return i^=i>>>13,i*=0x5bd1e995,i^=i>>>15}},10475:(e,t,r)=>{let i=r(37386),s=e=>0x7fffffff&e;e.exports=e=>()=>{let t={};return({topic:r,partitionMetadata:a,message:n})=>{r in t||(t[r]=i(32).readUInt32BE(0));let o=a.length,l=a.filter(e=>e.leader>=0),c=l.length;return null!==n.partition&&void 0!==n.partition?n.partition:null!==n.key&&void 0!==n.key?s(e(n.key))%o:c>0?l[s(++t[r])%c].partitionId:s(++t[r])%o}}},37386:(e,t,r)=>{let{KafkaJSNonRetriableError:i}=r(15847),s=e=>({randomBytes:t=>e.getRandomValues(Buffer.allocUnsafe(t))}),a=null;global&&global.crypto?a=void 0===global.crypto.randomBytes?s(global.crypto):global.crypto:global&&global.msCrypto?a=s(global.msCrypto):global&&!global.crypto&&(a=r(84770)),e.exports=e=>{if(e>65536)throw new i(`Byte length (${e}) exceeds the max number of bytes of entropy available (65536)`);if(!a)throw new i("No available crypto implementation");return a.randomBytes(e)}},71260:e=>{e.exports=({topics:e})=>e.flatMap(({topicName:e,partitions:t})=>t.map(t=>({topicName:e,...t})))},74233:(e,t,r)=>{let{KafkaJSMetadataNotLoaded:i}=r(15847),{staleMetadata:s}=r(15644),a=r(52344),n=r(33502),o=r(71260),{keys:l}=Object;e.exports=({logger:e,cluster:t,partitioner:r,eosManager:c,retrier:d})=>async({acks:u,timeout:h,compression:p,topicMessages:f})=>{let m=new Map,g=async s=>{let d=new Map;for(let{topic:n,messages:o}of(await t.refreshMetadataIfNecessary(),f)){let c=t.findTopicPartitionMetadata(n);if(0===c.length)throw e.debug("Producing to topic without metadata",{topic:n,targetTopics:Array.from(t.targetTopics)}),new i("Producing to topic without metadata");let u=a({topic:n,partitionMetadata:c,messages:o,partitioner:r}),h=l(u),p=t.findLeaderForPartitions(n,h),f=l(p);for(let e of(d.set(n,{partitionsPerLeader:p,messagesPerPartition:u}),f)){let r=await t.findBroker({nodeId:e});s.has(r)||s.set(r,null)}}return Array.from(s.keys()).filter(e=>!s.get(e)).map(async e=>{let t=n(Array.from(d.entries()).filter(([t,{partitionsPerLeader:r}])=>!!r[e.nodeId]).map(([t,{partitionsPerLeader:r,messagesPerPartition:i,sequencePerPartition:s}])=>({topic:t,partitions:r[e.nodeId],messagesPerPartition:i})));await c.acquireBrokerLock(e);try{let r;c.isTransactional()&&await c.addPartitionsToTransaction(t),t.forEach(({topic:e,partitions:t})=>{t.forEach(t=>{t.firstSequence=c.getSequence(e,t.partition),c.updateSequence(e,t.partition,t.messages.length)})});try{r=await e.produce({transactionalId:c.isTransactional()?c.getTransactionalId():void 0,producerId:c.getProducerId(),producerEpoch:c.getProducerEpoch(),acks:u,timeout:h,compression:p,topicData:t})}catch(e){throw t.forEach(({topic:e,partitions:t})=>{t.forEach(t=>{c.updateSequence(e,t.partition,-t.messages.length)})}),e}let i=0!==u?o(r):[];s.set(e,i)}catch(t){throw s.delete(e),t}finally{await c.releaseBrokerLock(e)}})};return d(async(r,i,a)=>{let n=f.map(({topic:e})=>e);await t.addMultipleTargetTopics(n);try{let e=await g(m);return await Promise.all(e),Array.from(m.values()).flat()}catch(n){if("KafkaJSConnectionClosedError"===n.name&&t.removeBroker({host:n.host,port:n.port}),!t.isConnected())throw e.debug(`Cluster has disconnected, reconnecting: ${n.message}`,{retryCount:i,retryTime:a}),await t.connect(),await t.refreshMetadata(),n;if(s(n)||"KafkaJSMetadataNotLoaded"===n.name||"KafkaJSConnectionError"===n.name||"KafkaJSConnectionClosedError"===n.name||"KafkaJSProtocolError"===n.name&&n.retriable)throw e.error(`Failed to send messages: ${n.message}`,{retryCount:i,retryTime:a}),await t.refreshMetadata(),n;if(e.error(`${n.message}`,{retryCount:i,retryTime:a}),n.retriable)throw n;r(n)}})}},97076:e=>{e.exports={UNKNOWN:0,ANY:1,ALL:2,READ:3,WRITE:4,CREATE:5,DELETE:6,ALTER:7,DESCRIBE:8,CLUSTER_ACTION:9,DESCRIBE_CONFIGS:10,ALTER_CONFIGS:11,IDEMPOTENT_WRITE:12}},41347:e=>{e.exports={UNKNOWN:0,ANY:1,DENY:2,ALLOW:3}},76380:e=>{e.exports={UNKNOWN:0,ANY:1,TOPIC:2,GROUP:3,CLUSTER:4,TRANSACTIONAL_ID:5,DELEGATION_TOKEN:6}},92282:e=>{e.exports={UNKNOWN:0,TOPIC:2,BROKER:4,BROKER_LOGGER:8}},22625:e=>{e.exports={UNKNOWN:0,TOPIC_CONFIG:1,DYNAMIC_BROKER_CONFIG:2,DYNAMIC_DEFAULT_BROKER_CONFIG:3,STATIC_BROKER_CONFIG:4,DEFAULT_CONFIG:5,DYNAMIC_BROKER_LOGGER_CONFIG:6}},46212:e=>{e.exports={GROUP:0,TRANSACTION:1}},14728:e=>{var t=new Int32Array([0,0x77073096,0xee0e612c,0x990951ba,0x76dc419,0x706af48f,0xe963a535,0x9e6495a3,0xedb8832,0x79dcb8a4,0xe0d5e91e,0x97d2d988,0x9b64c2b,0x7eb17cbd,0xe7b82d07,0x90bf1d91,0x1db71064,0x6ab020f2,0xf3b97148,0x84be41de,0x1adad47d,0x6ddde4eb,0xf4d4b551,0x83d385c7,0x136c9856,0x646ba8c0,0xfd62f97a,0x8a65c9ec,0x14015c4f,0x63066cd9,0xfa0f3d63,0x8d080df5,0x3b6e20c8,0x4c69105e,0xd56041e4,0xa2677172,0x3c03e4d1,0x4b04d447,0xd20d85fd,0xa50ab56b,0x35b5a8fa,0x42b2986c,0xdbbbc9d6,0xacbcf940,0x32d86ce3,0x45df5c75,0xdcd60dcf,0xabd13d59,0x26d930ac,0x51de003a,0xc8d75180,0xbfd06116,0x21b4f4b5,0x56b3c423,0xcfba9599,0xb8bda50f,0x2802b89e,0x5f058808,0xc60cd9b2,0xb10be924,0x2f6f7c87,0x58684c11,0xc1611dab,0xb6662d3d,0x76dc4190,0x1db7106,0x98d220bc,0xefd5102a,0x71b18589,0x6b6b51f,0x9fbfe4a5,0xe8b8d433,0x7807c9a2,0xf00f934,0x9609a88e,0xe10e9818,0x7f6a0dbb,0x86d3d2d,0x91646c97,0xe6635c01,0x6b6b51f4,0x1c6c6162,0x856530d8,0xf262004e,0x6c0695ed,0x1b01a57b,0x8208f4c1,0xf50fc457,0x65b0d9c6,0x12b7e950,0x8bbeb8ea,0xfcb9887c,0x62dd1ddf,0x15da2d49,0x8cd37cf3,0xfbd44c65,0x4db26158,0x3ab551ce,0xa3bc0074,0xd4bb30e2,0x4adfa541,0x3dd895d7,0xa4d1c46d,0xd3d6f4fb,0x4369e96a,0x346ed9fc,0xad678846,0xda60b8d0,0x44042d73,0x33031de5,0xaa0a4c5f,0xdd0d7cc9,0x5005713c,0x270241aa,0xbe0b1010,0xc90c2086,0x5768b525,0x206f85b3,0xb966d409,0xce61e49f,0x5edef90e,0x29d9c998,0xb0d09822,0xc7d7a8b4,0x59b33d17,0x2eb40d81,0xb7bd5c3b,0xc0ba6cad,0xedb88320,0x9abfb3b6,0x3b6e20c,0x74b1d29a,0xead54739,0x9dd277af,0x4db2615,0x73dc1683,0xe3630b12,0x94643b84,0xd6d6a3e,0x7a6a5aa8,0xe40ecf0b,0x9309ff9d,0xa00ae27,0x7d079eb1,0xf00f9344,0x8708a3d2,0x1e01f268,0x6906c2fe,0xf762575d,0x806567cb,0x196c3671,0x6e6b06e7,0xfed41b76,0x89d32be0,0x10da7a5a,0x67dd4acc,0xf9b9df6f,0x8ebeeff9,0x17b7be43,0x60b08ed5,0xd6d6a3e8,0xa1d1937e,0x38d8c2c4,0x4fdff252,0xd1bb67f1,0xa6bc5767,0x3fb506dd,0x48b2364b,0xd80d2bda,0xaf0a1b4c,0x36034af6,0x41047a60,0xdf60efc3,0xa867df55,0x316e8eef,0x4669be79,0xcb61b38c,0xbc66831a,0x256fd2a0,0x5268e236,0xcc0c7795,0xbb0b4703,0x220216b9,0x5505262f,0xc5ba3bbe,0xb2bd0b28,0x2bb45a92,0x5cb36a04,0xc2d7ffa7,0xb5d0cf31,0x2cd99e8b,0x5bdeae1d,0x9b64c2b0,0xec63f226,0x756aa39c,0x26d930a,0x9c0906a9,0xeb0e363f,0x72076785,0x5005713,0x95bf4a82,0xe2b87a14,0x7bb12bae,0xcb61b38,0x92d28e9b,0xe5d5be0d,0x7cdcefb7,0xbdbdf21,0x86d3d2d4,0xf1d4e242,0x68ddb3f8,0x1fda836e,0x81be16cd,0xf6b9265b,0x6fb077e1,0x18b74777,0x88085ae6,0xff0f6a70,0x66063bca,0x11010b5c,0x8f659eff,0xf862ae69,0x616bffd3,0x166ccf45,0xa00ae278,0xd70dd2ee,0x4e048354,0x3903b3c2,0xa7672661,0xd06016f7,0x4969474d,0x3e6e77db,0xaed16a4a,0xd9d65adc,0x40df0b66,936918e3,0xa9bcae53,0xdebb9ec5,0x47b2cf7f,0x30b5ffe9,0xbdbdf21c,0xcabac28a,0x53b39330,0x24b4a3a6,0xbad03605,0xcdd70693,0x54de5729,0x23d967bf,0xb3667a2e,0xc4614ab8,0x5d681b02,0x2a6f2b94,0xb40bbe37,0xc30c8ea1,0x5a05df1b,0x2d02ef8d]);e.exports=e=>{let{buffer:r}=e,i=r.length,s=-1;for(let e=0;e<i;e++)s=t[(s^r[e])&255]^s>>>8;return -1^s}},10243:(e,t,r)=>{let{KafkaJSInvalidVarIntError:i,KafkaJSInvalidLongError:s}=r(15847),a=r(25481);e.exports=class e{static int32Size(){return 4}static decodeZigZag(e){return e>>>1^-(1&e)}static decodeZigZag64(e){return e.shiftRightUnsigned(1).xor(e.and(a.fromInt(1)).negate())}constructor(e){this.buffer=e,this.offset=0}readInt8(){let e=this.buffer.readInt8(this.offset);return this.offset+=1,e}canReadInt16(){return this.canReadBytes(2)}readInt16(){let e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}canReadInt32(){return this.canReadBytes(4)}readInt32(){let e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}canReadInt64(){return this.canReadBytes(8)}readInt64(){let e=this.buffer[this.offset],t=this.buffer[this.offset+7],r=(e<<24)+65536*this.buffer[this.offset+1]+256*this.buffer[this.offset+2]+this.buffer[this.offset+3],i=0x1000000*this.buffer[this.offset+4]+65536*this.buffer[this.offset+5]+256*this.buffer[this.offset+6]+t;return this.offset+=8,(BigInt(r)<<32n)+BigInt(i)}readDouble(){let e=this.buffer.readDoubleBE(this.offset);return this.offset+=8,e}readString(){let e=this.readInt16();if(-1===e)return null;let t=this.buffer.slice(this.offset,this.offset+e).toString("utf8");return this.offset+=e,t}readVarIntString(){let e=this.readVarInt();if(-1===e)return null;let t=this.buffer.slice(this.offset,this.offset+e).toString("utf8");return this.offset+=e,t}readUVarIntString(){let e=this.readUVarInt();if(0===e)return null;let t=this.buffer.slice(this.offset,this.offset+e-1).toString("utf8");return this.offset+=e-1,t}canReadBytes(e){return Buffer.byteLength(this.buffer)-this.offset>=e}readBytes(e=this.readInt32()){if(-1===e)return null;let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}readVarIntBytes(){let e=this.readVarInt();if(-1===e)return null;let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}readUVarIntBytes(){let e=this.readUVarInt();if(0===e)return null;let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e-1,t}readBoolean(){return 1===this.readInt8()}readAll(){let e=this.buffer.slice(this.offset);return this.offset+=Buffer.byteLength(this.buffer),e}readArray(e){let t=this.readInt32();if(-1===t)return[];let r=Array(t);for(let i=0;i<t;i++)r[i]=e(this);return r}readVarIntArray(e){let t=this.readVarInt();if(-1===t)return[];let r=Array(t);for(let i=0;i<t;i++)r[i]=e(this);return r}readUVarIntArray(e){let t=this.readUVarInt();if(0===t)return null;let r=Array(t-1);for(let i=0;i<t-1;i++)r[i]=e(this);return r}async readArrayAsync(e){let t=this.readInt32();if(-1===t)return[];let r=Array(t);for(let i=0;i<t;i++)r[i]=await e(this);return r}readVarInt(){let t;let r=0,i=0;do r+=(127&(t=this.buffer[this.offset++]))<<i,i+=7;while(t>=128);return e.decodeZigZag(r)}readUVarInt(){let e;let t=0,r=0;for(;(128&(e=this.buffer[this.offset++]))!=0;)if(t|=(127&e)<<r,(r+=7)>28)throw new i("Invalid VarInt, must contain 5 bytes or less");return(t|=e<<r)>>>0}readTaggedFields(){let e=this.readUVarInt();if(0===e)return null;for(let t=0;t<e;t++)this.readUVarInt(),this.readUVarIntBytes();return{}}readVarLong(){let t;let r=a.fromInt(0),i=0;do{if(i>63)throw new s("Invalid Long, must contain 9 bytes or less");t=this.buffer[this.offset++],r=r.add(a.fromInt(127&t).shiftLeft(i)),i+=7}while(t>=128);return e.decodeZigZag64(r)}slice(t){return new e(this.buffer.slice(this.offset,this.offset+t))}forward(e){this.offset+=e}}},36880:(e,t,r)=>{let i=r(25481);e.exports=class e{static encodeZigZag(e){return e<<1^e>>31}static encodeZigZag64(e){let t=i.fromValue(e);return t.shiftLeft(1).xor(t.shiftRight(63))}static sizeOfVarInt(e){let t=this.encodeZigZag(e),r=1;for(;(0xffffff80&t)!=0;)r+=1,t>>>=7;return r}static sizeOfVarLong(t){let r=e.encodeZigZag64(t),s=1;for(;r.and(0xffffffffffffff80n).notEquals(i.fromInt(0));)s+=1,r=r.shiftRightUnsigned(7);return s}static sizeOfVarIntBytes(t){let r=null==t?-1:Buffer.byteLength(t);return r<0?e.sizeOfVarInt(-1):e.sizeOfVarInt(r)+r}static nextPowerOfTwo(e){return 1<<31-Math.clz32(e)+1}constructor(t=511){this.buf=Buffer.alloc(e.nextPowerOfTwo(t)),this.offset=0}writeBufferInternal(e){let t=e.length;this.ensureAvailable(t),e.copy(this.buf,this.offset,0),this.offset+=t}ensureAvailable(t){if(this.offset+t>this.buf.length){let r=e.nextPowerOfTwo(this.offset+t),i=Buffer.alloc(r);this.buf.copy(i,0,0,this.offset),this.buf=i}}get buffer(){return this.buf.slice(0,this.offset)}writeInt8(e){return this.ensureAvailable(1),this.buf.writeInt8(e,this.offset),this.offset+=1,this}writeInt16(e){return this.ensureAvailable(2),this.buf.writeInt16BE(e,this.offset),this.offset+=2,this}writeInt32(e){return this.ensureAvailable(4),this.buf.writeInt32BE(e,this.offset),this.offset+=4,this}writeUInt32(e){return this.ensureAvailable(4),this.buf.writeUInt32BE(e,this.offset),this.offset+=4,this}writeInt64(e){this.ensureAvailable(8);let t=i.fromValue(e);return this.buf.writeInt32BE(t.getHighBits(),this.offset),this.buf.writeInt32BE(t.getLowBits(),this.offset+4),this.offset+=8,this}writeDouble(e){return this.ensureAvailable(8),this.buf.writeDoubleBE(e,this.offset),this.offset+=8,this}writeBoolean(e){return e?this.writeInt8(1):this.writeInt8(0),this}writeString(e){if(null==e)return this.writeInt16(-1),this;let t=Buffer.byteLength(e,"utf8");return this.ensureAvailable(2+t),this.writeInt16(t),this.buf.write(e,this.offset,t,"utf8"),this.offset+=t,this}writeVarIntString(e){if(null==e)return this.writeVarInt(-1),this;let t=Buffer.byteLength(e,"utf8");return this.writeVarInt(t),this.ensureAvailable(t),this.buf.write(e,this.offset,t,"utf8"),this.offset+=t,this}writeUVarIntString(e){if(null==e)return this.writeUVarInt(0),this;let t=Buffer.byteLength(e,"utf8");return this.writeUVarInt(t+1),this.ensureAvailable(t),this.buf.write(e,this.offset,t,"utf8"),this.offset+=t,this}writeBytes(e){if(null==e)return this.writeInt32(-1),this;if(Buffer.isBuffer(e))this.ensureAvailable(4+e.length),this.writeInt32(e.length),this.writeBufferInternal(e);else{let t=String(e),r=Buffer.byteLength(t,"utf8");this.ensureAvailable(4+r),this.writeInt32(r),this.buf.write(t,this.offset,r,"utf8"),this.offset+=r}return this}writeVarIntBytes(e){if(null==e)return this.writeVarInt(-1),this;if(Buffer.isBuffer(e))this.writeVarInt(e.length),this.writeBufferInternal(e);else{let t=String(e),r=Buffer.byteLength(t,"utf8");this.writeVarInt(r),this.ensureAvailable(r),this.buf.write(t,this.offset,r,"utf8"),this.offset+=r}return this}writeUVarIntBytes(e){if(null==e)return this.writeVarInt(0),this;if(Buffer.isBuffer(e))this.writeUVarInt(e.length+1),this.writeBufferInternal(e);else{let t=String(e),r=Buffer.byteLength(t,"utf8");this.writeUVarInt(r+1),this.ensureAvailable(r),this.buf.write(t,this.offset,r,"utf8"),this.offset+=r}return this}writeEncoder(e){if(null==e||!Buffer.isBuffer(e.buf))throw Error("value should be an instance of Encoder");return this.writeBufferInternal(e.buffer),this}writeEncoderArray(e){if(!Array.isArray(e)||e.some(e=>null==e||!Buffer.isBuffer(e.buf)))throw Error("all values should be an instance of Encoder[]");return e.forEach(e=>{this.writeBufferInternal(e.buffer)}),this}writeBuffer(e){if(!Buffer.isBuffer(e))throw Error("value should be an instance of Buffer");return this.writeBufferInternal(e),this}writeNullableArray(e,t){let r=0!==e.length?e.length:-1;return this.writeArray(e,t,r),this}writeArray(e,t,r){let i=null==r?e.length:r;if(this.writeInt32(i),void 0!==t)switch(t){case"int32":case"number":e.forEach(e=>this.writeInt32(e));break;case"string":e.forEach(e=>this.writeString(e));break;case"object":this.writeEncoderArray(e)}else e.forEach(e=>{switch(typeof e){case"number":this.writeInt32(e);break;case"string":this.writeString(e);break;case"object":this.writeEncoder(e)}});return this}writeVarIntArray(e,t){if("object"===t)this.writeVarInt(e.length),this.writeEncoderArray(e);else{let t=e.filter(e=>"object"==typeof e);this.writeVarInt(t.length),this.writeEncoderArray(t)}return this}writeUVarIntArray(e,t){if("object"===t)this.writeUVarInt(e.length+1),this.writeEncoderArray(e);else if(null===e)this.writeUVarInt(0);else{let t=e.filter(e=>"object"==typeof e);this.writeUVarInt(t.length+1),this.writeEncoderArray(t)}return this}writeVarInt(t){return this.writeUVarInt(e.encodeZigZag(t))}writeUVarInt(e){let t=[];for(;(0xffffff80&e)!=0;)t.push(127&e|128),e>>>=7;return t.push(127&e),this.writeBufferInternal(Buffer.from(t)),this}writeVarLong(t){let r=[],s=e.encodeZigZag64(t);for(;s.and(0xffffffffffffff80n).notEquals(i.fromInt(0));)r.push(s.and(127).or(128).toInt()),s=s.shiftRightUnsigned(7);return r.push(s.toInt()),this.writeBufferInternal(Buffer.from(r)),this}size(){return this.offset}toJSON(){return this.buffer.toJSON()}}},15644:(e,t,r)=>{let{KafkaJSProtocolError:i}=r(15847),s=r(19681),a=[{type:"UNKNOWN",code:-1,retriable:!1,message:"The server experienced an unexpected error when processing the request"},{type:"OFFSET_OUT_OF_RANGE",code:1,retriable:!1,message:"The requested offset is not within the range of offsets maintained by the server"},{type:"CORRUPT_MESSAGE",code:2,retriable:!0,message:"This message has failed its CRC checksum, exceeds the valid size, or is otherwise corrupt"},{type:"UNKNOWN_TOPIC_OR_PARTITION",code:3,retriable:!0,message:"This server does not host this topic-partition"},{type:"INVALID_FETCH_SIZE",code:4,retriable:!1,message:"The requested fetch size is invalid"},{type:"LEADER_NOT_AVAILABLE",code:5,retriable:!0,message:"There is no leader for this topic-partition as we are in the middle of a leadership election"},{type:"NOT_LEADER_FOR_PARTITION",code:6,retriable:!0,message:"This server is not the leader for that topic-partition"},{type:"REQUEST_TIMED_OUT",code:7,retriable:!0,message:"The request timed out"},{type:"BROKER_NOT_AVAILABLE",code:8,retriable:!1,message:"The broker is not available"},{type:"REPLICA_NOT_AVAILABLE",code:9,retriable:!0,message:"The replica is not available for the requested topic-partition"},{type:"MESSAGE_TOO_LARGE",code:10,retriable:!1,message:"The request included a message larger than the max message size the server will accept"},{type:"STALE_CONTROLLER_EPOCH",code:11,retriable:!1,message:"The controller moved to another broker"},{type:"OFFSET_METADATA_TOO_LARGE",code:12,retriable:!1,message:"The metadata field of the offset request was too large"},{type:"NETWORK_EXCEPTION",code:13,retriable:!0,message:"The server disconnected before a response was received"},{type:"GROUP_LOAD_IN_PROGRESS",code:14,retriable:!0,message:"The coordinator is loading and hence can't process requests for this group"},{type:"GROUP_COORDINATOR_NOT_AVAILABLE",code:15,retriable:!0,message:"The group coordinator is not available"},{type:"NOT_COORDINATOR_FOR_GROUP",code:16,retriable:!0,message:"This is not the correct coordinator for this group"},{type:"INVALID_TOPIC_EXCEPTION",code:17,retriable:!1,message:"The request attempted to perform an operation on an invalid topic"},{type:"RECORD_LIST_TOO_LARGE",code:18,retriable:!1,message:"The request included message batch larger than the configured segment size on the server"},{type:"NOT_ENOUGH_REPLICAS",code:19,retriable:!0,message:"Messages are rejected since there are fewer in-sync replicas than required"},{type:"NOT_ENOUGH_REPLICAS_AFTER_APPEND",code:20,retriable:!0,message:"Messages are written to the log, but to fewer in-sync replicas than required"},{type:"INVALID_REQUIRED_ACKS",code:21,retriable:!1,message:"Produce request specified an invalid value for required acks"},{type:"ILLEGAL_GENERATION",code:22,retriable:!1,message:"Specified group generation id is not valid"},{type:"INCONSISTENT_GROUP_PROTOCOL",code:23,retriable:!1,message:"The group member's supported protocols are incompatible with those of existing members"},{type:"INVALID_GROUP_ID",code:24,retriable:!1,message:"The configured groupId is invalid"},{type:"UNKNOWN_MEMBER_ID",code:25,retriable:!1,message:"The coordinator is not aware of this member"},{type:"INVALID_SESSION_TIMEOUT",code:26,retriable:!1,message:"The session timeout is not within the range allowed by the broker (as configured by group.min.session.timeout.ms and group.max.session.timeout.ms)"},{type:"REBALANCE_IN_PROGRESS",code:27,retriable:!1,message:"The group is rebalancing, so a rejoin is needed",helpUrl:s("docs/faq","what-does-it-mean-to-get-rebalance-in-progress-errors")},{type:"INVALID_COMMIT_OFFSET_SIZE",code:28,retriable:!1,message:"The committing offset data size is not valid"},{type:"TOPIC_AUTHORIZATION_FAILED",code:29,retriable:!1,message:"Not authorized to access topics: [Topic authorization failed]"},{type:"GROUP_AUTHORIZATION_FAILED",code:30,retriable:!1,message:"Not authorized to access group: Group authorization failed"},{type:"CLUSTER_AUTHORIZATION_FAILED",code:31,retriable:!1,message:"Cluster authorization failed"},{type:"INVALID_TIMESTAMP",code:32,retriable:!1,message:"The timestamp of the message is out of acceptable range"},{type:"UNSUPPORTED_SASL_MECHANISM",code:33,retriable:!1,message:"The broker does not support the requested SASL mechanism"},{type:"ILLEGAL_SASL_STATE",code:34,retriable:!1,message:"Request is not valid given the current SASL state"},{type:"UNSUPPORTED_VERSION",code:35,retriable:!1,message:"The version of API is not supported"},{type:"TOPIC_ALREADY_EXISTS",code:36,retriable:!1,message:"Topic with this name already exists"},{type:"INVALID_PARTITIONS",code:37,retriable:!1,message:"Number of partitions is invalid"},{type:"INVALID_REPLICATION_FACTOR",code:38,retriable:!1,message:"Replication-factor is invalid"},{type:"INVALID_REPLICA_ASSIGNMENT",code:39,retriable:!1,message:"Replica assignment is invalid"},{type:"INVALID_CONFIG",code:40,retriable:!1,message:"Configuration is invalid"},{type:"NOT_CONTROLLER",code:41,retriable:!0,message:"This is not the correct controller for this cluster"},{type:"INVALID_REQUEST",code:42,retriable:!1,message:"This most likely occurs because of a request being malformed by the client library or the message was sent to an incompatible broker. See the broker logs for more details"},{type:"UNSUPPORTED_FOR_MESSAGE_FORMAT",code:43,retriable:!1,message:"The message format version on the broker does not support the request"},{type:"POLICY_VIOLATION",code:44,retriable:!1,message:"Request parameters do not satisfy the configured policy"},{type:"OUT_OF_ORDER_SEQUENCE_NUMBER",code:45,retriable:!1,message:"The broker received an out of order sequence number"},{type:"DUPLICATE_SEQUENCE_NUMBER",code:46,retriable:!1,message:"The broker received a duplicate sequence number"},{type:"INVALID_PRODUCER_EPOCH",code:47,retriable:!1,message:"Producer attempted an operation with an old epoch. Either there is a newer producer with the same transactionalId, or the producer's transaction has been expired by the broker"},{type:"INVALID_TXN_STATE",code:48,retriable:!1,message:"The producer attempted a transactional operation in an invalid state"},{type:"INVALID_PRODUCER_ID_MAPPING",code:49,retriable:!1,message:"The producer attempted to use a producer id which is not currently assigned to its transactional id"},{type:"INVALID_TRANSACTION_TIMEOUT",code:50,retriable:!1,message:"The transaction timeout is larger than the maximum value allowed by the broker (as configured by max.transaction.timeout.ms)"},{type:"CONCURRENT_TRANSACTIONS",code:51,retriable:!0,message:"The producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing"},{type:"TRANSACTION_COORDINATOR_FENCED",code:52,retriable:!1,message:"Indicates that the transaction coordinator sending a WriteTxnMarker is no longer the current coordinator for a given producer"},{type:"TRANSACTIONAL_ID_AUTHORIZATION_FAILED",code:53,retriable:!1,message:"Transactional Id authorization failed"},{type:"SECURITY_DISABLED",code:54,retriable:!1,message:"Security features are disabled"},{type:"OPERATION_NOT_ATTEMPTED",code:55,retriable:!1,message:"The broker did not attempt to execute this operation. This may happen for batched RPCs where some operations in the batch failed, causing the broker to respond without trying the rest"},{type:"KAFKA_STORAGE_ERROR",code:56,retriable:!0,message:"Disk error when trying to access log file on the disk"},{type:"LOG_DIR_NOT_FOUND",code:57,retriable:!1,message:"The user-specified log directory is not found in the broker config"},{type:"SASL_AUTHENTICATION_FAILED",code:58,retriable:!1,message:"SASL Authentication failed",helpUrl:s("docs/configuration","sasl")},{type:"UNKNOWN_PRODUCER_ID",code:59,retriable:!1,message:"This exception is raised by the broker if it could not locate the producer metadata associated with the producerId in question. This could happen if, for instance, the producer's records were deleted because their retention time had elapsed. Once the last records of the producerId are removed, the producer's metadata is removed from the broker, and future appends by the producer will return this exception"},{type:"REASSIGNMENT_IN_PROGRESS",code:60,retriable:!1,message:"A partition reassignment is in progress"},{type:"DELEGATION_TOKEN_AUTH_DISABLED",code:61,retriable:!1,message:"Delegation Token feature is not enabled"},{type:"DELEGATION_TOKEN_NOT_FOUND",code:62,retriable:!1,message:"Delegation Token is not found on server"},{type:"DELEGATION_TOKEN_OWNER_MISMATCH",code:63,retriable:!1,message:"Specified Principal is not valid Owner/Renewer"},{type:"DELEGATION_TOKEN_REQUEST_NOT_ALLOWED",code:64,retriable:!1,message:"Delegation Token requests are not allowed on PLAINTEXT/1-way SSL channels and on delegation token authenticated channels"},{type:"DELEGATION_TOKEN_AUTHORIZATION_FAILED",code:65,retriable:!1,message:"Delegation Token authorization failed"},{type:"DELEGATION_TOKEN_EXPIRED",code:66,retriable:!1,message:"Delegation Token is expired"},{type:"INVALID_PRINCIPAL_TYPE",code:67,retriable:!1,message:"Supplied principalType is not supported"},{type:"NON_EMPTY_GROUP",code:68,retriable:!1,message:"The group is not empty"},{type:"GROUP_ID_NOT_FOUND",code:69,retriable:!1,message:"The group id was not found"},{type:"FETCH_SESSION_ID_NOT_FOUND",code:70,retriable:!0,message:"The fetch session ID was not found"},{type:"INVALID_FETCH_SESSION_EPOCH",code:71,retriable:!0,message:"The fetch session epoch is invalid"},{type:"LISTENER_NOT_FOUND",code:72,retriable:!0,message:"There is no listener on the leader broker that matches the listener on which metadata request was processed"},{type:"TOPIC_DELETION_DISABLED",code:73,retriable:!1,message:"Topic deletion is disabled"},{type:"FENCED_LEADER_EPOCH",code:74,retriable:!0,message:"The leader epoch in the request is older than the epoch on the broker"},{type:"UNKNOWN_LEADER_EPOCH",code:75,retriable:!0,message:"The leader epoch in the request is newer than the epoch on the broker"},{type:"UNSUPPORTED_COMPRESSION_TYPE",code:76,retriable:!1,message:"The requesting client does not support the compression type of given partition"},{type:"STALE_BROKER_EPOCH",code:77,retriable:!1,message:"Broker epoch has changed"},{type:"OFFSET_NOT_AVAILABLE",code:78,retriable:!0,message:"The leader high watermark has not caught up from a recent leader election so the offsets cannot be guaranteed to be monotonically increasing"},{type:"MEMBER_ID_REQUIRED",code:79,retriable:!1,message:"The group member needs to have a valid member id before actually entering a consumer group"},{type:"PREFERRED_LEADER_NOT_AVAILABLE",code:80,retriable:!0,message:"The preferred leader was not available"},{type:"GROUP_MAX_SIZE_REACHED",code:81,retriable:!1,message:"The consumer group has reached its max size. It already has the configured maximum number of members"},{type:"FENCED_INSTANCE_ID",code:82,retriable:!1,message:"The broker rejected this static consumer since another consumer with the same group instance id has registered with a different member id"},{type:"ELIGIBLE_LEADERS_NOT_AVAILABLE",code:83,retriable:!0,message:"Eligible topic partition leaders are not available"},{type:"ELECTION_NOT_NEEDED",code:84,retriable:!0,message:"Leader election not needed for topic partition"},{type:"NO_REASSIGNMENT_IN_PROGRESS",code:85,retriable:!1,message:"No partition reassignment is in progress"},{type:"GROUP_SUBSCRIBED_TO_TOPIC",code:86,retriable:!1,message:"Deleting offsets of a topic is forbidden while the consumer group is actively subscribed to it"},{type:"INVALID_RECORD",code:87,retriable:!1,message:"This record has failed the validation on broker and hence be rejected"},{type:"UNSTABLE_OFFSET_COMMIT",code:88,retriable:!0,message:"There are unstable offsets that need to be cleared"}],n=e=>({type:"KAFKAJS_UNKNOWN_ERROR_CODE",code:-99,retriable:!1,message:`Unknown error code ${e}`}),o=e=>new i(a.find(t=>t.code===e)||n(e));e.exports={failure:e=>0!==e,errorCodes:a,createErrorFromCode:o,failIfVersionNotSupported:e=>{if(35===e)throw o(35)},staleMetadata:e=>["UNKNOWN_TOPIC_OR_PARTITION","LEADER_NOT_AVAILABLE","NOT_LEADER_FOR_PARTITION"].includes(e.type)}},20236:e=>{e.exports={READ_UNCOMMITTED:0,READ_COMMITTED:1}},83450:(e,t,r)=>{let i=r(25481),s=r(10243),a=r(38896),{lookupCodecByAttributes:n}=r(22863),{KafkaJSPartialMessageError:o}=r(15847);e.exports=async(e,t=null)=>{let r=[],i=t||e.readInt32(),a=e.slice(i);for(;a.offset<i;)try{let e=c(a),t=n(e.attributes);if(t){let i=await t.decompress(e.value);r.push(...l(new s(i),e))}else r.push(e)}catch(e){if("KafkaJSPartialMessageError"===e.name||"KafkaJSUnsupportedMagicByteInMessageSet"===e.name)break;throw e}return e.forward(i),r};let l=(e,t)=>{let r=[];for(;e.offset<e.buffer.length;)r.push(c(e));if(t.magicByte>0&&t.offset>=0){let e=i.fromValue(t.offset)-i.fromValue(r[r.length-1].offset);for(let t of r)t.offset=i.fromValue(t.offset).add(e).toString()}return r},c=e=>{if(!e.canReadInt64())throw new o("Tried to decode a partial message: There isn't enough bytes to read the offset");let t=e.readInt64().toString();if(!e.canReadInt32())throw new o("Tried to decode a partial message: There isn't enough bytes to read the message size");return a(t,e.readInt32(),e)}},51560:(e,t,r)=>{let i=r(36880),s=r(50763),{Types:a}=r(22863);e.exports=({messageVersion:e=0,compression:t,entries:r})=>{let n=t!==a.None,o=s({version:e}),l=new i;return r.forEach((e,t)=>{let r=o(e);l.writeInt64(n?t:-1),l.writeInt32(r.size()),l.writeEncoder(r)}),l}},12704:(e,t,r)=>{let{promisify:i}=r(21764),s=r(71568),a=i(s.gzip),n=i(s.unzip);e.exports={compress:async e=>await a(e.buffer),decompress:async e=>await n(e)}},22863:(e,t,r)=>{let{KafkaJSNotImplemented:i}=r(15847),s={None:0,GZIP:1,Snappy:2,LZ4:3,ZSTD:4},a={[s.GZIP]:()=>r(12704),[s.Snappy]:()=>{throw new i("Snappy compression not implemented")},[s.LZ4]:()=>{throw new i("LZ4 compression not implemented")},[s.ZSTD]:()=>{throw new i("ZSTD compression not implemented")}};e.exports={Types:s,Codecs:a,lookupCodec:e=>a[e]?a[e]():null,lookupCodecByAttributes:e=>{let t=a[7&e];return t?t():null},COMPRESSION_CODEC_MASK:7}},38896:(e,t,r)=>{let{KafkaJSPartialMessageError:i,KafkaJSUnsupportedMagicByteInMessageSet:s}=r(15847),a=r(77056),n=r(96499),o=(e,t)=>{switch(t){case 0:return a(e);case 1:return n(e);default:throw new s(`Unsupported MessageSet message version, magic byte: ${t}`)}};e.exports=(e,t,r)=>{let s=Buffer.byteLength(r.slice(t).buffer);if(s<t)throw new i(`Tried to decode a partial message: remainingBytes(${s}) < messageSize(${t})`);let a=r.readInt32(),n=r.readInt8(),l=o(r,n);return Object.assign({offset:e,size:t,crc:a,magicByte:n},l)}},50763:(e,t,r)=>{let i={0:r(65864),1:r(18491)};e.exports=({version:e=0})=>i[e]},77056:e=>{e.exports=e=>({attributes:e.readInt8(),key:e.readBytes(),value:e.readBytes()})},65864:(e,t,r)=>{let i=r(36880),s=r(14728),{Types:a,COMPRESSION_CODEC_MASK:n}=r(22863);e.exports=({compression:e=a.None,key:t,value:r})=>{let o=new i().writeInt8(0).writeInt8(e&n).writeBytes(t).writeBytes(r),l=s(o);return new i().writeInt32(l).writeEncoder(o)}},96499:e=>{e.exports=e=>({attributes:e.readInt8(),timestamp:e.readInt64().toString(),key:e.readBytes(),value:e.readBytes()})},18491:(e,t,r)=>{let i=r(36880),s=r(14728),{Types:a,COMPRESSION_CODEC_MASK:n}=r(22863);e.exports=({compression:e=a.None,timestamp:t=Date.now(),key:r,value:o})=>{let l=new i().writeInt8(1).writeInt8(e&n).writeInt64(t).writeBytes(r).writeBytes(o),c=s(l);return new i().writeInt32(c).writeEncoder(l)}},15240:e=>{e.exports=e=>{let r=-1;for(let i=0;i<e.length;i++)r=t[(r^e[i])&255]^r>>>8;return(-1^r)>>>0};var t=new Int32Array([0,0xf26b8303,0xe13b70f7,0x1350f3f4,0xc79a971f,0x35f1141c,0x26a1e7e8,0xd4ca64eb,0x8ad958cf,0x78b2dbcc,0x6be22838,0x9989ab3b,0x4d43cfd0,0xbf284cd3,0xac78bf27,0x5e133c24,0x105ec76f,0xe235446c,0xf165b798,0x30e349b,0xd7c45070,0x25afd373,0x36ff2087,0xc494a384,0x9a879fa0,0x68ec1ca3,0x7bbcef57,0x89d76c54,0x5d1d08bf,0xaf768bbc,0xbc267848,0x4e4dfb4b,0x20bd8ede,0xd2d60ddd,0xc186fe29,0x33ed7d2a,0xe72719c1,0x154c9ac2,0x61c6936,0xf477ea35,0xaa64d611,0x580f5512,0x4b5fa6e6,0xb93425e5,0x6dfe410e,0x9f95c20d,0x8cc531f9,0x7eaeb2fa,0x30e349b1,0xc288cab2,0xd1d83946,0x23b3ba45,0xf779deae,0x5125dad,0x1642ae59,0xe4292d5a,0xba3a117e,0x4851927d,0x5b016189,0xa96ae28a,0x7da08661,0x8fcb0562,0x9c9bf696,0x6ef07595,0x417b1dbc,0xb3109ebf,0xa0406d4b,0x522bee48,0x86e18aa3,0x748a09a0,0x67dafa54,0x95b17957,0xcba24573,0x39c9c670,0x2a993584,0xd8f2b687,0xc38d26c,0xfe53516f,0xed03a29b,0x1f682198,0x5125dad3,0xa34e59d0,0xb01eaa24,0x42752927,0x96bf4dcc,0x64d4cecf,0x77843d3b,0x85efbe38,0xdbfc821c,0x2997011f,0x3ac7f2eb,0xc8ac71e8,0x1c661503,0xee0d9600,0xfd5d65f4,0xf36e6f7,0x61c69362,0x93ad1061,0x80fde395,0x72966096,0xa65c047d,0x5437877e,0x4767748a,0xb50cf789,0xeb1fcbad,0x197448ae,0xa24bb5a,0xf84f3859,0x2c855cb2,0xdeeedfb1,0xcdbe2c45,0x3fd5af46,0x7198540d,0x83f3d70e,0x90a324fa,0x62c8a7f9,0xb602c312,0x44694011,0x5739b3e5,0xa55230e6,0xfb410cc2,0x92a8fc1,0x1a7a7c35,0xe811ff36,0x3cdb9bdd,0xceb018de,0xdde0eb2a,0x2f8b6829,0x82f63b78,0x709db87b,0x63cd4b8f,0x91a6c88c,0x456cac67,0xb7072f64,0xa457dc90,0x563c5f93,0x82f63b7,0xfa44e0b4,0xe9141340,0x1b7f9043,0xcfb5f4a8,0x3dde77ab,0x2e8e845f,0xdce5075c,0x92a8fc17,0x60c37f14,0x73938ce0,0x81f80fe3,0x55326b08,0xa759e80b,0xb4091bff,0x466298fc,0x1871a4d8,0xea1a27db,0xf94ad42f,0xb21572c,0xdfeb33c7,0x2d80b0c4,0x3ed04330,0xccbbc033,0xa24bb5a6,0x502036a5,0x4370c551,0xb11b4652,0x65d122b9,0x97baa1ba,0x84ea524e,0x7681d14d,0x2892ed69,0xdaf96e6a,0xc9a99d9e,0x3bc21e9d,0xef087a76,0x1d63f975,0xe330a81,0xfc588982,0xb21572c9,0x407ef1ca,0x532e023e,0xa145813d,0x758fe5d6,0x87e466d5,0x94b49521,0x66df1622,0x38cc2a06,0xcaa7a905,0xd9f75af1,0x2b9cd9f2,0xff56bd19,0xd3d3e1a,0x1e6dcdee,0xec064eed,0xc38d26c4,0x31e6a5c7,0x22b65633,0xd0ddd530,0x417b1db,0xf67c32d8,0xe52cc12c,0x1747422f,0x49547e0b,0xbb3ffd08,0xa86f0efc,0x5a048dff,0x8ecee914,0x7ca56a17,0x6ff599e3,0x9d9e1ae0,0xd3d3e1ab,0x21b862a8,0x32e8915c,0xc083125f,0x144976b4,0xe622f5b7,0xf5720643,0x7198540,0x590ab964,0xab613a67,0xb831c993,0x4a5a4a90,0x9e902e7b,0x6cfbad78,0x7fab5e8c,0x8dc0dd8f,0xe330a81a,0x115b2b19,0x20bd8ed,0xf0605bee,0x24aa3f05,0xd6c1bc06,0xc5914ff2,0x37faccf1,0x69e9f0d5,0x9b8273d6,0x88d28022,0x7ab90321,0xae7367ca,0x5c18e4c9,0x4f48173d,0xbd23943e,0xf36e6f75,0x105ec76,0x12551f82,0xe03e9c81,0x34f4f86a,0xc69f7b69,0xd5cf889d,0x27a40b9e,0x79b737ba,0x8bdcb4b9,0x988c474d,0x6ae7c44e,0xbe2da0a5,0x4c4623a6,0x5f16d052,0xad7d5351])},89903:(e,t,r)=>{let i=r(15240),s=e=>Uint32Array.from([e])[0];e.exports=e=>s(i(e))},28144:e=>{e.exports=e=>({key:e.readVarIntString(),value:e.readVarIntBytes()})},26489:(e,t,r)=>{let i=r(36880);e.exports=({key:e,value:t})=>new i().writeVarIntString(e).writeVarIntBytes(t)},42534:(e,t,r)=>{let i=r(25481),s=r(28144),a=r(81748);e.exports=(e,t={})=>{let{firstOffset:r,firstTimestamp:n,magicByte:o,isControlBatch:l=!1,timestampType:c,maxTimestamp:d}=t,u=e.readInt8(),h=e.readVarLong(),p=c===a.LOG_APPEND_TIME&&d?d:i.fromValue(n).add(h).toString(),f=e.readVarInt(),m=i.fromValue(r).add(f).toString();return{magicByte:o,attributes:u,timestamp:p,offset:m,key:e.readVarIntBytes(),value:e.readVarIntBytes(),headers:e.readVarIntArray(s).reduce((e,{key:t,value:r})=>({...e,[t]:void 0===e[t]?r:Array.isArray(e[t])?e[t].concat([r]):[e[t],r]}),{}),isControlRecord:l,batchContext:t}}},54865:(e,t,r)=>{let i=r(36880),s=r(26489);e.exports=({offsetDelta:e=0,timestampDelta:t=0,key:r,value:n,headers:o={}})=>{let l=Object.keys(o).flatMap(e=>Array.isArray(o[e])?o[e].map(t=>({key:e,value:t})):[{key:e,value:o[e]}]),c=1+i.sizeOfVarLong(t)+i.sizeOfVarInt(e)+i.sizeOfVarIntBytes(r)+i.sizeOfVarIntBytes(n)+a(l);return new i().writeVarInt(c).writeInt8(0).writeVarLong(t).writeVarInt(e).writeVarIntBytes(r).writeVarIntBytes(n).writeVarIntArray(l.map(s))};let a=e=>{let t=i.sizeOfVarInt(e.length);for(let r of e){let e=Buffer.byteLength(r.key),s=Buffer.byteLength(r.value);t+=i.sizeOfVarInt(e)+e,null===r.value?t+=i.sizeOfVarInt(-1):t+=i.sizeOfVarInt(s)+s}return t}},28211:(e,t,r)=>{let i=r(10243),{KafkaJSPartialMessageError:s}=r(15847),{lookupCodecByAttributes:a}=r(22863),n=r(42534),o=r(81748);e.exports=async e=>{let t=e.readInt64().toString(),r=e.readInt32(),i=e.slice(r);e.forward(r);let n=Buffer.byteLength(i.buffer);if(n<r)throw new s(`Tried to decode a partial record batch: remainingBytes(${n}) < recordBatchLength(${r})`);let c=i.readInt32(),d=i.readInt8();i.readInt32();let u=i.readInt16(),h=i.readInt32(),p=i.readInt64().toString(),f=i.readInt64().toString(),m=i.readInt64().toString(),g=i.readInt16(),w=i.readInt32(),I=(16&u)>0,y=(32&u)>0,b=(8&u)>0?o.LOG_APPEND_TIME:o.CREATE_TIME,T=a(u),E={firstOffset:t,firstTimestamp:p,partitionLeaderEpoch:c,inTransaction:I,isControlBatch:y,lastOffsetDelta:h,producerId:m,producerEpoch:g,firstSequence:w,maxTimestamp:f,timestampType:b},S=await l(T,i,{...E,magicByte:d});return{...E,records:S}};let l=async(e,t,r)=>{if(!e)return t.readArray(e=>c(e,r));let s=t.readInt32();if(s<=0)return[];let a=t.readAll(),n=new i(await e.decompress(a)),o=Array(s);for(let e=0;e<s;e++)o[e]=c(n,r);return o},c=(e,t)=>n(new i(e.readVarIntBytes()),t)},45338:(e,t,r)=>{let i=r(25481),s=r(36880),a=r(89903),{Types:n,lookupCodec:o,COMPRESSION_CODEC_MASK:l}=r(22863),c=async({compression:e=n.None,firstOffset:t=i.fromInt(0),firstTimestamp:r=Date.now(),maxTimestamp:o=Date.now(),partitionLeaderEpoch:c=0,lastOffsetDelta:u=0,transactional:h=!1,producerId:p=i.fromValue(-1),producerEpoch:f=0,firstSequence:m=0,records:g=[]})=>{let w=e&l,I=new s().writeInt16(0|w|(h?16:0)).writeInt32(u).writeInt64(r).writeInt64(o).writeInt64(p).writeInt16(f).writeInt32(m);if(e===n.None)g.every(e=>typeof e==typeof g[0])?I.writeArray(g,typeof g[0]):I.writeArray(g);else{let t=await d(e,g);I.writeInt32(g.length).writeBuffer(t)}let y=new s().writeInt32(c).writeInt8(2).writeUInt32(a(I.buffer)).writeEncoder(I);return new s().writeInt64(t).writeBytes(y.buffer)},d=async(e,t)=>{let r=o(e),i=new s;return i.writeEncoderArray(t),r.compress(i)};e.exports={RecordBatch:c,MAGIC_BYTE:2}},2292:(e,t,r)=>{let i=r(36880);e.exports=async({correlationId:e,clientId:t,request:{apiKey:r,apiVersion:s,encode:a}})=>{let n=await a(),o=new i().writeInt16(r).writeInt16(s).writeInt32(e).writeString(t).writeEncoder(n);return new i().writeInt32(o.size()).writeEncoder(o)}},936:(e,t,r)=>{let i={0:({transactionalId:e,producerId:t,producerEpoch:i,groupId:s})=>{let a=r(28487),n=r(9842);return{request:a({transactionalId:e,producerId:t,producerEpoch:i,groupId:s}),response:n}},1:({transactionalId:e,producerId:t,producerEpoch:i,groupId:s})=>{let a=r(45815),n=r(31010);return{request:a({transactionalId:e,producerId:t,producerEpoch:i,groupId:s}),response:n}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},28487:(e,t,r)=>{let i=r(36880),{AddOffsetsToTxn:s}=r(80146);e.exports=({transactionalId:e,producerId:t,producerEpoch:r,groupId:a})=>({apiKey:s,apiVersion:0,apiName:"AddOffsetsToTxn",encode:async()=>new i().writeString(e).writeInt64(t).writeInt16(r).writeString(a)})},9842:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a,failIfVersionNotSupported:n}=r(15644),o=async e=>{let t=new i(e),r=t.readInt32(),s=t.readInt16();return n(s),{throttleTime:r,errorCode:s}},l=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decode:o,parse:l}},45815:(e,t,r)=>{let i=r(28487);e.exports=({transactionalId:e,producerId:t,producerEpoch:r,groupId:s})=>Object.assign(i({transactionalId:e,producerId:t,producerEpoch:r,groupId:s}),{apiVersion:1})},31010:(e,t,r)=>{let{parse:i,decode:s}=r(9842),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},15987:(e,t,r)=>{let i={0:({transactionalId:e,producerId:t,producerEpoch:i,topics:s})=>{let a=r(69217),n=r(41750);return{request:a({transactionalId:e,producerId:t,producerEpoch:i,topics:s}),response:n}},1:({transactionalId:e,producerId:t,producerEpoch:i,topics:s})=>{let a=r(12569),n=r(30727);return{request:a({transactionalId:e,producerId:t,producerEpoch:i,topics:s}),response:n}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},69217:(e,t,r)=>{let i=r(36880),{AddPartitionsToTxn:s}=r(80146);e.exports=({transactionalId:e,producerId:t,producerEpoch:r,topics:n})=>({apiKey:s,apiVersion:0,apiName:"AddPartitionsToTxn",encode:async()=>new i().writeString(e).writeInt64(t).writeInt16(r).writeArray(n.map(a))});let a=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(n)),n=e=>new i().writeInt32(e)},41750:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),errors:await t.readArrayAsync(o)}},o=async e=>({topic:e.readString(),partitionErrors:await e.readArrayAsync(l)}),l=e=>({partition:e.readInt32(),errorCode:e.readInt16()}),c=async e=>{let t=e.errors.map(({partitionErrors:e})=>({partitionsWithErrors:e.filter(({errorCode:e})=>s(e))})).filter(({partitionsWithErrors:e})=>e.length);if(t.length>0)throw a(t[0].partitionsWithErrors[0].errorCode);return e};e.exports={decode:n,parse:c}},12569:(e,t,r)=>{let i=r(69217);e.exports=({transactionalId:e,producerId:t,producerEpoch:r,topics:s})=>Object.assign(i({transactionalId:e,producerId:t,producerEpoch:r,topics:s}),{apiVersion:1})},30727:(e,t,r)=>{let{parse:i,decode:s}=r(41750),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},45490:(e,t,r)=>{let i={0:({resources:e,validateOnly:t})=>{let i=r(86154),s=r(74714);return{request:i({resources:e,validateOnly:t}),response:s}},1:({resources:e,validateOnly:t})=>{let i=r(97988),s=r(88056);return{request:i({resources:e,validateOnly:t}),response:s}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},86154:(e,t,r)=>{let i=r(36880),{AlterConfigs:s}=r(80146);e.exports=({resources:e,validateOnly:t=!1})=>({apiKey:s,apiVersion:0,apiName:"AlterConfigs",encode:async()=>new i().writeArray(e.map(a)).writeBoolean(t)});let a=({type:e,name:t,configEntries:r})=>new i().writeInt8(e).writeString(t).writeArray(r.map(n)),n=({name:e,value:t})=>new i().writeString(e).writeString(t)},74714:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=e=>({errorCode:e.readInt16(),errorMessage:e.readString(),resourceType:e.readInt8(),resourceName:e.readString()}),o=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),resources:t.readArray(n)}},l=async e=>{let t=e.resources.filter(({errorCode:e})=>s(e));if(t.length>0)throw a(t[0].errorCode);return e};e.exports={decode:o,parse:l}},97988:(e,t,r)=>{let i=r(86154);e.exports=({resources:e,validateOnly:t})=>Object.assign(i({resources:e,validateOnly:t}),{apiVersion:1})},88056:(e,t,r)=>{let{parse:i,decode:s}=r(74714),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},28846:(e,t,r)=>{let i={0:({topics:e,timeout:t})=>{let i=r(64946),s=r(42528);return{request:i({topics:e,timeout:t}),response:s}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},64946:(e,t,r)=>{let i=r(36880),{AlterPartitionReassignments:s}=r(80146);e.exports=({topics:e,timeout:t=5e3})=>({apiKey:s,apiVersion:0,apiName:"AlterPartitionReassignments",encode:async()=>new i().writeUVarIntBytes().writeInt32(t).writeUVarIntArray(e.map(a)).writeUVarIntBytes()});let a=({topic:e,partitionAssignment:t})=>new i().writeUVarIntString(e).writeUVarIntArray(t.map(n)).writeUVarIntBytes(),n=({partition:e,replicas:t})=>new i().writeInt32(e).writeUVarIntArray(t.map(o)).writeUVarIntBytes(),o=e=>new i().writeInt32(e)},42528:(e,t,r)=>{let{KafkaJSAggregateError:i,KafkaJSAlterPartitionReassignmentsError:s}=r(15847),a=r(10243),{failure:n,createErrorFromCode:o}=r(15644),l=e=>{let t={topic:e.readUVarIntString(),partitions:e.readUVarIntArray(c)};return e.readTaggedFields(),t},c=e=>{let t={partition:e.readInt32(),errorCode:e.readInt16()};return e.readUVarIntString(),e.readTaggedFields(),t},d=async e=>{let t=new a(e);t.readTaggedFields();let r=t.readInt32(),i=t.readInt16();return t.readUVarIntString(),{throttleTime:r,errorCode:i,responses:t.readUVarIntArray(l)}},u=async e=>{if(n(e.errorCode))throw new s(o(e.errorCode));let t=e.responses.flatMap(({partitions:e,topic:t})=>e.filter(e=>n(e.errorCode)).map(e=>({...e,topic:t})));if(t.length>0)throw new i("Errors altering partition reassignments",t.map(({topic:e,partition:t,errorCode:r})=>new s(o(r),e,t)));return e};e.exports={decode:d,parse:u}},80146:e=>{e.exports={Produce:0,Fetch:1,ListOffsets:2,Metadata:3,LeaderAndIsr:4,StopReplica:5,UpdateMetadata:6,ControlledShutdown:7,OffsetCommit:8,OffsetFetch:9,GroupCoordinator:10,JoinGroup:11,Heartbeat:12,LeaveGroup:13,SyncGroup:14,DescribeGroups:15,ListGroups:16,SaslHandshake:17,ApiVersions:18,CreateTopics:19,DeleteTopics:20,DeleteRecords:21,InitProducerId:22,OffsetForLeaderEpoch:23,AddPartitionsToTxn:24,AddOffsetsToTxn:25,EndTxn:26,WriteTxnMarkers:27,TxnOffsetCommit:28,DescribeAcls:29,CreateAcls:30,DeleteAcls:31,DescribeConfigs:32,AlterConfigs:33,AlterReplicaLogDirs:34,DescribeLogDirs:35,SaslAuthenticate:36,CreatePartitions:37,CreateDelegationToken:38,RenewDelegationToken:39,ExpireDelegationToken:40,DescribeDelegationToken:41,DeleteGroups:42,ElectPreferredLeaders:43,IncrementalAlterConfigs:44,AlterPartitionReassignments:45,ListPartitionReassignments:46}},17507:(e,t,r)=>{let i={0:()=>{let e=r(37347),t=r(59298);return{request:e(),response:t,logResponseError:!0}},1:()=>{let e=r(88119),t=r(63368);return{request:e(),response:t,logResponseError:!1}},2:()=>{let e=r(77998),t=r(86533);return{request:e(),response:t,logResponseError:!1}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},37347:(e,t,r)=>{let i=r(36880),{ApiVersions:s}=r(80146);e.exports=()=>({apiKey:s,apiVersion:0,apiName:"ApiVersions",encode:async()=>new i})},59298:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a,failIfVersionNotSupported:n}=r(15644),o=e=>({apiKey:e.readInt16(),minVersion:e.readInt16(),maxVersion:e.readInt16()}),l=async e=>{let t=new i(e),r=t.readInt16();return n(r),{errorCode:r,apiVersions:t.readArray(o)}},c=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decode:l,parse:c}},88119:(e,t,r)=>{let i=r(37347);e.exports=()=>({...i(),apiVersion:1})},63368:(e,t,r)=>{let i=r(10243),{failIfVersionNotSupported:s}=r(15644),{parse:a}=r(59298),n=e=>({apiKey:e.readInt16(),minVersion:e.readInt16(),maxVersion:e.readInt16()}),o=async e=>{let t=new i(e),r=t.readInt16();return s(r),{errorCode:r,apiVersions:t.readArray(n),throttleTime:t.canReadInt32()?t.readInt32():0}};e.exports={decode:o,parse:a}},77998:(e,t,r)=>{let i=r(37347);e.exports=()=>({...i(),apiVersion:2})},86533:(e,t,r)=>{let{parse:i,decode:s}=r(63368),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},66226:(e,t,r)=>{let i={0:({creations:e})=>{let t=r(16830),i=r(20200);return{request:t({creations:e}),response:i}},1:({creations:e})=>{let t=r(79674),i=r(8690);return{request:t({creations:e}),response:i}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},16830:(e,t,r)=>{let i=r(36880),{CreateAcls:s}=r(80146),a=({resourceType:e,resourceName:t,principal:r,host:s,operation:a,permissionType:n})=>new i().writeInt8(e).writeString(t).writeString(r).writeString(s).writeInt8(a).writeInt8(n);e.exports=({creations:e})=>({apiKey:s,apiVersion:0,apiName:"CreateAcls",encode:async()=>new i().writeArray(e.map(a))})},20200:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=e=>({errorCode:e.readInt16(),errorMessage:e.readString()}),o=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),creationResponses:t.readArray(n)}},l=async e=>{let t=e.creationResponses.filter(({errorCode:e})=>s(e));if(t.length>0)throw a(t[0].errorCode);return e};e.exports={decode:o,parse:l}},79674:(e,t,r)=>{let i=r(36880),{CreateAcls:s}=r(80146),a=({resourceType:e,resourceName:t,resourcePatternType:r,principal:s,host:a,operation:n,permissionType:o})=>new i().writeInt8(e).writeString(t).writeInt8(r).writeString(s).writeString(a).writeInt8(n).writeInt8(o);e.exports=({creations:e})=>({apiKey:s,apiVersion:1,apiName:"CreateAcls",encode:async()=>new i().writeArray(e.map(a))})},8690:(e,t,r)=>{let{parse:i,decode:s}=r(20200),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},30755:(e,t,r)=>{let i={0:({topicPartitions:e,timeout:t,validateOnly:i})=>{let s=r(23134),a=r(51055);return{request:s({topicPartitions:e,timeout:t,validateOnly:i}),response:a}},1:({topicPartitions:e,validateOnly:t,timeout:i})=>{let s=r(15560),a=r(97794);return{request:s({topicPartitions:e,validateOnly:t,timeout:i}),response:a}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},23134:(e,t,r)=>{let i=r(36880),{CreatePartitions:s}=r(80146);e.exports=({topicPartitions:e,validateOnly:t=!1,timeout:r=5e3})=>({apiKey:s,apiVersion:0,apiName:"CreatePartitions",encode:async()=>new i().writeArray(e.map(a)).writeInt32(r).writeBoolean(t)});let a=({topic:e,count:t,assignments:r=[]})=>new i().writeString(e).writeInt32(t).writeNullableArray(r.map(n)),n=e=>new i().writeNullableArray(e)},51055:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=(e,t)=>e.topic.localeCompare(t.topic),o=e=>({topic:e.readString(),errorCode:e.readInt16(),errorMessage:e.readString()}),l=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),topicErrors:t.readArray(o).sort(n)}},c=async e=>{let t=e.topicErrors.filter(({errorCode:e})=>s(e));if(t.length>0)throw a(t[0].errorCode);return e};e.exports={decode:l,parse:c}},15560:(e,t,r)=>{let i=r(23134);e.exports=({topicPartitions:e,validateOnly:t,timeout:r})=>Object.assign(i({topicPartitions:e,validateOnly:t,timeout:r}),{apiVersion:1})},97794:(e,t,r)=>{let{parse:i,decode:s}=r(51055),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},92512:(e,t,r)=>{let i={0:({topics:e,timeout:t})=>{let i=r(95771),s=r(56949);return{request:i({topics:e,timeout:t}),response:s}},1:({topics:e,validateOnly:t,timeout:i})=>{let s=r(82552),a=r(61299);return{request:s({topics:e,validateOnly:t,timeout:i}),response:a}},2:({topics:e,validateOnly:t,timeout:i})=>{let s=r(74199),a=r(47839);return{request:s({topics:e,validateOnly:t,timeout:i}),response:a}},3:({topics:e,validateOnly:t,timeout:i})=>{let s=r(46345),a=r(71849);return{request:s({topics:e,validateOnly:t,timeout:i}),response:a}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},95771:(e,t,r)=>{let i=r(36880),{CreateTopics:s}=r(80146);e.exports=({topics:e,timeout:t=5e3})=>({apiKey:s,apiVersion:0,apiName:"CreateTopics",encode:async()=>new i().writeArray(e.map(a)).writeInt32(t)});let a=({topic:e,numPartitions:t=-1,replicationFactor:r=-1,replicaAssignment:s=[],configEntries:a=[]})=>new i().writeString(e).writeInt32(t).writeInt16(r).writeArray(s.map(n)).writeArray(a.map(o)),n=({partition:e,replicas:t})=>new i().writeInt32(e).writeArray(t),o=({name:e,value:t})=>new i().writeString(e).writeString(t)},56949:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),{KafkaJSAggregateError:n,KafkaJSCreateTopicError:o}=r(15847),l=(e,t)=>e.topic.localeCompare(t.topic),c=e=>({topic:e.readString(),errorCode:e.readInt16()}),d=async e=>({topicErrors:new i(e).readArray(c).sort(l)}),u=async e=>{let t=e.topicErrors.filter(({errorCode:e})=>s(e));if(t.length>0)throw new n("Topic creation errors",t.map(e=>new o(a(e.errorCode),e.topic)));return e};e.exports={decode:d,parse:u}},82552:(e,t,r)=>{let i=r(36880),{CreateTopics:s}=r(80146);e.exports=({topics:e,validateOnly:t=!1,timeout:r=5e3})=>({apiKey:s,apiVersion:1,apiName:"CreateTopics",encode:async()=>new i().writeArray(e.map(a)).writeInt32(r).writeBoolean(t)});let a=({topic:e,numPartitions:t=-1,replicationFactor:r=-1,replicaAssignment:s=[],configEntries:a=[]})=>new i().writeString(e).writeInt32(t).writeInt16(r).writeArray(s.map(n)).writeArray(a.map(o)),n=({partition:e,replicas:t})=>new i().writeInt32(e).writeArray(t),o=({name:e,value:t})=>new i().writeString(e).writeString(t)},61299:(e,t,r)=>{let i=r(10243),{parse:s}=r(56949),a=(e,t)=>e.topic.localeCompare(t.topic),n=e=>({topic:e.readString(),errorCode:e.readInt16(),errorMessage:e.readString()}),o=async e=>({topicErrors:new i(e).readArray(n).sort(a)});e.exports={decode:o,parse:s}},74199:(e,t,r)=>{let i=r(82552);e.exports=({topics:e,validateOnly:t,timeout:r})=>Object.assign(i({topics:e,validateOnly:t,timeout:r}),{apiVersion:2})},47839:(e,t,r)=>{let i=r(10243),{parse:s}=r(61299),a=(e,t)=>e.topic.localeCompare(t.topic),n=e=>({topic:e.readString(),errorCode:e.readInt16(),errorMessage:e.readString()}),o=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),topicErrors:t.readArray(n).sort(a)}};e.exports={decode:o,parse:s}},46345:(e,t,r)=>{let i=r(74199);e.exports=({topics:e,validateOnly:t,timeout:r})=>Object.assign(i({topics:e,validateOnly:t,timeout:r}),{apiVersion:3})},71849:(e,t,r)=>{let{parse:i,decode:s}=r(47839),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},70149:(e,t,r)=>{let i={0:({filters:e})=>{let t=r(6544),i=r(71713);return{request:t({filters:e}),response:i}},1:({filters:e})=>{let t=r(22004),i=r(78451);return{request:t({filters:e}),response:i}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},6544:(e,t,r)=>{let i=r(36880),{DeleteAcls:s}=r(80146),a=({resourceType:e,resourceName:t,principal:r,host:s,operation:a,permissionType:n})=>new i().writeInt8(e).writeString(t).writeString(r).writeString(s).writeInt8(a).writeInt8(n);e.exports=({filters:e})=>({apiKey:s,apiVersion:0,apiName:"DeleteAcls",encode:async()=>new i().writeArray(e.map(a))})},71713:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=e=>({errorCode:e.readInt16(),errorMessage:e.readString(),resourceType:e.readInt8(),resourceName:e.readString(),principal:e.readString(),host:e.readString(),operation:e.readInt8(),permissionType:e.readInt8()}),o=e=>({errorCode:e.readInt16(),errorMessage:e.readString(),matchingAcls:e.readArray(n)}),l=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),filterResponses:t.readArray(o)}},c=async e=>{let t=e.filterResponses.filter(({errorCode:e})=>s(e));if(t.length>0)throw a(t[0].errorCode);for(let t of e.filterResponses){let e=t.matchingAcls.filter(({errorCode:e})=>s(e));if(e.length>0)throw a(e[0].errorCode)}return e};e.exports={decodeMatchingAcls:n,decodeFilterResponse:o,decode:l,parse:c}},22004:(e,t,r)=>{let i=r(36880),{DeleteAcls:s}=r(80146),a=({resourceType:e,resourceName:t,resourcePatternType:r,principal:s,host:a,operation:n,permissionType:o})=>new i().writeInt8(e).writeString(t).writeInt8(r).writeString(s).writeString(a).writeInt8(n).writeInt8(o);e.exports=({filters:e})=>({apiKey:s,apiVersion:1,apiName:"DeleteAcls",encode:async()=>new i().writeArray(e.map(a))})},78451:(e,t,r)=>{let i=r(10243),{parse:s}=r(71713),a=e=>({errorCode:e.readInt16(),errorMessage:e.readString(),resourceType:e.readInt8(),resourceName:e.readString(),resourcePatternType:e.readInt8(),principal:e.readString(),host:e.readString(),operation:e.readInt8(),permissionType:e.readInt8()}),n=e=>({errorCode:e.readInt16(),errorMessage:e.readString(),matchingAcls:e.readArray(a)}),o=async e=>{let t=new i(e);return{throttleTime:0,clientSideThrottleTime:t.readInt32(),filterResponses:t.readArray(n)}};e.exports={decode:o,parse:s}},74499:(e,t,r)=>{let i={0:e=>{let t=r(92211),i=r(91726);return{request:t(e),response:i}},1:e=>{let t=r(7249),i=r(8225);return{request:t(e),response:i}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},92211:(e,t,r)=>{let i=r(36880),{DeleteGroups:s}=r(80146);e.exports=e=>({apiKey:s,apiVersion:0,apiName:"DeleteGroups",encode:async()=>new i().writeArray(e.map(a))});let a=e=>new i().writeString(e)},91726:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=e=>({groupId:e.readString(),errorCode:e.readInt16()}),o=async e=>{let t=new i(e),r=t.readInt32(),o=t.readArray(n);for(let e of o)s(e.errorCode)&&(e.error=a(e.errorCode));return{throttleTimeMs:r,results:o}},l=async e=>e;e.exports={decode:o,parse:l}},7249:(e,t,r)=>{let i=r(92211);e.exports=e=>Object.assign(i(e),{apiVersion:1})},8225:(e,t,r)=>{let{parse:i,decode:s}=r(91726),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},7283:(e,t,r)=>{let i={0:({topics:e,timeout:t})=>{let i=r(35190),s=r(35861);return{request:i({topics:e,timeout:t}),response:s({topics:e})}},1:({topics:e,timeout:t})=>{let i=r(47576),s=r(22113);return{request:i({topics:e,timeout:t}),response:s({topics:e})}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},35190:(e,t,r)=>{let i=r(36880),{DeleteRecords:s}=r(80146);e.exports=({topics:e,timeout:t=5e3})=>({apiKey:s,apiVersion:0,apiName:"DeleteRecords",encode:async()=>new i().writeArray(e.map(({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(({partition:e,offset:t})=>new i().writeInt32(e).writeInt64(t))))).writeInt32(t)})},35861:(e,t,r)=>{let i=r(10243),{KafkaJSDeleteTopicRecordsError:s}=r(15847),{failure:a,createErrorFromCode:n}=r(15644),o=(e,t)=>e.topic.localeCompare(t.topic),l=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),topics:t.readArray(e=>({topic:e.readString(),partitions:e.readArray(e=>({partition:e.readInt32(),lowWatermark:e.readInt64(),errorCode:e.readInt16()}))})).sort(o)}},c=e=>async t=>{let r=t.topics.map(({partitions:e})=>({partitionsWithErrors:e.filter(({errorCode:e})=>a(e))})).filter(({partitionsWithErrors:e})=>e.length);if(r.length>0){let[{topic:i}]=t.topics,[{partitions:a}]=e,[{partitionsWithErrors:o}]=r;throw new s({topic:i,partitions:o.map(({partition:e,errorCode:t})=>({partition:e,error:n(t),offset:a.find(t=>t.partition===e).offset}))})}return t};e.exports=({topics:e})=>({decode:l,parse:c(e)})},47576:(e,t,r)=>{let i=r(35190);e.exports=({topics:e,timeout:t})=>Object.assign(i({topics:e,timeout:t}),{apiVersion:1})},22113:(e,t,r)=>{let i=r(35861);e.exports=({topics:e})=>{let{parse:t,decode:r}=i({topics:e});return{decode:async e=>{let t=await r(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:t}}},22262:(e,t,r)=>{let i={0:({topics:e,timeout:t})=>{let i=r(26394),s=r(40221);return{request:i({topics:e,timeout:t}),response:s}},1:({topics:e,timeout:t})=>{let i=r(60716),s=r(63539);return{request:i({topics:e,timeout:t}),response:s}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},26394:(e,t,r)=>{let i=r(36880),{DeleteTopics:s}=r(80146);e.exports=({topics:e,timeout:t=5e3})=>({apiKey:s,apiVersion:0,apiName:"DeleteTopics",encode:async()=>new i().writeArray(e).writeInt32(t)})},40221:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=(e,t)=>e.topic.localeCompare(t.topic),o=e=>({topic:e.readString(),errorCode:e.readInt16()}),l=async e=>({topicErrors:new i(e).readArray(o).sort(n)}),c=async e=>{let t=e.topicErrors.filter(({errorCode:e})=>s(e));if(t.length>0)throw a(t[0].errorCode);return e};e.exports={decode:l,parse:c}},60716:(e,t,r)=>{let i=r(26394);e.exports=({topics:e,timeout:t})=>Object.assign(i({topics:e,timeout:t}),{apiVersion:1})},63539:(e,t,r)=>{let i=r(10243),{parse:s}=r(40221),a=(e,t)=>e.topic.localeCompare(t.topic),n=e=>({topic:e.readString(),errorCode:e.readInt16()}),o=async e=>{let t=new i(e);return{throttleTime:0,clientSideThrottleTime:t.readInt32(),topicErrors:t.readArray(n).sort(a)}};e.exports={decode:o,parse:s}},74553:(e,t,r)=>{let i={0:({resourceType:e,resourceName:t,principal:i,host:s,operation:a,permissionType:n})=>{let o=r(85554),l=r(91405);return{request:o({resourceType:e,resourceName:t,principal:i,host:s,operation:a,permissionType:n}),response:l}},1:({resourceType:e,resourceName:t,resourcePatternType:i,principal:s,host:a,operation:n,permissionType:o})=>{let l=r(72249),c=r(61478);return{request:l({resourceType:e,resourceName:t,resourcePatternType:i,principal:s,host:a,operation:n,permissionType:o}),response:c}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},85554:(e,t,r)=>{let i=r(36880),{DescribeAcls:s}=r(80146);e.exports=({resourceType:e,resourceName:t,principal:r,host:a,operation:n,permissionType:o})=>({apiKey:s,apiVersion:0,apiName:"DescribeAcls",encode:async()=>new i().writeInt8(e).writeString(t).writeString(r).writeString(a).writeInt8(n).writeInt8(o)})},91405:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=e=>({principal:e.readString(),host:e.readString(),operation:e.readInt8(),permissionType:e.readInt8()}),o=e=>({resourceType:e.readInt8(),resourceName:e.readString(),acls:e.readArray(n)}),l=async e=>{let t=new i(e),r=t.readInt32();return{throttleTime:r,errorCode:t.readInt16(),errorMessage:t.readString(),resources:t.readArray(o)}},c=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decode:l,parse:c}},72249:(e,t,r)=>{let i=r(36880),{DescribeAcls:s}=r(80146);e.exports=({resourceType:e,resourceName:t,resourcePatternType:r,principal:a,host:n,operation:o,permissionType:l})=>({apiKey:s,apiVersion:1,apiName:"DescribeAcls",encode:async()=>new i().writeInt8(e).writeString(t).writeInt8(r).writeString(a).writeString(n).writeInt8(o).writeInt8(l)})},61478:(e,t,r)=>{let{parse:i}=r(91405),s=r(10243),a=e=>({principal:e.readString(),host:e.readString(),operation:e.readInt8(),permissionType:e.readInt8()}),n=e=>({resourceType:e.readInt8(),resourceName:e.readString(),resourcePatternType:e.readInt8(),acls:e.readArray(a)}),o=async e=>{let t=new s(e),r=t.readInt32();return{throttleTime:0,clientSideThrottleTime:r,errorCode:t.readInt16(),errorMessage:t.readString(),resources:t.readArray(n)}};e.exports={decode:o,parse:i}},93638:(e,t,r)=>{let i={0:({resources:e})=>{let t=r(25161),i=r(27534);return{request:t({resources:e}),response:i}},1:({resources:e,includeSynonyms:t})=>{let i=r(30746),s=r(43806);return{request:i({resources:e,includeSynonyms:t}),response:s}},2:({resources:e,includeSynonyms:t})=>{let i=r(78420),s=r(5932);return{request:i({resources:e,includeSynonyms:t}),response:s}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},25161:(e,t,r)=>{let i=r(36880),{DescribeConfigs:s}=r(80146);e.exports=({resources:e})=>({apiKey:s,apiVersion:0,apiName:"DescribeConfigs",encode:async()=>new i().writeArray(e.map(a))});let a=({type:e,name:t,configNames:r=[]})=>new i().writeInt8(e).writeString(t).writeNullableArray(r)},27534:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=r(22625),o=r(92282),l=(e,t)=>{let r;let i=e.readString(),s=e.readString(),a=e.readBoolean(),l=e.readBoolean(),c=e.readBoolean();if(l)r=n.DEFAULT_CONFIG;else switch(t){case o.BROKER:r=n.STATIC_BROKER_CONFIG;break;case o.TOPIC:r=n.TOPIC_CONFIG;break;default:r=n.UNKNOWN}return{configName:i,configValue:s,readOnly:a,isDefault:l,configSource:r,isSensitive:c}},c=e=>{let t=e.readInt16(),r=e.readString(),i=e.readInt8(),s=e.readString(),a=e.readArray(e=>l(e,i));return{errorCode:t,errorMessage:r,resourceType:i,resourceName:s,configEntries:a}},d=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),resources:t.readArray(c)}},u=async e=>{let t=e.resources.filter(({errorCode:e})=>s(e));if(t.length>0)throw a(t[0].errorCode);return e};e.exports={decode:d,parse:u}},30746:(e,t,r)=>{let i=r(36880),{DescribeConfigs:s}=r(80146);e.exports=({resources:e,includeSynonyms:t=!1})=>({apiKey:s,apiVersion:1,apiName:"DescribeConfigs",encode:async()=>new i().writeArray(e.map(a)).writeBoolean(t)});let a=({type:e,name:t,configNames:r=[]})=>new i().writeInt8(e).writeString(t).writeNullableArray(r)},43806:(e,t,r)=>{let i=r(10243),{parse:s}=r(27534),{DEFAULT_CONFIG:a}=r(22625),n=e=>({configName:e.readString(),configValue:e.readString(),configSource:e.readInt8()}),o=e=>{let t=e.readString(),r=e.readString(),i=e.readBoolean(),s=e.readInt8();return{configName:t,configValue:r,readOnly:i,isDefault:s===a,configSource:s,isSensitive:e.readBoolean(),configSynonyms:e.readArray(n)}},l=e=>({errorCode:e.readInt16(),errorMessage:e.readString(),resourceType:e.readInt8(),resourceName:e.readString(),configEntries:e.readArray(o)}),c=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),resources:t.readArray(l)}};e.exports={decode:c,parse:s}},78420:(e,t,r)=>{let i=r(30746);e.exports=({resources:e,includeSynonyms:t})=>Object.assign(i({resources:e,includeSynonyms:t}),{apiVersion:2})},5932:(e,t,r)=>{let{parse:i,decode:s}=r(43806),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},15690:(e,t,r)=>{let i={0:({groupIds:e})=>{let t=r(19245),i=r(80833);return{request:t({groupIds:e}),response:i}},1:({groupIds:e})=>{let t=r(58825),i=r(2238);return{request:t({groupIds:e}),response:i}},2:({groupIds:e})=>{let t=r(19038),i=r(85679);return{request:t({groupIds:e}),response:i}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},19245:(e,t,r)=>{let i=r(36880),{DescribeGroups:s}=r(80146);e.exports=({groupIds:e})=>({apiKey:s,apiVersion:0,apiName:"DescribeGroups",encode:async()=>new i().writeArray(e)})},80833:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=e=>({memberId:e.readString(),clientId:e.readString(),clientHost:e.readString(),memberMetadata:e.readBytes(),memberAssignment:e.readBytes()}),o=e=>({errorCode:e.readInt16(),groupId:e.readString(),state:e.readString(),protocolType:e.readString(),protocol:e.readString(),members:e.readArray(n)}),l=async e=>({groups:new i(e).readArray(o)}),c=async e=>{let t=e.groups.filter(({errorCode:e})=>s(e));if(t.length>0)throw a(t[0].errorCode);return e};e.exports={decode:l,parse:c}},58825:(e,t,r)=>{let i=r(19245);e.exports=({groupIds:e})=>Object.assign(i({groupIds:e}),{apiVersion:1})},2238:(e,t,r)=>{let i=r(10243),{parse:s}=r(80833),a=e=>({memberId:e.readString(),clientId:e.readString(),clientHost:e.readString(),memberMetadata:e.readBytes(),memberAssignment:e.readBytes()}),n=e=>({errorCode:e.readInt16(),groupId:e.readString(),state:e.readString(),protocolType:e.readString(),protocol:e.readString(),members:e.readArray(a)}),o=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),groups:t.readArray(n)}};e.exports={decode:o,parse:s}},19038:(e,t,r)=>{let i=r(58825);e.exports=({groupIds:e})=>Object.assign(i({groupIds:e}),{apiVersion:2})},85679:(e,t,r)=>{let{parse:i,decode:s}=r(2238),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},50441:(e,t,r)=>{let i={0:({transactionalId:e,producerId:t,producerEpoch:i,transactionResult:s})=>{let a=r(85869),n=r(82697);return{request:a({transactionalId:e,producerId:t,producerEpoch:i,transactionResult:s}),response:n}},1:({transactionalId:e,producerId:t,producerEpoch:i,transactionResult:s})=>{let a=r(42313),n=r(83835);return{request:a({transactionalId:e,producerId:t,producerEpoch:i,transactionResult:s}),response:n}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},85869:(e,t,r)=>{let i=r(36880),{EndTxn:s}=r(80146);e.exports=({transactionalId:e,producerId:t,producerEpoch:r,transactionResult:a})=>({apiKey:s,apiVersion:0,apiName:"EndTxn",encode:async()=>new i().writeString(e).writeInt64(t).writeInt16(r).writeBoolean(a)})},82697:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a,failIfVersionNotSupported:n}=r(15644),o=async e=>{let t=new i(e),r=t.readInt32(),s=t.readInt16();return n(s),{throttleTime:r,errorCode:s}},l=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decode:o,parse:l}},42313:(e,t,r)=>{let i=r(85869);e.exports=({transactionalId:e,producerId:t,producerEpoch:r,transactionResult:s})=>Object.assign(i({transactionalId:e,producerId:t,producerEpoch:r,transactionResult:s}),{apiVersion:1})},83835:(e,t,r)=>{let{parse:i,decode:s}=r(82697),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},70366:(e,t,r)=>{let i=r(20236),s=-1,a=e=>Number.isSafeInteger(e+100)?e+100:e,n={0:({replicaId:e=s,maxWaitTime:t,minBytes:i,topics:n})=>{let o=r(91365),l=r(94822);return{request:o({replicaId:e,maxWaitTime:t,minBytes:i,topics:n}),response:l,requestTimeout:a(t)}},1:({replicaId:e=s,maxWaitTime:t,minBytes:i,topics:n})=>{let o=r(90393),l=r(60158);return{request:o({replicaId:e,maxWaitTime:t,minBytes:i,topics:n}),response:l,requestTimeout:a(t)}},2:({replicaId:e=s,maxWaitTime:t,minBytes:i,topics:n})=>{let o=r(41828),l=r(28986);return{request:o({replicaId:e,maxWaitTime:t,minBytes:i,topics:n}),response:l,requestTimeout:a(t)}},3:({replicaId:e=s,maxWaitTime:t,minBytes:i,maxBytes:n,topics:o})=>{let l=r(77178),c=r(49400);return{request:l({replicaId:e,maxWaitTime:t,minBytes:i,maxBytes:n,topics:o}),response:c,requestTimeout:a(t)}},4:({replicaId:e=s,isolationLevel:t=i.READ_COMMITTED,maxWaitTime:n,minBytes:o,maxBytes:l,topics:c})=>{let d=r(66088),u=r(1152);return{request:d({replicaId:e,isolationLevel:t,maxWaitTime:n,minBytes:o,maxBytes:l,topics:c}),response:u,requestTimeout:a(n)}},5:({replicaId:e=s,isolationLevel:t=i.READ_COMMITTED,maxWaitTime:n,minBytes:o,maxBytes:l,topics:c})=>{let d=r(10163),u=r(65869);return{request:d({replicaId:e,isolationLevel:t,maxWaitTime:n,minBytes:o,maxBytes:l,topics:c}),response:u,requestTimeout:a(n)}},6:({replicaId:e=s,isolationLevel:t=i.READ_COMMITTED,maxWaitTime:n,minBytes:o,maxBytes:l,topics:c})=>{let d=r(63790),u=r(15281);return{request:d({replicaId:e,isolationLevel:t,maxWaitTime:n,minBytes:o,maxBytes:l,topics:c}),response:u,requestTimeout:a(n)}},7:({replicaId:e=s,isolationLevel:t=i.READ_COMMITTED,sessionId:n=0,sessionEpoch:o=-1,forgottenTopics:l=[],maxWaitTime:c,minBytes:d,maxBytes:u,topics:h})=>{let p=r(21282),f=r(29478);return{request:p({replicaId:e,isolationLevel:t,sessionId:n,sessionEpoch:o,forgottenTopics:l,maxWaitTime:c,minBytes:d,maxBytes:u,topics:h}),response:f,requestTimeout:a(c)}},8:({replicaId:e=s,isolationLevel:t=i.READ_COMMITTED,sessionId:n=0,sessionEpoch:o=-1,forgottenTopics:l=[],maxWaitTime:c,minBytes:d,maxBytes:u,topics:h})=>{let p=r(74449),f=r(55536);return{request:p({replicaId:e,isolationLevel:t,sessionId:n,sessionEpoch:o,forgottenTopics:l,maxWaitTime:c,minBytes:d,maxBytes:u,topics:h}),response:f,requestTimeout:a(c)}},9:({replicaId:e=s,isolationLevel:t=i.READ_COMMITTED,sessionId:n=0,sessionEpoch:o=-1,forgottenTopics:l=[],maxWaitTime:c,minBytes:d,maxBytes:u,topics:h})=>{let p=r(21188),f=r(19902);return{request:p({replicaId:e,isolationLevel:t,sessionId:n,sessionEpoch:o,forgottenTopics:l,maxWaitTime:c,minBytes:d,maxBytes:u,topics:h}),response:f,requestTimeout:a(c)}},10:({replicaId:e=s,isolationLevel:t=i.READ_COMMITTED,sessionId:n=0,sessionEpoch:o=-1,forgottenTopics:l=[],maxWaitTime:c,minBytes:d,maxBytes:u,topics:h})=>{let p=r(6305),f=r(72052);return{request:p({replicaId:e,isolationLevel:t,sessionId:n,sessionEpoch:o,forgottenTopics:l,maxWaitTime:c,minBytes:d,maxBytes:u,topics:h}),response:f,requestTimeout:a(c)}},11:({replicaId:e=s,isolationLevel:t=i.READ_COMMITTED,sessionId:n=0,sessionEpoch:o=-1,forgottenTopics:l=[],maxWaitTime:c,minBytes:d,maxBytes:u,topics:h,rackId:p})=>{let f=r(4987),m=r(75797);return{request:f({replicaId:e,isolationLevel:t,sessionId:n,sessionEpoch:o,forgottenTopics:l,maxWaitTime:c,minBytes:d,maxBytes:u,topics:h,rackId:p}),response:m,requestTimeout:a(c)}}};e.exports={versions:Object.keys(n),protocol:({version:e})=>n[e]}},91365:(e,t,r)=>{let i=r(36880),{Fetch:s}=r(80146);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,topics:n})=>({apiKey:s,apiVersion:0,apiName:"Fetch",encode:async()=>new i().writeInt32(e).writeInt32(t).writeInt32(r).writeArray(n.map(a))});let a=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(n)),n=({partition:e,fetchOffset:t,maxBytes:r})=>new i().writeInt32(e).writeInt64(t).writeInt32(r)},94822:(e,t,r)=>{let i=r(10243),{KafkaJSOffsetOutOfRange:s}=r(15847),{failure:a,createErrorFromCode:n,errorCodes:o}=r(15644),l=r(83450),c=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),messages:await l(e)}),d=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(c)}),u=async e=>{let t=new i(e);return{responses:await t.readArrayAsync(d)}},{code:h}=o.find(e=>"OFFSET_OUT_OF_RANGE"===e.type),p=async e=>{let t=e.responses.flatMap(({topicName:e,partitions:t})=>t.filter(e=>a(e.errorCode)).map(t=>Object.assign({},t,{topic:e})));if(t.length>0){let{errorCode:e,topic:r,partition:i}=t[0];if(e===h)throw new s(n(e),{topic:r,partition:i});throw n(e)}return e};e.exports={decode:u,parse:p}},6305:(e,t,r)=>{let i=r(20236),s=r(21188);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:a,topics:n,isolationLevel:o=i.READ_COMMITTED,sessionId:l=0,sessionEpoch:c=-1,forgottenTopics:d=[]})=>Object.assign(s({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:a,topics:n,isolationLevel:o,sessionId:l,sessionEpoch:c,forgottenTopics:d}),{apiVersion:10})},72052:(e,t,r)=>{let{decode:i,parse:s}=r(19902);e.exports={decode:i,parse:s}},4987:(e,t,r)=>{let i=r(36880),{Fetch:s}=r(80146),a=r(20236);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:l,topics:c,rackId:d="",isolationLevel:u=a.READ_COMMITTED,sessionId:h=0,sessionEpoch:p=-1,forgottenTopics:f=[]})=>({apiKey:s,apiVersion:11,apiName:"Fetch",encode:async()=>new i().writeInt32(e).writeInt32(t).writeInt32(r).writeInt32(l).writeInt8(u).writeInt32(h).writeInt32(p).writeArray(c.map(o)).writeArray(f.map(n)).writeString(d)});let n=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t),o=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(l)),l=({partition:e,currentLeaderEpoch:t=-1,fetchOffset:r,logStartOffset:s=-1,maxBytes:a})=>new i().writeInt32(e).writeInt32(t).writeInt64(r).writeInt64(s).writeInt32(a)},75797:(e,t,r)=>{let i=r(10243),{parse:s}=r(60158),a=r(55834),n=e=>({producerId:e.readInt64().toString(),firstOffset:e.readInt64().toString()}),o=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),lastStableOffset:e.readInt64().toString(),lastStartOffset:e.readInt64().toString(),abortedTransactions:e.readArray(n),preferredReadReplica:e.readInt32(),messages:await a(e)}),l=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(o)}),c=async e=>{let t=new i(e),r=t.readInt32();return{throttleTime:0,clientSideThrottleTime:r,errorCode:t.readInt16(),sessionId:t.readInt32(),responses:await t.readArrayAsync(l)}};e.exports={decode:c,parse:s}},90393:(e,t,r)=>{let i=r(91365);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,topics:s})=>Object.assign(i({replicaId:e,maxWaitTime:t,minBytes:r,topics:s}),{apiVersion:1})},60158:(e,t,r)=>{let i=r(10243),{parse:s}=r(94822),a=r(83450),n=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),messages:await a(e)}),o=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(n)}),l=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),responses:await t.readArrayAsync(o)}};e.exports={decode:l,parse:s}},41828:(e,t,r)=>{let i=r(91365);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,topics:s})=>Object.assign(i({replicaId:e,maxWaitTime:t,minBytes:r,topics:s}),{apiVersion:2})},28986:(e,t,r)=>{let{decode:i,parse:s}=r(60158);e.exports={decode:i,parse:s}},77178:(e,t,r)=>{let i=r(36880),{Fetch:s}=r(80146);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:n,topics:o})=>({apiKey:s,apiVersion:3,apiName:"Fetch",encode:async()=>new i().writeInt32(e).writeInt32(t).writeInt32(r).writeInt32(n).writeArray(o.map(a))});let a=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(n)),n=({partition:e,fetchOffset:t,maxBytes:r})=>new i().writeInt32(e).writeInt64(t).writeInt32(r)},49400:(e,t,r)=>{let{decode:i,parse:s}=r(60158);e.exports={decode:i,parse:s}},55834:(e,t,r)=>{let i=r(10243),s=r(83450),a=r(28211),{MAGIC_BYTE:n}=r(45338),o=async e=>{let t=e.readInt32();if(t<=0||!e.canReadBytes(t))return[];let r=e.readBytes(t),o=new i(r);if(r.slice(16).readInt8(0)===n){let e=[];for(;o.canReadBytes(49);)try{let t=await a(o);e.push(...t.records)}catch(e){if("KafkaJSPartialMessageError"===e.name)break;throw e}return e}return s(o,t)};e.exports=o},66088:(e,t,r)=>{let i=r(36880),{Fetch:s}=r(80146),a=r(20236);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:o,topics:l,isolationLevel:c=a.READ_COMMITTED})=>({apiKey:s,apiVersion:4,apiName:"Fetch",encode:async()=>new i().writeInt32(e).writeInt32(t).writeInt32(r).writeInt32(o).writeInt8(c).writeArray(l.map(n))});let n=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(o)),o=({partition:e,fetchOffset:t,maxBytes:r})=>new i().writeInt32(e).writeInt64(t).writeInt32(r)},1152:(e,t,r)=>{let i=r(10243),{parse:s}=r(60158),a=r(55834),n=e=>({producerId:e.readInt64().toString(),firstOffset:e.readInt64().toString()}),o=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),lastStableOffset:e.readInt64().toString(),abortedTransactions:e.readArray(n),messages:await a(e)}),l=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(o)}),c=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),responses:await t.readArrayAsync(l)}};e.exports={decode:c,parse:s}},10163:(e,t,r)=>{let i=r(36880),{Fetch:s}=r(80146),a=r(20236);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:o,topics:l,isolationLevel:c=a.READ_COMMITTED})=>({apiKey:s,apiVersion:5,apiName:"Fetch",encode:async()=>new i().writeInt32(e).writeInt32(t).writeInt32(r).writeInt32(o).writeInt8(c).writeArray(l.map(n))});let n=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(o)),o=({partition:e,fetchOffset:t,logStartOffset:r=-1,maxBytes:s})=>new i().writeInt32(e).writeInt64(t).writeInt64(r).writeInt32(s)},65869:(e,t,r)=>{let i=r(10243),{parse:s}=r(60158),a=r(55834),n=e=>({producerId:e.readInt64().toString(),firstOffset:e.readInt64().toString()}),o=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),lastStableOffset:e.readInt64().toString(),lastStartOffset:e.readInt64().toString(),abortedTransactions:e.readArray(n),messages:await a(e)}),l=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(o)}),c=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),responses:await t.readArrayAsync(l)}};e.exports={decode:c,parse:s}},63790:(e,t,r)=>{let i=r(20236),s=r(10163);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:a,topics:n,isolationLevel:o=i.READ_COMMITTED})=>Object.assign(s({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:a,topics:n,isolationLevel:o}),{apiVersion:6})},15281:(e,t,r)=>{let{decode:i,parse:s}=r(65869);e.exports={decode:i,parse:s}},21282:(e,t,r)=>{let i=r(36880),{Fetch:s}=r(80146),a=r(20236);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:l,topics:c,isolationLevel:d=a.READ_COMMITTED,sessionId:u=0,sessionEpoch:h=-1,forgottenTopics:p=[]})=>({apiKey:s,apiVersion:7,apiName:"Fetch",encode:async()=>new i().writeInt32(e).writeInt32(t).writeInt32(r).writeInt32(l).writeInt8(d).writeInt32(u).writeInt32(h).writeArray(c.map(o)).writeArray(p.map(n))});let n=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t),o=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(l)),l=({partition:e,fetchOffset:t,logStartOffset:r=-1,maxBytes:s})=>new i().writeInt32(e).writeInt64(t).writeInt64(r).writeInt32(s)},29478:(e,t,r)=>{let i=r(10243),{parse:s}=r(60158),a=r(55834),n=e=>({producerId:e.readInt64().toString(),firstOffset:e.readInt64().toString()}),o=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),lastStableOffset:e.readInt64().toString(),lastStartOffset:e.readInt64().toString(),abortedTransactions:e.readArray(n),messages:await a(e)}),l=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(o)}),c=async e=>{let t=new i(e),r=t.readInt32();return{throttleTime:r,errorCode:t.readInt16(),sessionId:t.readInt32(),responses:await t.readArrayAsync(l)}};e.exports={decode:c,parse:s}},74449:(e,t,r)=>{let i=r(20236),s=r(21282);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:a,topics:n,isolationLevel:o=i.READ_COMMITTED,sessionId:l=0,sessionEpoch:c=-1,forgottenTopics:d=[]})=>Object.assign(s({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:a,topics:n,isolationLevel:o,sessionId:l,sessionEpoch:c,forgottenTopics:d}),{apiVersion:8})},55536:(e,t,r)=>{let i=r(10243),{parse:s}=r(60158),a=r(55834),n=e=>({producerId:e.readInt64().toString(),firstOffset:e.readInt64().toString()}),o=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),lastStableOffset:e.readInt64().toString(),lastStartOffset:e.readInt64().toString(),abortedTransactions:e.readArray(n),messages:await a(e)}),l=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(o)}),c=async e=>{let t=new i(e),r=t.readInt32();return{throttleTime:0,clientSideThrottleTime:r,errorCode:t.readInt16(),sessionId:t.readInt32(),responses:await t.readArrayAsync(l)}};e.exports={decode:c,parse:s}},21188:(e,t,r)=>{let i=r(36880),{Fetch:s}=r(80146),a=r(20236);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:l,topics:c,isolationLevel:d=a.READ_COMMITTED,sessionId:u=0,sessionEpoch:h=-1,forgottenTopics:p=[]})=>({apiKey:s,apiVersion:9,apiName:"Fetch",encode:async()=>new i().writeInt32(e).writeInt32(t).writeInt32(r).writeInt32(l).writeInt8(d).writeInt32(u).writeInt32(h).writeArray(c.map(o)).writeArray(p.map(n))});let n=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t),o=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(l)),l=({partition:e,currentLeaderEpoch:t=-1,fetchOffset:r,logStartOffset:s=-1,maxBytes:a})=>new i().writeInt32(e).writeInt32(t).writeInt64(r).writeInt64(s).writeInt32(a)},19902:(e,t,r)=>{let{decode:i,parse:s}=r(55536);e.exports={decode:i,parse:s}},93777:(e,t,r)=>{let i=r(46212),s={0:({groupId:e})=>{let t=r(62005),i=r(88273);return{request:t({groupId:e}),response:i}},1:({groupId:e,coordinatorType:t=i.GROUP})=>{let s=r(66081),a=r(60611);return{request:s({coordinatorKey:e,coordinatorType:t}),response:a}},2:({groupId:e,coordinatorType:t=i.GROUP})=>{let s=r(16162),a=r(87575);return{request:s({coordinatorKey:e,coordinatorType:t}),response:a}}};e.exports={versions:Object.keys(s),protocol:({version:e})=>s[e]}},62005:(e,t,r)=>{let i=r(36880),{GroupCoordinator:s}=r(80146);e.exports=({groupId:e})=>({apiKey:s,apiVersion:0,apiName:"GroupCoordinator",encode:async()=>new i().writeString(e)})},88273:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a,failIfVersionNotSupported:n}=r(15644),o=async e=>{let t=new i(e),r=t.readInt16();return n(r),{errorCode:r,coordinator:{nodeId:t.readInt32(),host:t.readString(),port:t.readInt32()}}},l=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decode:o,parse:l}},66081:(e,t,r)=>{let i=r(36880),{GroupCoordinator:s}=r(80146);e.exports=({coordinatorKey:e,coordinatorType:t})=>({apiKey:s,apiVersion:1,apiName:"GroupCoordinator",encode:async()=>new i().writeString(e).writeInt8(t)})},60611:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a,failIfVersionNotSupported:n}=r(15644),o=async e=>{let t=new i(e),r=t.readInt32(),s=t.readInt16();return n(s),{throttleTime:r,errorCode:s,errorMessage:t.readString(),coordinator:{nodeId:t.readInt32(),host:t.readString(),port:t.readInt32()}}},l=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decode:o,parse:l}},16162:(e,t,r)=>{let i=r(66081);e.exports=({coordinatorKey:e,coordinatorType:t})=>Object.assign(i({coordinatorKey:e,coordinatorType:t}),{apiVersion:2})},87575:(e,t,r)=>{let{parse:i,decode:s}=r(60611),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},87599:(e,t,r)=>{let i={0:({groupId:e,groupGenerationId:t,memberId:i})=>{let s=r(51937),a=r(97050);return{request:s({groupId:e,groupGenerationId:t,memberId:i}),response:a}},1:({groupId:e,groupGenerationId:t,memberId:i})=>{let s=r(57920),a=r(15479);return{request:s({groupId:e,groupGenerationId:t,memberId:i}),response:a}},2:({groupId:e,groupGenerationId:t,memberId:i})=>{let s=r(1362),a=r(75311);return{request:s({groupId:e,groupGenerationId:t,memberId:i}),response:a}},3:({groupId:e,groupGenerationId:t,memberId:i,groupInstanceId:s})=>{let a=r(37533),n=r(41335);return{request:a({groupId:e,groupGenerationId:t,memberId:i,groupInstanceId:s}),response:n}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},51937:(e,t,r)=>{let i=r(36880),{Heartbeat:s}=r(80146);e.exports=({groupId:e,groupGenerationId:t,memberId:r})=>({apiKey:s,apiVersion:0,apiName:"Heartbeat",encode:async()=>new i().writeString(e).writeInt32(t).writeString(r)})},97050:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a,failIfVersionNotSupported:n}=r(15644),o=async e=>{let t=new i(e).readInt16();return n(t),{errorCode:t}},l=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decode:o,parse:l}},57920:(e,t,r)=>{let i=r(51937);e.exports=({groupId:e,groupGenerationId:t,memberId:r})=>Object.assign(i({groupId:e,groupGenerationId:t,memberId:r}),{apiVersion:1})},15479:(e,t,r)=>{let i=r(10243),{failIfVersionNotSupported:s}=r(15644),{parse:a}=r(97050),n=async e=>{let t=new i(e),r=t.readInt32(),a=t.readInt16();return s(a),{throttleTime:r,errorCode:a}};e.exports={decode:n,parse:a}},1362:(e,t,r)=>{let i=r(57920);e.exports=({groupId:e,groupGenerationId:t,memberId:r})=>Object.assign(i({groupId:e,groupGenerationId:t,memberId:r}),{apiVersion:2})},75311:(e,t,r)=>{let{parse:i,decode:s}=r(15479),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},37533:(e,t,r)=>{let i=r(36880),{Heartbeat:s}=r(80146);e.exports=({groupId:e,groupGenerationId:t,memberId:r,groupInstanceId:a})=>({apiKey:s,apiVersion:3,apiName:"Heartbeat",encode:async()=>new i().writeString(e).writeInt32(t).writeString(r).writeString(a)})},41335:(e,t,r)=>{let{parse:i,decode:s}=r(75311);e.exports={decode:s,parse:i}},98830:(e,t,r)=>{let i=r(80146),{KafkaJSServerDoesNotSupportApiKey:s,KafkaJSNotImplemented:a}=r(15847),n={versions:[],protocol:()=>{throw new a}},o={Produce:r(78209),Fetch:r(70366),ListOffsets:r(24064),Metadata:r(20987),LeaderAndIsr:n,StopReplica:n,UpdateMetadata:n,ControlledShutdown:n,OffsetCommit:r(30076),OffsetFetch:r(85630),GroupCoordinator:r(93777),JoinGroup:r(33564),Heartbeat:r(87599),LeaveGroup:r(24264),SyncGroup:r(67121),DescribeGroups:r(15690),ListGroups:r(45953),SaslHandshake:r(19293),ApiVersions:r(17507),CreateTopics:r(92512),DeleteTopics:r(22262),DeleteRecords:r(7283),InitProducerId:r(27669),OffsetForLeaderEpoch:n,AddPartitionsToTxn:r(15987),AddOffsetsToTxn:r(936),EndTxn:r(50441),WriteTxnMarkers:n,TxnOffsetCommit:r(91745),DescribeAcls:r(74553),CreateAcls:r(66226),DeleteAcls:r(70149),DescribeConfigs:r(93638),AlterConfigs:r(45490),AlterReplicaLogDirs:n,DescribeLogDirs:n,SaslAuthenticate:r(97587),CreatePartitions:r(30755),CreateDelegationToken:n,RenewDelegationToken:n,ExpireDelegationToken:n,DescribeDelegationToken:n,DeleteGroups:r(74499),ElectLeaders:n,IncrementalAlterConfigs:n,AlterPartitionReassignments:r(28846),ListPartitionReassignments:r(87593)},l=Object.keys(i),c=Object.values(i),d=e=>l[c.indexOf(e)];e.exports={requests:o,lookup:e=>(t,r)=>{let i=e[t],a=Math.max(...r.versions.map(Number));if(!i||null==i.maxVersion)throw new s("The Kafka server does not support the requested API version",{apiKey:t,apiName:d(t)});let n=Math.min(a,i.maxVersion);return r.protocol({version:n})}}},27669:(e,t,r)=>{let i={0:({transactionalId:e,transactionTimeout:t=5e3})=>{let i=r(49841),s=r(84993);return{request:i({transactionalId:e,transactionTimeout:t}),response:s}},1:({transactionalId:e,transactionTimeout:t=5e3})=>{let i=r(28852),s=r(73976);return{request:i({transactionalId:e,transactionTimeout:t}),response:s}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},49841:(e,t,r)=>{let i=r(36880),{InitProducerId:s}=r(80146);e.exports=({transactionalId:e,transactionTimeout:t})=>({apiKey:s,apiVersion:0,apiName:"InitProducerId",encode:async()=>new i().writeString(e).writeInt32(t)})},84993:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a,failIfVersionNotSupported:n}=r(15644),o=async e=>{let t=new i(e),r=t.readInt32(),s=t.readInt16();return n(s),{throttleTime:r,errorCode:s,producerId:t.readInt64().toString(),producerEpoch:t.readInt16()}},l=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decode:o,parse:l}},28852:(e,t,r)=>{let i=r(49841);e.exports=({transactionalId:e,transactionTimeout:t})=>Object.assign(i({transactionalId:e,transactionTimeout:t}),{apiVersion:1})},73976:(e,t,r)=>{let{parse:i,decode:s}=r(84993),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},33564:(e,t,r)=>{let i=({rebalanceTimeout:e,sessionTimeout:t})=>{let r=e||t;return Number.isSafeInteger(r+5e3)?r+5e3:r},s=e=>null!=e&&""!==e,a={0:({groupId:e,sessionTimeout:t,memberId:s,protocolType:a,groupProtocols:n})=>{let o=r(55865),l=r(97946);return{request:o({groupId:e,sessionTimeout:t,memberId:s,protocolType:a,groupProtocols:n}),response:l,requestTimeout:i({rebalanceTimeout:null,sessionTimeout:t})}},1:({groupId:e,sessionTimeout:t,rebalanceTimeout:s,memberId:a,protocolType:n,groupProtocols:o})=>{let l=r(13490),c=r(45825);return{request:l({groupId:e,sessionTimeout:t,rebalanceTimeout:s,memberId:a,protocolType:n,groupProtocols:o}),response:c,requestTimeout:i({rebalanceTimeout:s,sessionTimeout:t})}},2:({groupId:e,sessionTimeout:t,rebalanceTimeout:s,memberId:a,protocolType:n,groupProtocols:o})=>{let l=r(54031),c=r(91156);return{request:l({groupId:e,sessionTimeout:t,rebalanceTimeout:s,memberId:a,protocolType:n,groupProtocols:o}),response:c,requestTimeout:i({rebalanceTimeout:s,sessionTimeout:t})}},3:({groupId:e,sessionTimeout:t,rebalanceTimeout:s,memberId:a,protocolType:n,groupProtocols:o})=>{let l=r(27879),c=r(27119);return{request:l({groupId:e,sessionTimeout:t,rebalanceTimeout:s,memberId:a,protocolType:n,groupProtocols:o}),response:c,requestTimeout:i({rebalanceTimeout:s,sessionTimeout:t})}},4:({groupId:e,sessionTimeout:t,rebalanceTimeout:a,memberId:n,protocolType:o,groupProtocols:l})=>{let c=r(27100),d=r(49379);return{request:c({groupId:e,sessionTimeout:t,rebalanceTimeout:a,memberId:n,protocolType:o,groupProtocols:l}),response:d,requestTimeout:i({rebalanceTimeout:a,sessionTimeout:t}),logResponseError:s(n)}},5:({groupId:e,sessionTimeout:t,rebalanceTimeout:a,memberId:n,groupInstanceId:o,protocolType:l,groupProtocols:c})=>{let d=r(23205),u=r(30661);return{request:d({groupId:e,sessionTimeout:t,rebalanceTimeout:a,memberId:n,groupInstanceId:o,protocolType:l,groupProtocols:c}),response:u,requestTimeout:i({rebalanceTimeout:a,sessionTimeout:t}),logResponseError:s(n)}}};e.exports={versions:Object.keys(a),protocol:({version:e})=>a[e]}},55865:(e,t,r)=>{let i=r(36880),{JoinGroup:s}=r(80146);e.exports=({groupId:e,sessionTimeout:t,memberId:r,protocolType:n,groupProtocols:o})=>({apiKey:s,apiVersion:0,apiName:"JoinGroup",encode:async()=>new i().writeString(e).writeInt32(t).writeString(r).writeString(n).writeArray(o.map(a))});let a=({name:e,metadata:t=Buffer.alloc(0)})=>new i().writeString(e).writeBytes(t)},97946:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a,failIfVersionNotSupported:n}=r(15644),o=async e=>{let t=new i(e),r=t.readInt16();return n(r),{errorCode:r,generationId:t.readInt32(),groupProtocol:t.readString(),leaderId:t.readString(),memberId:t.readString(),members:t.readArray(e=>({memberId:e.readString(),memberMetadata:e.readBytes()}))}},l=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decode:o,parse:l}},13490:(e,t,r)=>{let i=r(36880),{JoinGroup:s}=r(80146);e.exports=({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:n,protocolType:o,groupProtocols:l})=>({apiKey:s,apiVersion:1,apiName:"JoinGroup",encode:async()=>new i().writeString(e).writeInt32(t).writeInt32(r).writeString(n).writeString(o).writeArray(l.map(a))});let a=({name:e,metadata:t=Buffer.alloc(0)})=>new i().writeString(e).writeBytes(t)},45825:(e,t,r)=>{let{parse:i,decode:s}=r(97946);e.exports={decode:s,parse:i}},54031:(e,t,r)=>{let i=r(13490);e.exports=({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:s,protocolType:a,groupProtocols:n})=>Object.assign(i({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:s,protocolType:a,groupProtocols:n}),{apiVersion:2})},91156:(e,t,r)=>{let i=r(10243),{failIfVersionNotSupported:s}=r(15644),{parse:a}=r(97946),n=async e=>{let t=new i(e),r=t.readInt32(),a=t.readInt16();return s(a),{throttleTime:r,errorCode:a,generationId:t.readInt32(),groupProtocol:t.readString(),leaderId:t.readString(),memberId:t.readString(),members:t.readArray(e=>({memberId:e.readString(),memberMetadata:e.readBytes()}))}};e.exports={decode:n,parse:a}},27879:(e,t,r)=>{let i=r(54031);e.exports=({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:s,protocolType:a,groupProtocols:n})=>Object.assign(i({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:s,protocolType:a,groupProtocols:n}),{apiVersion:3})},27119:(e,t,r)=>{let{parse:i,decode:s}=r(91156),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},27100:(e,t,r)=>{let i=r(27879);e.exports=({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:s,protocolType:a,groupProtocols:n})=>Object.assign(i({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:s,protocolType:a,groupProtocols:n}),{apiVersion:4})},49379:(e,t,r)=>{let{decode:i}=r(27119),{KafkaJSMemberIdRequired:s}=r(15847),{failure:a,createErrorFromCode:n,errorCodes:o}=r(15644),{code:l}=o.find(e=>"MEMBER_ID_REQUIRED"===e.type),c=async e=>{if(a(e.errorCode)){if(e.errorCode===l)throw new s(n(e.errorCode),{memberId:e.memberId});throw n(e.errorCode)}return e};e.exports={decode:i,parse:c}},23205:(e,t,r)=>{let i=r(36880),{JoinGroup:s}=r(80146);e.exports=({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:n,groupInstanceId:o=null,protocolType:l,groupProtocols:c})=>({apiKey:s,apiVersion:5,apiName:"JoinGroup",encode:async()=>new i().writeString(e).writeInt32(t).writeInt32(r).writeString(n).writeString(o).writeString(l).writeArray(c.map(a))});let a=({name:e,metadata:t=Buffer.alloc(0)})=>new i().writeString(e).writeBytes(t)},30661:(e,t,r)=>{let i=r(10243),{KafkaJSMemberIdRequired:s}=r(15847),{failure:a,createErrorFromCode:n,errorCodes:o,failIfVersionNotSupported:l}=r(15644),{code:c}=o.find(e=>"MEMBER_ID_REQUIRED"===e.type),d=async e=>{if(a(e.errorCode)){if(e.errorCode===c)throw new s(n(e.errorCode),{memberId:e.memberId});throw n(e.errorCode)}return e},u=async e=>{let t=new i(e),r=t.readInt32(),s=t.readInt16();return l(s),{throttleTime:0,clientSideThrottleTime:r,errorCode:s,generationId:t.readInt32(),groupProtocol:t.readString(),leaderId:t.readString(),memberId:t.readString(),members:t.readArray(e=>({memberId:e.readString(),groupInstanceId:e.readString(),memberMetadata:e.readBytes()}))}};e.exports={decode:u,parse:d}},24264:(e,t,r)=>{let i={0:({groupId:e,memberId:t})=>{let i=r(29620),s=r(84159);return{request:i({groupId:e,memberId:t}),response:s}},1:({groupId:e,memberId:t})=>{let i=r(36249),s=r(37800);return{request:i({groupId:e,memberId:t}),response:s}},2:({groupId:e,memberId:t})=>{let i=r(25961),s=r(89488);return{request:i({groupId:e,memberId:t}),response:s}},3:({groupId:e,memberId:t,groupInstanceId:i})=>{let s=r(60574),a=r(48827);return{request:s({groupId:e,members:[{memberId:t,groupInstanceId:i}]}),response:a}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},29620:(e,t,r)=>{let i=r(36880),{LeaveGroup:s}=r(80146);e.exports=({groupId:e,memberId:t})=>({apiKey:s,apiVersion:0,apiName:"LeaveGroup",encode:async()=>new i().writeString(e).writeString(t)})},84159:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a,failIfVersionNotSupported:n}=r(15644),o=async e=>{let t=new i(e).readInt16();return n(t),{errorCode:t}},l=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decode:o,parse:l}},36249:(e,t,r)=>{let i=r(29620);e.exports=({groupId:e,memberId:t})=>Object.assign(i({groupId:e,memberId:t}),{apiVersion:1})},37800:(e,t,r)=>{let i=r(10243),{failIfVersionNotSupported:s}=r(15644),{parse:a}=r(84159),n=async e=>{let t=new i(e),r=t.readInt32(),a=t.readInt16();return s(a),{throttleTime:r,errorCode:a}};e.exports={decode:n,parse:a}},25961:(e,t,r)=>{let i=r(36249);e.exports=({groupId:e,memberId:t})=>Object.assign(i({groupId:e,memberId:t}),{apiVersion:2})},89488:(e,t,r)=>{let{parse:i,decode:s}=r(37800),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},60574:(e,t,r)=>{let i=r(36880),{LeaveGroup:s}=r(80146);e.exports=({groupId:e,members:t})=>({apiKey:s,apiVersion:3,apiName:"LeaveGroup",encode:async()=>new i().writeString(e).writeArray(t.map(e=>a(e)))});let a=({memberId:e,groupInstanceId:t=null})=>new i().writeString(e).writeString(t)},48827:(e,t,r)=>{let i=r(10243),{failIfVersionNotSupported:s,failure:a,createErrorFromCode:n}=r(15644),{parse:o}=r(89488),l=async e=>{let t=new i(e),r=t.readInt32(),a=t.readInt16(),n=t.readArray(c);return s(a),{throttleTime:0,clientSideThrottleTime:r,errorCode:a,members:n}},c=e=>({memberId:e.readString(),groupInstanceId:e.readString(),errorCode:e.readInt16()}),d=async e=>{let t=o(e),r=e.members.find(e=>a(e.errorCode));if(r)throw n(r.errorCode);return t};e.exports={decode:l,parse:d}},45953:(e,t,r)=>{let i={0:()=>{let e=r(29816),t=r(91790);return{request:e(),response:t}},1:()=>{let e=r(31206),t=r(22521);return{request:e(),response:t}},2:()=>{let e=r(62910),t=r(3650);return{request:e(),response:t}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},29816:(e,t,r)=>{let i=r(36880),{ListGroups:s}=r(80146);e.exports=()=>({apiKey:s,apiVersion:0,apiName:"ListGroups",encode:async()=>new i})},91790:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=e=>({groupId:e.readString(),protocolType:e.readString()}),o=async e=>{let t=new i(e);return{errorCode:t.readInt16(),groups:t.readArray(n)}},l=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decodeGroup:n,decode:o,parse:l}},31206:(e,t,r)=>{let i=r(29816);e.exports=()=>Object.assign(i(),{apiVersion:1})},22521:(e,t,r)=>{let i=r(91790),s=r(10243),a=async e=>{let t=new s(e);return{throttleTime:t.readInt32(),errorCode:t.readInt16(),groups:t.readArray(i.decodeGroup)}};e.exports={decode:a,parse:i.parse}},62910:(e,t,r)=>{let i=r(31206);e.exports=()=>Object.assign(i(),{apiVersion:2})},3650:(e,t,r)=>{let{parse:i,decode:s}=r(22521),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},24064:(e,t,r)=>{let i=r(20236),s=-1,a={0:({replicaId:e=s,topics:t})=>{let i=r(56872),a=r(95448);return{request:i({replicaId:e,topics:t}),response:a}},1:({replicaId:e=s,topics:t})=>{let i=r(84696),a=r(85050);return{request:i({replicaId:e,topics:t}),response:a}},2:({replicaId:e=s,isolationLevel:t=i.READ_COMMITTED,topics:a})=>{let n=r(54976),o=r(16509);return{request:n({replicaId:e,isolationLevel:t,topics:a}),response:o}},3:({replicaId:e=s,isolationLevel:t=i.READ_COMMITTED,topics:a})=>{let n=r(89998),o=r(85872);return{request:n({replicaId:e,isolationLevel:t,topics:a}),response:o}}};e.exports={versions:Object.keys(a),protocol:({version:e})=>a[e]}},56872:(e,t,r)=>{let i=r(36880),{ListOffsets:s}=r(80146);e.exports=({replicaId:e,topics:t})=>({apiKey:s,apiVersion:0,apiName:"ListOffsets",encode:async()=>new i().writeInt32(e).writeArray(t.map(a))});let a=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(n)),n=({partition:e,timestamp:t=-1,maxNumOffsets:r=1})=>new i().writeInt32(e).writeInt64(t).writeInt32(r)},95448:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=async e=>({responses:new i(e).readArray(o)}),o=e=>({topic:e.readString(),partitions:e.readArray(l)}),l=e=>({partition:e.readInt32(),errorCode:e.readInt16(),offsets:e.readArray(c)}),c=e=>e.readInt64().toString(),d=async e=>{let t=e.responses.flatMap(e=>e.partitions.filter(e=>s(e.errorCode)))[0];if(t)throw a(t.errorCode);return e};e.exports={decode:n,parse:d}},84696:(e,t,r)=>{let i=r(36880),{ListOffsets:s}=r(80146);e.exports=({replicaId:e,topics:t})=>({apiKey:s,apiVersion:1,apiName:"ListOffsets",encode:async()=>new i().writeInt32(e).writeArray(t.map(a))});let a=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(n)),n=({partition:e,timestamp:t=-1})=>new i().writeInt32(e).writeInt64(t)},85050:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=async e=>({responses:new i(e).readArray(o)}),o=e=>({topic:e.readString(),partitions:e.readArray(l)}),l=e=>({partition:e.readInt32(),errorCode:e.readInt16(),timestamp:e.readInt64().toString(),offset:e.readInt64().toString()}),c=async e=>{let t=e.responses.flatMap(e=>e.partitions.filter(e=>s(e.errorCode)))[0];if(t)throw a(t.errorCode);return e};e.exports={decode:n,parse:c}},54976:(e,t,r)=>{let i=r(36880),{ListOffsets:s}=r(80146);e.exports=({replicaId:e,isolationLevel:t,topics:r})=>({apiKey:s,apiVersion:2,apiName:"ListOffsets",encode:async()=>new i().writeInt32(e).writeInt8(t).writeArray(r.map(a))});let a=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(n)),n=({partition:e,timestamp:t=-1})=>new i().writeInt32(e).writeInt64(t)},16509:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),responses:t.readArray(o)}},o=e=>({topic:e.readString(),partitions:e.readArray(l)}),l=e=>({partition:e.readInt32(),errorCode:e.readInt16(),timestamp:e.readInt64().toString(),offset:e.readInt64().toString()}),c=async e=>{let t=e.responses.flatMap(e=>e.partitions.filter(e=>s(e.errorCode)))[0];if(t)throw a(t.errorCode);return e};e.exports={decode:n,parse:c}},89998:(e,t,r)=>{let i=r(54976);e.exports=({replicaId:e,isolationLevel:t,topics:r})=>Object.assign(i({replicaId:e,isolationLevel:t,topics:r}),{apiVersion:3})},85872:(e,t,r)=>{let{parse:i,decode:s}=r(16509),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},87593:(e,t,r)=>{let i={0:({topics:e,timeout:t})=>{let i=r(11570),s=r(48946);return{request:i({topics:e,timeout:t}),response:s}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},11570:(e,t,r)=>{let i=r(36880),{ListPartitionReassignments:s}=r(80146);e.exports=({topics:e=null,timeout:t=5e3})=>({apiKey:s,apiVersion:0,apiName:"ListPartitionReassignments",encode:async()=>new i().writeUVarIntBytes().writeInt32(t).writeUVarIntArray(null===e?e:e.map(a)).writeUVarIntBytes()});let a=({topic:e,partitions:t})=>new i().writeUVarIntString(e).writeUVarIntArray(t.map(n)).writeUVarIntBytes(),n=e=>new i().writeInt32(e)},48946:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=e=>e.readInt32(),o=e=>{let t={partition:e.readInt32(),replicas:e.readUVarIntArray(n),addingReplicas:e.readUVarIntArray(n),removingReplicas:e.readUVarIntArray(n)};return e.readTaggedFields(),t},l=e=>{let t={name:e.readUVarIntString(),partitions:e.readUVarIntArray(o)};return e.readTaggedFields(),t},c=async e=>{let t=new i(e);t.readTaggedFields();let r=t.readInt32(),s=t.readInt16();return t.readUVarIntString(),{throttleTime:r,errorCode:s,topics:t.readUVarIntArray(l)}},d=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decode:c,parse:d}},20987:(e,t,r)=>{let i={0:({topics:e})=>{let t=r(55409),i=r(25541);return{request:t({topics:e}),response:i}},1:({topics:e})=>{let t=r(74197),i=r(28953);return{request:t({topics:e}),response:i}},2:({topics:e})=>{let t=r(32699),i=r(66486);return{request:t({topics:e}),response:i}},3:({topics:e})=>{let t=r(34649),i=r(90479);return{request:t({topics:e}),response:i}},4:({topics:e,allowAutoTopicCreation:t})=>{let i=r(4301),s=r(25079);return{request:i({topics:e,allowAutoTopicCreation:t}),response:s}},5:({topics:e,allowAutoTopicCreation:t})=>{let i=r(19248),s=r(195);return{request:i({topics:e,allowAutoTopicCreation:t}),response:s}},6:({topics:e,allowAutoTopicCreation:t})=>{let i=r(20002),s=r(99114);return{request:i({topics:e,allowAutoTopicCreation:t}),response:s}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},55409:(e,t,r)=>{let i=r(36880),{Metadata:s}=r(80146);e.exports=({topics:e})=>({apiKey:s,apiVersion:0,apiName:"Metadata",encode:async()=>new i().writeArray(e)})},25541:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=e=>({nodeId:e.readInt32(),host:e.readString(),port:e.readInt32()}),o=e=>({topicErrorCode:e.readInt16(),topic:e.readString(),partitionMetadata:e.readArray(l)}),l=e=>({partitionErrorCode:e.readInt16(),partitionId:e.readInt32(),leader:e.readInt32(),replicas:e.readArray(e=>e.readInt32()),isr:e.readArray(e=>e.readInt32())}),c=async e=>{let t=new i(e);return{brokers:t.readArray(n),topicMetadata:t.readArray(o)}},d=async e=>{let t=e.topicMetadata.filter(e=>s(e.topicErrorCode));if(t.length>0){let{topicErrorCode:e}=t[0];throw a(e)}let r=e.topicMetadata.flatMap(e=>e.partitionMetadata.filter(e=>s(e.partitionErrorCode)));if(r.length>0){let{partitionErrorCode:e}=r[0];throw a(e)}return e};e.exports={decode:c,parse:d}},74197:(e,t,r)=>{let i=r(36880),{Metadata:s}=r(80146);e.exports=({topics:e})=>({apiKey:s,apiVersion:1,apiName:"Metadata",encode:async()=>new i().writeNullableArray(e)})},28953:(e,t,r)=>{let i=r(10243),{parse:s}=r(25541),a=e=>({nodeId:e.readInt32(),host:e.readString(),port:e.readInt32(),rack:e.readString()}),n=e=>({topicErrorCode:e.readInt16(),topic:e.readString(),isInternal:e.readBoolean(),partitionMetadata:e.readArray(o)}),o=e=>({partitionErrorCode:e.readInt16(),partitionId:e.readInt32(),leader:e.readInt32(),replicas:e.readArray(e=>e.readInt32()),isr:e.readArray(e=>e.readInt32())}),l=async e=>{let t=new i(e);return{brokers:t.readArray(a),controllerId:t.readInt32(),topicMetadata:t.readArray(n)}};e.exports={decode:l,parse:s}},32699:(e,t,r)=>{let i=r(74197);e.exports=({topics:e})=>Object.assign(i({topics:e}),{apiVersion:2})},66486:(e,t,r)=>{let i=r(10243),{parse:s}=r(25541),a=e=>({nodeId:e.readInt32(),host:e.readString(),port:e.readInt32(),rack:e.readString()}),n=e=>({topicErrorCode:e.readInt16(),topic:e.readString(),isInternal:e.readBoolean(),partitionMetadata:e.readArray(o)}),o=e=>({partitionErrorCode:e.readInt16(),partitionId:e.readInt32(),leader:e.readInt32(),replicas:e.readArray(e=>e.readInt32()),isr:e.readArray(e=>e.readInt32())}),l=async e=>{let t=new i(e);return{brokers:t.readArray(a),clusterId:t.readString(),controllerId:t.readInt32(),topicMetadata:t.readArray(n)}};e.exports={decode:l,parse:s}},34649:(e,t,r)=>{let i=r(74197);e.exports=({topics:e})=>Object.assign(i({topics:e}),{apiVersion:3})},90479:(e,t,r)=>{let i=r(10243),{parse:s}=r(25541),a=e=>({nodeId:e.readInt32(),host:e.readString(),port:e.readInt32(),rack:e.readString()}),n=e=>({topicErrorCode:e.readInt16(),topic:e.readString(),isInternal:e.readBoolean(),partitionMetadata:e.readArray(o)}),o=e=>({partitionErrorCode:e.readInt16(),partitionId:e.readInt32(),leader:e.readInt32(),replicas:e.readArray(e=>e.readInt32()),isr:e.readArray(e=>e.readInt32())}),l=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),brokers:t.readArray(a),clusterId:t.readString(),controllerId:t.readInt32(),topicMetadata:t.readArray(n)}};e.exports={decode:l,parse:s}},4301:(e,t,r)=>{let i=r(36880),{Metadata:s}=r(80146);e.exports=({topics:e,allowAutoTopicCreation:t=!0})=>({apiKey:s,apiVersion:4,apiName:"Metadata",encode:async()=>new i().writeNullableArray(e).writeBoolean(t)})},25079:(e,t,r)=>{let{parse:i,decode:s}=r(90479);e.exports={parse:i,decode:s}},19248:(e,t,r)=>{let i=r(4301);e.exports=({topics:e,allowAutoTopicCreation:t=!0})=>Object.assign(i({topics:e,allowAutoTopicCreation:t}),{apiVersion:5})},195:(e,t,r)=>{let i=r(10243),{parse:s}=r(25541),a=e=>({nodeId:e.readInt32(),host:e.readString(),port:e.readInt32(),rack:e.readString()}),n=e=>({topicErrorCode:e.readInt16(),topic:e.readString(),isInternal:e.readBoolean(),partitionMetadata:e.readArray(o)}),o=e=>({partitionErrorCode:e.readInt16(),partitionId:e.readInt32(),leader:e.readInt32(),replicas:e.readArray(e=>e.readInt32()),isr:e.readArray(e=>e.readInt32()),offlineReplicas:e.readArray(e=>e.readInt32())}),l=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),brokers:t.readArray(a),clusterId:t.readString(),controllerId:t.readInt32(),topicMetadata:t.readArray(n)}};e.exports={decode:l,parse:s}},20002:(e,t,r)=>{let i=r(19248);e.exports=({topics:e,allowAutoTopicCreation:t=!0})=>Object.assign(i({topics:e,allowAutoTopicCreation:t}),{apiVersion:6})},99114:(e,t,r)=>{let{parse:i,decode:s}=r(195),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},30076:(e,t,r)=>{let i=-1,s={0:({groupId:e,topics:t})=>{let i=r(21134),s=r(19401);return{request:i({groupId:e,topics:t}),response:s}},1:({groupId:e,groupGenerationId:t,memberId:i,topics:s})=>{let a=r(67966),n=r(30617);return{request:a({groupId:e,groupGenerationId:t,memberId:i,topics:s}),response:n}},2:({groupId:e,groupGenerationId:t,memberId:s,retentionTime:a=i,topics:n})=>{let o=r(63421),l=r(88092);return{request:o({groupId:e,groupGenerationId:t,memberId:s,retentionTime:a,topics:n}),response:l}},3:({groupId:e,groupGenerationId:t,memberId:s,retentionTime:a=i,topics:n})=>{let o=r(46113),l=r(16613);return{request:o({groupId:e,groupGenerationId:t,memberId:s,retentionTime:a,topics:n}),response:l}},4:({groupId:e,groupGenerationId:t,memberId:s,retentionTime:a=i,topics:n})=>{let o=r(3411),l=r(20091);return{request:o({groupId:e,groupGenerationId:t,memberId:s,retentionTime:a,topics:n}),response:l}},5:({groupId:e,groupGenerationId:t,memberId:i,topics:s})=>{let a=r(25043),n=r(36808);return{request:a({groupId:e,groupGenerationId:t,memberId:i,topics:s}),response:n}}};e.exports={versions:Object.keys(s),protocol:({version:e})=>s[e]}},21134:(e,t,r)=>{let i=r(36880),{OffsetCommit:s}=r(80146);e.exports=({groupId:e,topics:t})=>({apiKey:s,apiVersion:0,apiName:"OffsetCommit",encode:async()=>new i().writeString(e).writeArray(t.map(a))});let a=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(n)),n=({partition:e,offset:t,metadata:r=null})=>new i().writeInt32(e).writeInt64(t).writeString(r)},19401:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=async e=>({responses:new i(e).readArray(o)}),o=e=>({topic:e.readString(),partitions:e.readArray(l)}),l=e=>({partition:e.readInt32(),errorCode:e.readInt16()}),c=async e=>{let t=e.responses.flatMap(e=>e.partitions.filter(e=>s(e.errorCode)))[0];if(t)throw a(t.errorCode);return e};e.exports={decode:n,parse:c}},67966:(e,t,r)=>{let i=r(36880),{OffsetCommit:s}=r(80146);e.exports=({groupId:e,groupGenerationId:t,memberId:r,topics:n})=>({apiKey:s,apiVersion:1,apiName:"OffsetCommit",encode:async()=>new i().writeString(e).writeInt32(t).writeString(r).writeArray(n.map(a))});let a=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(n)),n=({partition:e,offset:t,timestamp:r=Date.now(),metadata:s=null})=>new i().writeInt32(e).writeInt64(t).writeInt64(r).writeString(s)},30617:(e,t,r)=>{let{parse:i,decode:s}=r(19401);e.exports={decode:s,parse:i}},63421:(e,t,r)=>{let i=r(36880),{OffsetCommit:s}=r(80146);e.exports=({groupId:e,groupGenerationId:t,memberId:r,retentionTime:n,topics:o})=>({apiKey:s,apiVersion:2,apiName:"OffsetCommit",encode:async()=>new i().writeString(e).writeInt32(t).writeString(r).writeInt64(n).writeArray(o.map(a))});let a=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(n)),n=({partition:e,offset:t,metadata:r=null})=>new i().writeInt32(e).writeInt64(t).writeString(r)},88092:(e,t,r)=>{let{parse:i,decode:s}=r(19401);e.exports={decode:s,parse:i}},46113:(e,t,r)=>{let i=r(63421);e.exports=({groupId:e,groupGenerationId:t,memberId:r,retentionTime:s,topics:a})=>Object.assign(i({groupId:e,groupGenerationId:t,memberId:r,retentionTime:s,topics:a}),{apiVersion:3})},16613:(e,t,r)=>{let i=r(10243),{parse:s}=r(19401),a=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),responses:t.readArray(n)}},n=e=>({topic:e.readString(),partitions:e.readArray(o)}),o=e=>({partition:e.readInt32(),errorCode:e.readInt16()});e.exports={decode:a,parse:s}},3411:(e,t,r)=>{let i=r(46113);e.exports=({groupId:e,groupGenerationId:t,memberId:r,retentionTime:s,topics:a})=>Object.assign(i({groupId:e,groupGenerationId:t,memberId:r,retentionTime:s,topics:a}),{apiVersion:4})},20091:(e,t,r)=>{let{parse:i,decode:s}=r(16613),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},25043:(e,t,r)=>{let i=r(36880),{OffsetCommit:s}=r(80146);e.exports=({groupId:e,groupGenerationId:t,memberId:r,topics:n})=>({apiKey:s,apiVersion:5,apiName:"OffsetCommit",encode:async()=>new i().writeString(e).writeInt32(t).writeString(r).writeArray(n.map(a))});let a=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(n)),n=({partition:e,offset:t,metadata:r=null})=>new i().writeInt32(e).writeInt64(t).writeString(r)},36808:(e,t,r)=>{let{parse:i,decode:s}=r(20091);e.exports={decode:s,parse:i}},85630:(e,t,r)=>{let i={1:({groupId:e,topics:t})=>{let i=r(65622),s=r(83483);return{request:i({groupId:e,topics:t}),response:s}},2:({groupId:e,topics:t})=>{let i=r(9828),s=r(56130);return{request:i({groupId:e,topics:t}),response:s}},3:({groupId:e,topics:t})=>{let i=r(91530),s=r(74214);return{request:i({groupId:e,topics:t}),response:s}},4:({groupId:e,topics:t})=>{let i=r(70362),s=r(95058);return{request:i({groupId:e,topics:t}),response:s}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},65622:(e,t,r)=>{let i=r(36880),{OffsetFetch:s}=r(80146);e.exports=({groupId:e,topics:t})=>({apiKey:s,apiVersion:1,apiName:"OffsetFetch",encode:async()=>new i().writeString(e).writeArray(t.map(a))});let a=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(n)),n=({partition:e})=>new i().writeInt32(e)},83483:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=async e=>({responses:new i(e).readArray(o)}),o=e=>({topic:e.readString(),partitions:e.readArray(l)}),l=e=>({partition:e.readInt32(),offset:e.readInt64().toString(),metadata:e.readString(),errorCode:e.readInt16()}),c=async e=>{let t=e.responses.flatMap(e=>e.partitions.filter(e=>s(e.errorCode)))[0];if(t)throw a(t.errorCode);return e};e.exports={decode:n,parse:c}},9828:(e,t,r)=>{let i=r(65622);e.exports=({groupId:e,topics:t})=>Object.assign(i({groupId:e,topics:t}),{apiVersion:2})},56130:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=async e=>{let t=new i(e);return{responses:t.readArray(o),errorCode:t.readInt16()}},o=e=>({topic:e.readString(),partitions:e.readArray(l)}),l=e=>({partition:e.readInt32(),offset:e.readInt64().toString(),metadata:e.readString(),errorCode:e.readInt16()}),c=async e=>{if(s(e.errorCode))throw a(e.errorCode);let t=e.responses.flatMap(e=>e.partitions.filter(e=>s(e.errorCode)))[0];if(t)throw a(t.errorCode);return e};e.exports={decode:n,parse:c}},91530:(e,t,r)=>{let i=r(36880),{OffsetFetch:s}=r(80146);e.exports=({groupId:e,topics:t})=>({apiKey:s,apiVersion:3,apiName:"OffsetFetch",encode:async()=>new i().writeString(e).writeNullableArray(t.map(a))});let a=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(n)),n=({partition:e})=>new i().writeInt32(e)},74214:(e,t,r)=>{let i=r(10243),{parse:s}=r(56130),a=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),responses:t.readArray(n),errorCode:t.readInt16()}},n=e=>({topic:e.readString(),partitions:e.readArray(o)}),o=e=>({partition:e.readInt32(),offset:e.readInt64().toString(),metadata:e.readString(),errorCode:e.readInt16()});e.exports={decode:a,parse:s}},70362:(e,t,r)=>{let i=r(91530);e.exports=({groupId:e,topics:t})=>Object.assign(i({groupId:e,topics:t}),{apiVersion:4})},95058:(e,t,r)=>{let{parse:i,decode:s}=r(74214),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},78209:(e,t,r)=>{let i={0:({acks:e,timeout:t,topicData:i})=>{let s=r(51969),a=r(39975);return{request:s({acks:e,timeout:t,topicData:i}),response:a}},1:({acks:e,timeout:t,topicData:i})=>{let s=r(2396),a=r(33693);return{request:s({acks:e,timeout:t,topicData:i}),response:a}},2:({acks:e,timeout:t,topicData:i,compression:s})=>{let a=r(60953),n=r(714);return{request:a({acks:e,timeout:t,compression:s,topicData:i}),response:n}},3:({acks:e,timeout:t,compression:i,topicData:s,transactionalId:a,producerId:n,producerEpoch:o})=>{let l=r(85911),c=r(95708);return{request:l({acks:e,timeout:t,compression:i,topicData:s,transactionalId:a,producerId:n,producerEpoch:o}),response:c}},4:({acks:e,timeout:t,compression:i,topicData:s,transactionalId:a,producerId:n,producerEpoch:o})=>{let l=r(96155),c=r(18278);return{request:l({acks:e,timeout:t,compression:i,topicData:s,transactionalId:a,producerId:n,producerEpoch:o}),response:c}},5:({acks:e,timeout:t,compression:i,topicData:s,transactionalId:a,producerId:n,producerEpoch:o})=>{let l=r(22374),c=r(40446);return{request:l({acks:e,timeout:t,compression:i,topicData:s,transactionalId:a,producerId:n,producerEpoch:o}),response:c}},6:({acks:e,timeout:t,compression:i,topicData:s,transactionalId:a,producerId:n,producerEpoch:o})=>{let l=r(18398),c=r(62347);return{request:l({acks:e,timeout:t,compression:i,topicData:s,transactionalId:a,producerId:n,producerEpoch:o}),response:c}},7:({acks:e,timeout:t,compression:i,topicData:s,transactionalId:a,producerId:n,producerEpoch:o})=>{let l=r(28645),c=r(75718);return{request:l({acks:e,timeout:t,compression:i,topicData:s,transactionalId:a,producerId:n,producerEpoch:o}),response:c}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},51969:(e,t,r)=>{let i=r(36880),{Produce:s}=r(80146),a=r(51560);e.exports=({acks:e,timeout:t,topicData:r})=>({apiKey:s,apiVersion:0,apiName:"Produce",expectResponse:()=>0!==e,encode:async()=>new i().writeInt16(e).writeInt32(t).writeArray(r.map(n))});let n=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(o)),o=({partition:e,messages:t})=>{let r=a({messageVersion:0,entries:t});return new i().writeInt32(e).writeInt32(r.size()).writeEncoder(r)}},39975:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=e=>({partition:e.readInt32(),errorCode:e.readInt16(),offset:e.readInt64().toString()}),o=async e=>({topics:new i(e).readArray(e=>({topicName:e.readString(),partitions:e.readArray(n)}))}),l=async e=>{let t=e.topics.flatMap(e=>e.partitions.filter(e=>s(e.errorCode)));if(t.length>0){let{errorCode:e}=t[0];throw a(e)}return e};e.exports={decode:o,parse:l}},2396:(e,t,r)=>{let i=r(51969);e.exports=({acks:e,timeout:t,topicData:r})=>Object.assign(i({acks:e,timeout:t,topicData:r}),{apiVersion:1})},33693:(e,t,r)=>{let i=r(10243),{parse:s}=r(39975),a=e=>({partition:e.readInt32(),errorCode:e.readInt16(),offset:e.readInt64().toString()}),n=async e=>{let t=new i(e);return{topics:t.readArray(e=>({topicName:e.readString(),partitions:e.readArray(a)})),throttleTime:t.readInt32()}};e.exports={decode:n,parse:s}},60953:(e,t,r)=>{let i=r(36880),{Produce:s}=r(80146),a=r(51560),{Types:n,lookupCodec:o}=r(22863);e.exports=({acks:e,timeout:t,compression:r=n.None,topicData:a})=>({apiKey:s,apiVersion:2,apiName:"Produce",expectResponse:()=>0!==e,encode:async()=>{let s=l(r),n=[];for(let e of a)n.push(await s(e));return new i().writeInt16(e).writeInt32(t).writeArray(n)}});let l=e=>{let t=c(e);return async({topic:e,partitions:r})=>{let s=[];for(let e of r)s.push(await t(e));return new i().writeString(e).writeArray(s)}},c=e=>async({partition:t,messages:r})=>{let s=a({messageVersion:1,compression:e,entries:r});if(e===n.None)return new i().writeInt32(t).writeInt32(s.size()).writeEncoder(s);let l=r[0].timestamp||Date.now(),c=o(e),d=a({messageVersion:1,entries:[{compression:e,timestamp:l,value:await c.compress(s)}]});return new i().writeInt32(t).writeInt32(d.size()).writeEncoder(d)}},714:(e,t,r)=>{let i=r(10243),{parse:s}=r(39975),a=e=>({partition:e.readInt32(),errorCode:e.readInt16(),offset:e.readInt64().toString(),timestamp:e.readInt64().toString()}),n=async e=>{let t=new i(e);return{topics:t.readArray(e=>({topicName:e.readString(),partitions:e.readArray(a)})),throttleTime:t.readInt32()}};e.exports={decode:n,parse:s}},85911:(e,t,r)=>{let i=r(25481),s=r(36880),{Produce:a}=r(80146),{Types:n}=r(22863),o=r(54865),{RecordBatch:l}=r(45338);e.exports=({acks:e,timeout:t,transactionalId:r=null,producerId:o=i.fromInt(-1),producerEpoch:l=0,compression:d=n.None,topicData:u})=>({apiKey:a,apiVersion:3,apiName:"Produce",expectResponse:()=>0!==e,encode:async()=>{let i=c(d),a=[];for(let e of u)a.push(await i({...e,transactionalId:r,producerId:o,producerEpoch:l}));return new s().writeString(r).writeInt16(e).writeInt32(t).writeArray(a)}});let c=e=>async({topic:t,partitions:r,transactionalId:i,producerId:a,producerEpoch:n})=>{let o=d(e),l=[];for(let e of r)l.push(await o({...e,transactionalId:i,producerId:a,producerEpoch:n}));return new s().writeString(t).writeArray(l)},d=e=>async({partition:t,messages:r,transactionalId:i,firstSequence:a,producerId:n,producerEpoch:c})=>{let d=Date.now(),u=r.map(e=>e.timestamp).filter(e=>null!=e).sort(),h=0===u.length?[d]:u,p=h[0],f=h[h.length-1],m=r.map((e,t)=>o({...e,offsetDelta:t,timestampDelta:(e.timestamp||d)-p})),g=await l({compression:e,records:m,firstTimestamp:p,maxTimestamp:f,producerId:n,producerEpoch:c,firstSequence:a,transactional:!!i,lastOffsetDelta:m.length-1});return new s().writeInt32(t).writeInt32(g.size()).writeEncoder(g)}},95708:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=e=>({partition:e.readInt32(),errorCode:e.readInt16(),baseOffset:e.readInt64().toString(),logAppendTime:e.readInt64().toString()}),o=async e=>{let t=new i(e);return{topics:t.readArray(e=>({topicName:e.readString(),partitions:e.readArray(n)})),throttleTime:t.readInt32()}},l=async e=>{let t=e.topics.flatMap(e=>e.partitions.filter(e=>s(e.errorCode)));if(t.length>0){let{errorCode:e}=t[0];throw a(e)}return e};e.exports={decode:o,parse:l}},96155:(e,t,r)=>{let i=r(85911);e.exports=({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:a,compression:n,topicData:o})=>Object.assign(i({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:a,compression:n,topicData:o}),{apiVersion:4})},18278:(e,t,r)=>{let{decode:i,parse:s}=r(95708);e.exports={decode:i,parse:s}},22374:(e,t,r)=>{let i=r(85911);e.exports=({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:a,compression:n,topicData:o})=>Object.assign(i({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:a,compression:n,topicData:o}),{apiVersion:5})},40446:(e,t,r)=>{let i=r(10243),{parse:s}=r(95708),a=e=>({partition:e.readInt32(),errorCode:e.readInt16(),baseOffset:e.readInt64().toString(),logAppendTime:e.readInt64().toString(),logStartOffset:e.readInt64().toString()}),n=async e=>{let t=new i(e);return{topics:t.readArray(e=>({topicName:e.readString(),partitions:e.readArray(a)})),throttleTime:t.readInt32()}};e.exports={decode:n,parse:s}},18398:(e,t,r)=>{let i=r(22374);e.exports=({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:a,compression:n,topicData:o})=>Object.assign(i({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:a,compression:n,topicData:o}),{apiVersion:6})},62347:(e,t,r)=>{let{parse:i,decode:s}=r(40446),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},28645:(e,t,r)=>{let i=r(18398);e.exports=({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:a,compression:n,topicData:o})=>Object.assign(i({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:a,compression:n,topicData:o}),{apiVersion:7})},75718:(e,t,r)=>{let{decode:i,parse:s}=r(62347);e.exports={decode:i,parse:s}},97587:(e,t,r)=>{let i={0:({authBytes:e})=>{let t=r(89989),i=r(17738);return{request:t({authBytes:e}),response:i}},1:({authBytes:e})=>{let t=r(76573),i=r(28938);return{request:t({authBytes:e}),response:i}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},89989:(e,t,r)=>{let i=r(36880),{SaslAuthenticate:s}=r(80146);e.exports=({authBytes:e})=>({apiKey:s,apiVersion:0,apiName:"SaslAuthenticate",encode:async()=>new i().writeBuffer(e)})},17738:(e,t,r)=>{let i=r(10243),s=r(36880),{failure:a,createErrorFromCode:n,failIfVersionNotSupported:o,errorCodes:l}=r(15644),{KafkaJSProtocolError:c}=r(15847),d=l.find(e=>58===e.code),u=async e=>{let t=new i(e),r=t.readInt16();return o(r),{errorCode:r,errorMessage:t.readString(),authBytes:new s().writeBytes(t.readBytes()).buffer}},h=async e=>{if(58===e.errorCode&&e.errorMessage)throw new c({...d,message:e.errorMessage});if(a(e.errorCode))throw n(e.errorCode);return e};e.exports={decode:u,parse:h}},76573:(e,t,r)=>{let i=r(89989);e.exports=({authBytes:e})=>Object.assign(i({authBytes:e}),{apiVersion:1})},28938:(e,t,r)=>{let i=r(10243),s=r(36880),{parse:a}=r(17738),{failIfVersionNotSupported:n}=r(15644),o=async e=>{let t=new i(e),r=t.readInt16();return n(r),{errorCode:r,errorMessage:t.readString(),authBytes:new s().writeBytes(t.readBytes()).buffer,sessionLifetimeMs:t.readInt64().toString()}};e.exports={decode:o,parse:a}},19293:(e,t,r)=>{let i={0:({mechanism:e})=>{let t=r(20906),i=r(58351);return{request:t({mechanism:e}),response:i}},1:({mechanism:e})=>{let t=r(9008),i=r(36037);return{request:t({mechanism:e}),response:i}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},20906:(e,t,r)=>{let i=r(36880),{SaslHandshake:s}=r(80146);e.exports=({mechanism:e})=>({apiKey:s,apiVersion:0,apiName:"SaslHandshake",encode:async()=>new i().writeString(e)})},58351:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a,failIfVersionNotSupported:n}=r(15644),o=async e=>{let t=new i(e),r=t.readInt16();return n(r),{errorCode:r,enabledMechanisms:t.readArray(e=>e.readString())}},l=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decode:o,parse:l}},9008:(e,t,r)=>{let i=r(20906);e.exports=({mechanism:e})=>({...i({mechanism:e}),apiVersion:1})},36037:(e,t,r)=>{let{decode:i,parse:s}=r(58351);e.exports={decode:i,parse:s}},67121:(e,t,r)=>{let i={0:({groupId:e,generationId:t,memberId:i,groupAssignment:s})=>{let a=r(52556),n=r(38960);return{request:a({groupId:e,generationId:t,memberId:i,groupAssignment:s}),response:n}},1:({groupId:e,generationId:t,memberId:i,groupAssignment:s})=>{let a=r(85383),n=r(51130);return{request:a({groupId:e,generationId:t,memberId:i,groupAssignment:s}),response:n}},2:({groupId:e,generationId:t,memberId:i,groupAssignment:s})=>{let a=r(51918),n=r(98782);return{request:a({groupId:e,generationId:t,memberId:i,groupAssignment:s}),response:n}},3:({groupId:e,generationId:t,memberId:i,groupInstanceId:s,groupAssignment:a})=>{let n=r(1230),o=r(75307);return{request:n({groupId:e,generationId:t,memberId:i,groupInstanceId:s,groupAssignment:a}),response:o}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},52556:(e,t,r)=>{let i=r(36880),{SyncGroup:s}=r(80146);e.exports=({groupId:e,generationId:t,memberId:r,groupAssignment:n})=>({apiKey:s,apiVersion:0,apiName:"SyncGroup",encode:async()=>new i().writeString(e).writeInt32(t).writeString(r).writeArray(n.map(a))});let a=({memberId:e,memberAssignment:t})=>new i().writeString(e).writeBytes(t)},38960:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a,failIfVersionNotSupported:n}=r(15644),o=async e=>{let t=new i(e),r=t.readInt16();return n(r),{errorCode:r,memberAssignment:t.readBytes()}},l=async e=>{if(s(e.errorCode))throw a(e.errorCode);return e};e.exports={decode:o,parse:l}},85383:(e,t,r)=>{let i=r(52556);e.exports=({groupId:e,generationId:t,memberId:r,groupAssignment:s})=>Object.assign(i({groupId:e,generationId:t,memberId:r,groupAssignment:s}),{apiVersion:1})},51130:(e,t,r)=>{let i=r(10243),{failIfVersionNotSupported:s}=r(15644),{parse:a}=r(38960),n=async e=>{let t=new i(e),r=t.readInt32(),a=t.readInt16();return s(a),{throttleTime:r,errorCode:a,memberAssignment:t.readBytes()}};e.exports={decode:n,parse:a}},51918:(e,t,r)=>{let i=r(85383);e.exports=({groupId:e,generationId:t,memberId:r,groupAssignment:s})=>Object.assign(i({groupId:e,generationId:t,memberId:r,groupAssignment:s}),{apiVersion:2})},98782:(e,t,r)=>{let{parse:i,decode:s}=r(51130),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},1230:(e,t,r)=>{let i=r(36880),{SyncGroup:s}=r(80146);e.exports=({groupId:e,generationId:t,memberId:r,groupInstanceId:n=null,groupAssignment:o})=>({apiKey:s,apiVersion:3,apiName:"SyncGroup",encode:async()=>new i().writeString(e).writeInt32(t).writeString(r).writeString(n).writeArray(o.map(a))});let a=({memberId:e,memberAssignment:t})=>new i().writeString(e).writeBytes(t)},75307:(e,t,r)=>{let{decode:i,parse:s}=r(98782);e.exports={decode:i,parse:s}},91745:(e,t,r)=>{let i={0:({transactionalId:e,groupId:t,producerId:i,producerEpoch:s,topics:a})=>{let n=r(73317),o=r(92033);return{request:n({transactionalId:e,groupId:t,producerId:i,producerEpoch:s,topics:a}),response:o}},1:({transactionalId:e,groupId:t,producerId:i,producerEpoch:s,topics:a})=>{let n=r(38802),o=r(32526);return{request:n({transactionalId:e,groupId:t,producerId:i,producerEpoch:s,topics:a}),response:o}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},73317:(e,t,r)=>{let i=r(36880),{TxnOffsetCommit:s}=r(80146);e.exports=({transactionalId:e,groupId:t,producerId:r,producerEpoch:n,topics:o})=>({apiKey:s,apiVersion:0,apiName:"TxnOffsetCommit",encode:async()=>new i().writeString(e).writeString(t).writeInt64(r).writeInt16(n).writeArray(o.map(a))});let a=({topic:e,partitions:t})=>new i().writeString(e).writeArray(t.map(n)),n=({partition:e,offset:t,metadata:r})=>new i().writeInt32(e).writeInt64(t).writeString(r)},92033:(e,t,r)=>{let i=r(10243),{failure:s,createErrorFromCode:a}=r(15644),n=async e=>{let t=new i(e);return{throttleTime:t.readInt32(),topics:await t.readArrayAsync(o)}},o=async e=>({topic:e.readString(),partitions:await e.readArrayAsync(l)}),l=e=>({partition:e.readInt32(),errorCode:e.readInt16()}),c=async e=>{let t=e.topics.map(({partitions:e})=>({partitionsWithErrors:e.filter(({errorCode:e})=>s(e))})).filter(({partitionsWithErrors:e})=>e.length);if(t.length>0)throw a(t[0].partitionsWithErrors[0].errorCode);return e};e.exports={decode:n,parse:c}},38802:(e,t,r)=>{let i=r(73317);e.exports=({transactionalId:e,groupId:t,producerId:r,producerEpoch:s,topics:a})=>Object.assign(i({transactionalId:e,groupId:t,producerId:r,producerEpoch:s,topics:a}),{apiVersion:1})},32526:(e,t,r)=>{let{parse:i,decode:s}=r(92033),a=async e=>{let t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}};e.exports={decode:a,parse:i}},76482:e=>{e.exports={UNKNOWN:0,ANY:1,MATCH:2,LITERAL:3,PREFIXED:4}},74396:(e,t,r)=>{e.exports={request:r(49481),response:r(5993)}},49481:(e,t,r)=>{let i=r(36880);e.exports=({authorizationIdentity:e,accessKeyId:t,secretAccessKey:r,sessionToken:s=""})=>({encode:async()=>new i().writeBytes([e,t,r,s].join("\0")).buffer})},5993:e=>{e.exports={decode:async()=>!0,parse:async()=>!0}},45564:(e,t,r)=>{e.exports={request:r(48166),response:r(38848)}},48166:(e,t,r)=>{let i=r(36880);e.exports=async({authorizationIdentity:e=null},t)=>{let r=null==e?"":`"a=${e}`,s=function(e){let t="";if(null==e)return t;let r="";for(let i in e)t+=`${r}${i}=${e[i]}`,r="\x01";return t}(t.extensions);s.length>0&&(s=`\u0001${s}`);let a=`n,${r},\u0001auth=Bearer ${t.value}${s}\u0001\u0001`;return{encode:async()=>new i().writeBytes(Buffer.from(a)).buffer}}},38848:e=>{e.exports={decode:async()=>!0,parse:async()=>!0}},77071:(e,t,r)=>{e.exports={request:r(55807),response:r(91126)}},55807:(e,t,r)=>{let i=r(36880);e.exports=({authorizationIdentity:e=null,username:t,password:r})=>({encode:async()=>new i().writeBytes([e,t,r].join("\0")).buffer})},91126:e=>{e.exports={decode:async()=>!0,parse:async()=>!0}},64035:(e,t,r)=>{let i=r(36880);e.exports=({finalMessage:e})=>({encode:async()=>new i().writeBytes(e).buffer})},11604:(e,t,r)=>{e.exports=r(77748)},81611:(e,t,r)=>{let i=r(36880);e.exports=({clientFirstMessage:e})=>({encode:async()=>new i().writeBytes(e).buffer})},77748:(e,t,r)=>{let i=r(10243),s=/^([rsiev])=(.*)$/;e.exports={decode:async e=>new i(e).readBytes(),parse:async e=>{let t=e.toString().split(",").map(e=>{let[t,r,i]=e.match(s);return[r,i]}).reduce((e,t)=>({...e,[t[0]]:t[1]}),{});return{original:e.toString(),...t}}}},69365:(e,t,r)=>{e.exports={firstMessage:{request:r(81611),response:r(77748)},finalMessage:{request:r(64035),response:r(11604)}}},81748:e=>{e.exports={NO_TIMESTAMP:-1,CREATE_TIME:0,LOG_APPEND_TIME:1}},72149:e=>{e.exports={maxRetryTime:3e4,initialRetryTime:300,factor:.2,multiplier:2,retries:5}},19070:e=>{e.exports={maxRetryTime:1e3,initialRetryTime:50,factor:.02,multiplier:1.5,retries:15}},81620:(e,t,r)=>{let{KafkaJSNumberOfRetriesExceeded:i,KafkaJSNonRetriableError:s}=r(15847),a=r(72149),n=(e,t)=>Math.random()*(t-e)+e,o=(e,t)=>{let r=e*t;return Math.ceil(n(t-r,t+r))},l=["RangeError","ReferenceError","SyntaxError","TypeError"],c=e=>l.includes(e.name),d=e=>(e.retriable||!1!==e.retriable)&&!c(e),u=(e,t,r,a)=>{let n=!1,{factor:l,multiplier:c,maxRetryTime:u,retries:h}=e,p=e=>{n=!0,r(e||Error("Aborted"))},f=e=>Math.min(o(l,e)*c,u),m=(e,o=0)=>{if(n)return;let l=f(e),c=o<h,u=()=>{setTimeout(()=>m(l,o+1),e)};a(p,o,e).then(t).catch(t=>{d(t)?c?u():r(new i(t,{retryCount:o,retryTime:e,cause:t.cause||t})):r(new s(t,{cause:t.cause||t}))})};return m};e.exports=(e={})=>t=>new Promise((r,i)=>{let s=Object.assign({},a,e);u(s,r,i,t)(o(s.factor,s.initialRetryTime))})},83874:e=>{e.exports=(e,t)=>{let r=[],i=e.length,s=0;for(;s<i;)-1===t.indexOf(e[s])&&r.push(e[s]),s+=1;return r}},14589:e=>{e.exports=async(e,t)=>{let r=new Map;for(let i of e){let e=await Promise.resolve(t(i));r.set(e,r.has(e)?[...r.get(e),i]:[i])}return r}},22003:(e,t,r)=>{let{format:i}=r(21764),{KafkaJSLockTimeout:s}=r(15847),a={LOCKED:Symbol("private:Lock:locked"),TIMEOUT:Symbol("private:Lock:timeout"),WAITING:Symbol("private:Lock:waiting"),TIMEOUT_ERROR_MESSAGE:Symbol("private:Lock:timeoutErrorMessage")};e.exports=class{constructor({timeout:e,description:t=null}={}){if("number"!=typeof e)throw TypeError(`'timeout' is not a number, received '${typeof e}'`);this[a.LOCKED]=!1,this[a.TIMEOUT]=e,this[a.WAITING]=new Set,this[a.TIMEOUT_ERROR_MESSAGE]=()=>{let e=i("Timeout while acquiring lock (%d waiting locks)",this[a.WAITING].size);return t?`${e}: "${t}"`:e}}async acquire(){return new Promise((e,t)=>{if(!this[a.LOCKED])return this[a.LOCKED]=!0,e();let r=null,i=async()=>{if(!this[a.LOCKED])return this[a.LOCKED]=!0,clearTimeout(r),this[a.WAITING].delete(i),e()};this[a.WAITING].add(i),r=setTimeout(()=>{let e=new s(this[a.TIMEOUT_ERROR_MESSAGE]());this[a.WAITING].delete(i),t(e)},this[a.TIMEOUT])})}async release(){this[a.LOCKED]=!1;let e=this[a.WAITING].values().next().value;if(e)return e()}}},25481:e=>{class t{constructor(e){this.value=e}static isLong(e){return"bigint"==typeof e.value}static fromBits(e){return new t(BigInt(e))}static fromInt(e){return isNaN(e)?t.ZERO:new t(BigInt.asIntN(64,BigInt(e)))}static fromNumber(e){return isNaN(e)?t.ZERO:new t(BigInt(e))}static fromValue(e){return"number"==typeof e?this.fromNumber(e):"string"==typeof e?this.fromString(e):new t("bigint"==typeof e?e:this.isLong(e)?BigInt(e.value):BigInt(e))}static fromString(e){if(0===e.length)throw Error("empty string");return"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e?t.ZERO:new t(BigInt(e))}isZero(){return this.value===BigInt(0)}isNegative(){return this.value<BigInt(0)}toString(){return String(this.value)}toNumber(){return Number(this.value)}toInt(){return Number(BigInt.asIntN(32,this.value))}toJSON(){return this.toString()}shiftLeft(e){return new t(this.value<<BigInt(e))}shiftRight(e){return new t(this.value>>BigInt(e))}or(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.value|e.value)}xor(e){return t.isLong(e)||(e=t.fromValue(e)),new t(this.value^e.value)}and(e){return t.isLong(e)||(e=t.fromValue(e)),new t(this.value&e.value)}not(){return new t(~this.value)}shiftRightUnsigned(e){return new t(this.value>>BigInt.asUintN(64,BigInt(e)))}equals(e){return t.isLong(e)||(e=t.fromValue(e)),this.value===e.value}greaterThanOrEqual(e){return t.isLong(e)||(e=t.fromValue(e)),this.value>=e.value}gte(e){return this.greaterThanOrEqual(e)}notEquals(e){return t.isLong(e)||(e=t.fromValue(e)),!this.equals(e)}add(e){return t.isLong(e)||(e=t.fromValue(e)),new t(this.value+e.value)}subtract(e){return t.isLong(e)||(e=t.fromValue(e)),this.add(e.negate())}multiply(e){return this.isZero()?t.ZERO:(t.isLong(e)||(e=t.fromValue(e)),new t(this.value*e.value))}divide(e){if(t.isLong(e)||(e=t.fromValue(e)),e.isZero())throw Error("division by zero");return new t(this.value/e.value)}compare(e){return(t.isLong(e)||(e=t.fromValue(e)),this.value===e.value)?0:this.value>e.value?1:e.value>this.value?-1:void 0}lessThan(e){return t.isLong(e)||(e=t.fromValue(e)),this.value<e.value}negate(){return this.equals(t.MIN_VALUE)?t.MIN_VALUE:this.not().add(t.ONE)}getHighBits(){return Number(BigInt.asIntN(32,this.value>>BigInt(32)))}getLowBits(){return Number(BigInt.asIntN(32,this.value))}}t.MIN_VALUE=new t(BigInt("-9223372036854775808")),t.MAX_VALUE=new t(BigInt("9223372036854775807")),t.ZERO=t.fromInt(0),t.ONE=t.fromInt(1),e.exports=t},60052:e=>{e.exports=e=>{let t=!1;return(...r)=>{if(!t)return t=!0,e(...r)}}},44228:e=>{e.exports=(e,t=e=>e)=>Array(e).fill(0).map((e,r)=>t(r))},55416:e=>{e.exports=e=>{let t=null;return(...r)=>(null==t&&(t=e(...r).finally(()=>t=null)),t)}},96497:e=>{e.exports=e=>{if(!Array.isArray(e))throw TypeError("'array' is not an array");if(e.length<2)return e;let t=e.slice();for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1)),i=t[e];t[e]=t[r],t[r]=i}return t}},86984:e=>{e.exports=e=>new Promise(t=>{setTimeout(t,e)})},6388:e=>{let{keys:t}=Object;e.exports=e=>t(e).reduce((t,r)=>({...t,[e[r]]:r}),{})},50913:(e,t,r)=>{let i=r(86984),{KafkaJSTimeout:s}=r(15847);e.exports=(e,{delay:t=50,maxWait:r=1e4,timeoutMessage:a="Timeout",ignoreTimeout:n=!1}={})=>{let o;let l=0,c=!1,d=async(r,s)=>{if(l+=t,!c){await i(t);try{let t=await e(l);if(t)return c=!0,clearTimeout(o),r(t);d(r,s)}catch(e){c=!0,clearTimeout(o),s(e)}}};return new Promise((e,t)=>{d(e,t),n||(o=setTimeout(()=>{if(!c)return c=!0,t(new s(a))},r))})}},19681:e=>{let t=e=>t=>t.charAt(0)===e?t.substring(1):t,r=t("/"),i=t("#");e.exports=(e,t)=>`https://kafka.js.org/${r(e)}${t?"#"+i(t):""}`},25828:e=>{"use strict";e.exports=JSON.parse('{"name":"kafkajs","version":"2.2.4","description":"A modern Apache Kafka client for node.js","author":"Tulio Ornelas <ornelas.tulio@gmail.com>","main":"index.js","types":"types/index.d.ts","license":"MIT","keywords":["kafka","sasl","scram"],"engines":{"node":">=14.0.0"},"repository":{"type":"git","url":"https://github.com/tulios/kafkajs.git"},"bugs":{"url":"https://github.com/tulios/kafkajs/issues"},"homepage":"https://kafka.js.org","scripts":{"jest":"export KAFKA_VERSION=${KAFKA_VERSION:=\'2.4\'} && NODE_ENV=test echo \\"KAFKA_VERSION: ${KAFKA_VERSION}\\" && KAFKAJS_DEBUG_PROTOCOL_BUFFERS=1 jest","test:local":"yarn jest --detectOpenHandles","test:debug":"NODE_ENV=test KAFKAJS_DEBUG_PROTOCOL_BUFFERS=1 node --inspect-brk $(yarn bin 2>/dev/null)/jest --detectOpenHandles --runInBand --watch","test:local:watch":"yarn test:local --watch","test":"yarn lint && JEST_JUNIT_OUTPUT_NAME=test-report.xml ./scripts/testWithKafka.sh \'yarn jest --ci --maxWorkers=4 --no-watchman --forceExit\'","lint":"find . -path ./node_modules -prune -o -path ./coverage -prune -o -path ./website -prune -o -name \'*.js\' -print0 | xargs -0 eslint","format":"find . -path ./node_modules -prune -o -path ./coverage -prune -o -path ./website -prune -o -name \'*.js\' -print0 | xargs -0 prettier --write","precommit":"lint-staged","test:group:broker":"yarn jest --forceExit --testPathPattern \'src/broker/.*\'","test:group:admin":"yarn jest --forceExit --testPathPattern \'src/admin/.*\'","test:group:producer":"yarn jest --forceExit --testPathPattern \'src/producer/.*\'","test:group:consumer":"yarn jest --forceExit --testPathPattern \'src/consumer/.*.spec.js\'","test:group:others":"yarn jest --forceExit --testPathPattern \'src/(?!(broker|admin|producer|consumer)/).*\'","test:group:oauthbearer":"OAUTHBEARER_ENABLED=1 yarn jest --forceExit src/producer/index.spec.js src/broker/__tests__/connect.spec.js src/consumer/__tests__/connection.spec.js src/broker/__tests__/disconnect.spec.js src/admin/__tests__/connection.spec.js src/broker/__tests__/reauthenticate.spec.js","test:group:broker:ci":"JEST_JUNIT_OUTPUT_NAME=test-report.xml ./scripts/testWithKafka.sh \\"yarn test:group:broker --ci --maxWorkers=4 --no-watchman\\"","test:group:admin:ci":"JEST_JUNIT_OUTPUT_NAME=test-report.xml ./scripts/testWithKafka.sh \\"yarn test:group:admin --ci --maxWorkers=4 --no-watchman\\"","test:group:producer:ci":"JEST_JUNIT_OUTPUT_NAME=test-report.xml ./scripts/testWithKafka.sh \\"yarn test:group:producer --ci --maxWorkers=4 --no-watchman\\"","test:group:consumer:ci":"JEST_JUNIT_OUTPUT_NAME=test-report.xml ./scripts/testWithKafka.sh \\"yarn test:group:consumer --ci --maxWorkers=4 --no-watchman\\"","test:group:others:ci":"JEST_JUNIT_OUTPUT_NAME=test-report.xml ./scripts/testWithKafka.sh \\"yarn test:group:others --ci --maxWorkers=4 --no-watchman\\"","test:group:oauthbearer:ci":"JEST_JUNIT_OUTPUT_NAME=test-report.xml COMPOSE_FILE=\'docker-compose.2_4_oauthbearer.yml\' ./scripts/testWithKafka.sh \\"yarn test:group:oauthbearer --ci --maxWorkers=4 --no-watchman\\"","test:types":"tsc -p types/"},"devDependencies":{"@types/jest":"^27.4.0","@types/node":"^12.0.8","@typescript-eslint/typescript-estree":"^1.10.2","eslint":"^6.8.0","eslint-config-prettier":"^6.0.0","eslint-config-standard":"^13.0.1","eslint-plugin-import":"^2.18.2","eslint-plugin-jest":"^26.1.0","eslint-plugin-node":"^11.0.0","eslint-plugin-prettier":"^3.1.0","eslint-plugin-promise":"^4.2.1","eslint-plugin-standard":"^4.0.0","execa":"^2.0.3","glob":"^7.1.4","husky":"^3.0.1","ip":"^1.1.5","jest":"^25.1.0","jest-circus":"^25.1.0","jest-extended":"^0.11.2","jest-junit":"^10.0.0","jsonwebtoken":"^9.0.0","lint-staged":"^9.2.0","mockdate":"^2.0.5","prettier":"^1.18.2","semver":"^6.2.0","typescript":"^3.8.3","uuid":"^3.3.2"},"dependencies":{},"lint-staged":{"*.js":["prettier --write","git add"]}}')}};